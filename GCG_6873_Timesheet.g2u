Program.Sub.ScreenSU.Start
Gui.FormTimesheet..create(BaseForm)
Gui.FormTimesheet..caption("Timesheet Entry")
Gui.FormTimesheet..size(20685,10455)
Gui.FormTimesheet..minx(17000)
Gui.FormTimesheet..miny(9000)
Gui.FormTimesheet..position(0,0)
Gui.FormTimesheet..event(UnLoad,FormTimesheet_unload)
Gui.FormTimesheet..forecolor(0)
Gui.FormTimesheet..BackColor(-2147483633)
Gui.FormTimesheet..mousepointer(0)
Gui.FormTimesheet..AlwaysOnTop(False)
Gui.FormTimesheet..FontName("Tahoma")
Gui.FormTimesheet..FontSize(8.25)
Gui.FormTimesheet..ControlBox(True)
Gui.FormTimesheet..MaxButton(True)
Gui.FormTimesheet..MinButton(True)
Gui.FormTimesheet..Moveable(True)
Gui.FormTimesheet..Sizeable(True)
Gui.FormTimesheet..ShowInTaskBar(True)
Gui.FormTimesheet..TitleBar(True)
Gui.FormTimesheet.dtpWeek.create(datepicker)
Gui.FormTimesheet.dtpWeek.size(1935,285)
Gui.FormTimesheet.dtpWeek.position(135,375)
Gui.FormTimesheet.dtpWeek.event(Change,dtpweek_change)
Gui.FormTimesheet.dtpWeek.tabstop(True)
Gui.FormTimesheet.dtpWeek.tabindex(1)
Gui.FormTimesheet.dtpWeek.Enabled(True)
Gui.FormTimesheet.dtpWeek.Visible(False)
Gui.FormTimesheet.dtpWeek.Zorder(0)
Gui.FormTimesheet.dtpWeek.CheckBox(False)
Gui.FormTimesheet.dtpWeek.FontName("Tahoma")
Gui.FormTimesheet.dtpWeek.FontSize(8.25)
Gui.FormTimesheet.gsgcTimesheet.create(GsGridControl)
Gui.FormTimesheet.gsgcTimesheet.size(20550,8985)
Gui.FormTimesheet.gsgcTimesheet.position(0,705)
Gui.FormTimesheet.gsgcTimesheet.Event(RowCellClick,gsgcTimesheet_RowCellClick)
Gui.FormTimesheet.gsgcTimesheet.Event(CellValueChanged,gsgcTimesheet_CellValueChanged)
Gui.FormTimesheet.gsgcTimesheet.Anchor(15)
Gui.FormTimesheet.gsgcTimesheet.Enabled(True)
Gui.FormTimesheet.gsgcTimesheet.Visible(True)
Gui.FormTimesheet.gsgcTimesheet.Zorder(0)
Gui.FormTimesheet.cmdUpdate.create(button)
Gui.FormTimesheet.cmdUpdate.caption("Lock/Post to GSS")
Gui.FormTimesheet.cmdUpdate.size(1860,375)
Gui.FormTimesheet.cmdUpdate.position(1095,9720)
Gui.FormTimesheet.cmdUpdate.event(Click,cmdupdate_click)
Gui.FormTimesheet.cmdUpdate.disableonclick(20)
Gui.FormTimesheet.cmdUpdate.defaultvalue("")
Gui.FormTimesheet.cmdUpdate.tabstop(True)
Gui.FormTimesheet.cmdUpdate.tabindex(12)
Gui.FormTimesheet.cmdUpdate.Anchor(6)
Gui.FormTimesheet.cmdUpdate.Enabled(True)
Gui.FormTimesheet.cmdUpdate.Visible(True)
Gui.FormTimesheet.cmdUpdate.Zorder(0)
Gui.FormTimesheet.cmdUpdate.FontName("Tahoma")
Gui.FormTimesheet.cmdUpdate.FontSize(8.25)
Gui.FormTimesheet.cmdTemp.create(button)
Gui.FormTimesheet.cmdTemp.caption("Template")
Gui.FormTimesheet.cmdTemp.size(960,375)
Gui.FormTimesheet.cmdTemp.position(2085,9720)
Gui.FormTimesheet.cmdTemp.event(Click,cmdtemp_click)
Gui.FormTimesheet.cmdTemp.defaultvalue("")
Gui.FormTimesheet.cmdTemp.tabstop(True)
Gui.FormTimesheet.cmdTemp.tabindex(13)
Gui.FormTimesheet.cmdTemp.Anchor(6)
Gui.FormTimesheet.cmdTemp.Enabled(True)
Gui.FormTimesheet.cmdTemp.Visible(True)
Gui.FormTimesheet.cmdTemp.Zorder(0)
Gui.FormTimesheet.cmdTemp.FontName("Tahoma")
Gui.FormTimesheet.cmdTemp.FontSize(8.25)
Gui.FormTimesheet.cmdSave.create(button)
Gui.FormTimesheet.cmdSave.caption("Save")
Gui.FormTimesheet.cmdSave.size(855,375)
Gui.FormTimesheet.cmdSave.position(105,9720)
Gui.FormTimesheet.cmdSave.event(Click,cmdsave_click)
Gui.FormTimesheet.cmdSave.defaultvalue("")
Gui.FormTimesheet.cmdSave.tabstop(True)
Gui.FormTimesheet.cmdSave.tabindex(11)
Gui.FormTimesheet.cmdSave.Anchor(6)
Gui.FormTimesheet.cmdSave.Enabled(True)
Gui.FormTimesheet.cmdSave.Visible(True)
Gui.FormTimesheet.cmdSave.Zorder(0)
Gui.FormTimesheet.cmdSave.FontName("Tahoma")
Gui.FormTimesheet.cmdSave.FontSize(8.25)
Gui.FormTimesheet.lblDate.create(label,"Select Week",True,900,210,1,120,120,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblDate.defaultvalue("")
Gui.FormTimesheet.lblDate.BorderStyle(0)
Gui.FormTimesheet.cmdRefresh.create(button)
Gui.FormTimesheet.cmdRefresh.caption("Refresh")
Gui.FormTimesheet.cmdRefresh.size(855,375)
Gui.FormTimesheet.cmdRefresh.position(2115,255)
Gui.FormTimesheet.cmdRefresh.event(Click,cmdrefresh_click)
Gui.FormTimesheet.cmdRefresh.disableonclick(20)
Gui.FormTimesheet.cmdRefresh.defaultvalue("")
Gui.FormTimesheet.cmdRefresh.tabstop(True)
Gui.FormTimesheet.cmdRefresh.tabindex(2)
Gui.FormTimesheet.cmdRefresh.Enabled(True)
Gui.FormTimesheet.cmdRefresh.Visible(True)
Gui.FormTimesheet.cmdRefresh.Zorder(0)
Gui.FormTimesheet.cmdRefresh.FontName("Tahoma")
Gui.FormTimesheet.cmdRefresh.FontSize(8.25)
Gui.FormTimesheet.txtAJob.create(textbox,"",True,1050,300,0,3480,300,True,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtAJob.defaultvalue("")
Gui.FormTimesheet.txtAJob.MaxLength(6)
Gui.FormTimesheet.txtAJob.TabStop(True)
Gui.FormTimesheet.txtAJob.TabIndex(3)
Gui.FormTimesheet.txtASuff.create(textbox,"",True,570,300,0,4635,300,True,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtASuff.defaultvalue("")
Gui.FormTimesheet.txtASuff.MaxLength(3)
Gui.FormTimesheet.txtASuff.TabStop(True)
Gui.FormTimesheet.txtASuff.TabIndex(4)
Gui.FormTimesheet.cmdAddJobBrows.create(button)
Gui.FormTimesheet.cmdAddJobBrows.caption("^")
Gui.FormTimesheet.cmdAddJobBrows.size(345,375)
Gui.FormTimesheet.cmdAddJobBrows.position(5310,255)
Gui.FormTimesheet.cmdAddJobBrows.event(Click,cmdaddjobbrows_click)
Gui.FormTimesheet.cmdAddJobBrows.defaultvalue("")
Gui.FormTimesheet.cmdAddJobBrows.Enabled(True)
Gui.FormTimesheet.cmdAddJobBrows.Visible(True)
Gui.FormTimesheet.cmdAddJobBrows.Zorder(0)
Gui.FormTimesheet.cmdAddJobBrows.FontName("Tahoma")
Gui.FormTimesheet.cmdAddJobBrows.FontSize(8.25)
Gui.FormTimesheet.txtASeq.create(textbox,"",True,765,300,0,5865,300,True,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtASeq.defaultvalue("")
Gui.FormTimesheet.txtASeq.MaxLength(6)
Gui.FormTimesheet.txtASeq.TabStop(True)
Gui.FormTimesheet.txtASeq.TabIndex(5)
Gui.FormTimesheet.cmdAddSeqBrows.create(button)
Gui.FormTimesheet.cmdAddSeqBrows.caption("^")
Gui.FormTimesheet.cmdAddSeqBrows.size(345,375)
Gui.FormTimesheet.cmdAddSeqBrows.position(6750,270)
Gui.FormTimesheet.cmdAddSeqBrows.event(Click,cmdaddseqbrows_click)
Gui.FormTimesheet.cmdAddSeqBrows.defaultvalue("")
Gui.FormTimesheet.cmdAddSeqBrows.Enabled(True)
Gui.FormTimesheet.cmdAddSeqBrows.Visible(True)
Gui.FormTimesheet.cmdAddSeqBrows.Zorder(0)
Gui.FormTimesheet.cmdAddSeqBrows.FontName("Tahoma")
Gui.FormTimesheet.cmdAddSeqBrows.FontSize(8.25)
Gui.FormTimesheet.lblASeq.create(label,"Sequence",True,735,210,1,5865,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblASeq.defaultvalue("")
Gui.FormTimesheet.lblASeq.BorderStyle(0)
Gui.FormTimesheet.lblASuff.create(label,"Suffix",True,435,210,1,4635,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblASuff.defaultvalue("")
Gui.FormTimesheet.lblASuff.BorderStyle(0)
Gui.FormTimesheet.lblAJob.create(label,"Job",True,255,210,1,3480,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblAJob.defaultvalue("")
Gui.FormTimesheet.lblAJob.BorderStyle(0)
Gui.FormTimesheet.cmdAdd.create(button)
Gui.FormTimesheet.cmdAdd.caption("Add")
Gui.FormTimesheet.cmdAdd.size(1110,375)
Gui.FormTimesheet.cmdAdd.position(9870,255)
Gui.FormTimesheet.cmdAdd.event(Click,cmdadd_click)
Gui.FormTimesheet.cmdAdd.disableonclick(20)
Gui.FormTimesheet.cmdAdd.defaultvalue("")
Gui.FormTimesheet.cmdAdd.tabstop(True)
Gui.FormTimesheet.cmdAdd.tabindex(7)
Gui.FormTimesheet.cmdAdd.Enabled(True)
Gui.FormTimesheet.cmdAdd.Visible(True)
Gui.FormTimesheet.cmdAdd.Zorder(0)
Gui.FormTimesheet.cmdAdd.FontName("Tahoma")
Gui.FormTimesheet.cmdAdd.FontSize(8.25)
Gui.FormTimesheet.cmdReady.create(button)
Gui.FormTimesheet.cmdReady.caption("Ready for Approval")
Gui.FormTimesheet.cmdReady.size(1710,375)
Gui.FormTimesheet.cmdReady.position(3120,9720)
Gui.FormTimesheet.cmdReady.event(Click,cmdready_click)
Gui.FormTimesheet.cmdReady.defaultvalue("")
Gui.FormTimesheet.cmdReady.TabStop(True)
Gui.FormTimesheet.cmdReady.TabIndex(14)
Gui.FormTimesheet.cmdReady.Anchor(6)
Gui.FormTimesheet.cmdReady.Enabled(True)
Gui.FormTimesheet.cmdReady.Visible(True)
Gui.FormTimesheet.cmdReady.Zorder(0)
Gui.FormTimesheet.cmdReady.FontName("Tahoma")
Gui.FormTimesheet.cmdReady.FontSize(8.25)
Gui.FormTimesheet.cmdPrint.create(button)
Gui.FormTimesheet.cmdPrint.caption("Print")
Gui.FormTimesheet.cmdPrint.size(885,375)
Gui.FormTimesheet.cmdPrint.position(4050,9720)
Gui.FormTimesheet.cmdPrint.event(Click,cmdprint_click)
Gui.FormTimesheet.cmdPrint.defaultvalue("")
Gui.FormTimesheet.cmdPrint.Anchor(6)
Gui.FormTimesheet.cmdPrint.Enabled(True)
Gui.FormTimesheet.cmdPrint.Visible(True)
Gui.FormTimesheet.cmdPrint.Zorder(0)
Gui.FormTimesheet.cmdPrint.FontName("Tahoma")
Gui.FormTimesheet.cmdPrint.FontSize(8.25)
Gui.FormTimesheet.txtEmployee.create(textbox,"",True,1020,300,0,11220,9780,False,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtEmployee.maxLength(5)
Gui.FormTimesheet.txtEmployee.defaultvalue("")
Gui.FormTimesheet.txtEmployee.Event(LostFocus,txtEmployee_Change)
Gui.FormTimesheet.txtEmployee.TabStop(True)
Gui.FormTimesheet.txtEmployee.TabIndex(8)
Gui.FormTimesheet.txtEmployee.Anchor(6)
Gui.FormTimesheet.lblEmp.create(label,"Employee",True,810,255,1,10365,9870,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblEmp.defaultvalue("")
Gui.FormTimesheet.lblEmp.Anchor(6)
Gui.FormTimesheet.lblEmp.BorderStyle(0)
Gui.FormTimesheet.cmdEmpBrws.create(button)
Gui.FormTimesheet.cmdEmpBrws.caption("^")
Gui.FormTimesheet.cmdEmpBrws.size(465,375)
Gui.FormTimesheet.cmdEmpBrws.position(12285,9750)
Gui.FormTimesheet.cmdEmpBrws.event(Click,cmdempbrws_click)
Gui.FormTimesheet.cmdEmpBrws.defaultvalue("")
Gui.FormTimesheet.cmdEmpBrws.Anchor(6)
Gui.FormTimesheet.cmdEmpBrws.Enabled(False)
Gui.FormTimesheet.cmdEmpBrws.Visible(False)
Gui.FormTimesheet.cmdEmpBrws.Zorder(0)
Gui.FormTimesheet.cmdEmpBrws.FontName("Tahoma")
Gui.FormTimesheet.cmdEmpBrws.FontSize(8.25)
Gui.FormTimesheet.cmdEmpSearch.create(button)
Gui.FormTimesheet.cmdEmpSearch.caption("Refresh")
Gui.FormTimesheet.cmdEmpSearch.size(1095,420)
Gui.FormTimesheet.cmdEmpSearch.position(14415,9720)
Gui.FormTimesheet.cmdEmpSearch.event(Click,cmdempsearch_click)
Gui.FormTimesheet.cmdEmpSearch.defaultvalue("")
Gui.FormTimesheet.cmdEmpSearch.TabStop(True)
Gui.FormTimesheet.cmdEmpSearch.TabIndex(9)
Gui.FormTimesheet.cmdEmpSearch.Anchor(6)
Gui.FormTimesheet.cmdEmpSearch.Enabled(False)
Gui.FormTimesheet.cmdEmpSearch.Visible(False)
Gui.FormTimesheet.cmdEmpSearch.Zorder(0)
Gui.FormTimesheet.cmdEmpSearch.FontName("Tahoma")
Gui.FormTimesheet.cmdEmpSearch.FontSize(8.25)
Gui.FormTimesheet.cmdUnlock.create(button)
Gui.FormTimesheet.cmdUnlock.caption("Unlock All")
Gui.FormTimesheet.cmdUnlock.visible(False)
Gui.FormTimesheet.cmdUnlock.size(855,375)
Gui.FormTimesheet.cmdUnlock.position(4095,9720)
Gui.FormTimesheet.cmdUnlock.event(Click,cmdunlock_click)
Gui.FormTimesheet.cmdUnlock.defaultvalue("")
Gui.FormTimesheet.cmdUnlock.TabStop(True)
Gui.FormTimesheet.cmdUnlock.TabIndex(15)
Gui.FormTimesheet.cmdUnlock.Anchor(6)
Gui.FormTimesheet.cmdUnlock.Enabled(True)
Gui.FormTimesheet.cmdUnlock.Zorder(0)
Gui.FormTimesheet.cmdUnlock.FontName("Tahoma")
Gui.FormTimesheet.cmdUnlock.FontSize(8.25)
Gui.FormTimesheet.chkAllEmployees.create(checkbox)
Gui.FormTimesheet.chkAllEmployees.caption("Update All Employees")
Gui.FormTimesheet.chkAllEmployees.visible(False)
Gui.FormTimesheet.chkAllEmployees.size(2115,300)
Gui.FormTimesheet.chkAllEmployees.position(5235,9780)
Gui.FormTimesheet.chkAllEmployees.tooltip("Upload all employee times that are marked as Ready.")
Gui.FormTimesheet.chkAllEmployees.TabStop(True)
Gui.FormTimesheet.chkAllEmployees.TabIndex(16)
Gui.FormTimesheet.chkAllEmployees.Anchor(6)
Gui.FormTimesheet.chkAllEmployees.Enabled(True)
Gui.FormTimesheet.chkAllEmployees.Zorder(0)
Gui.FormTimesheet.chkAllEmployees.FontName("Tahoma")
Gui.FormTimesheet.chkAllEmployees.FontSize(8.25)
Gui.FormTimesheet.txtUser.create(textbox,"",True,1020,300,1,13350,9780,False,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtUser.maxLength(10)
Gui.FormTimesheet.txtUser.defaultvalue("")
Gui.FormTimesheet.txtUser.TabStop(True)
Gui.FormTimesheet.txtUser.TabIndex(10)
Gui.FormTimesheet.txtUser.Anchor(6)
Gui.FormTimesheet.txtUser.Event(LostFocus,txtUser_LostFocus)
Gui.FormTimesheet.lblUser.create(label,"User",True,540,255,0,12810,9870,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblUser.defaultvalue("")
Gui.FormTimesheet.lblUser.Anchor(6)
Gui.FormTimesheet.lblUser.BorderStyle(0)
Gui.FormTimesheet.lblASeq2.Create(Label,"Work Center",True,915,210,1,7290,120,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblASeq2.DefaultValue("")
Gui.FormTimesheet.lblASeq2.BorderStyle(0)
Gui.FormTimesheet.txtWC.Create(TextBox,"",True,765,300,0,7320,300,True,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtWC.DefaultValue("")
Gui.FormTimesheet.txtWC.MaxLength(4)
Gui.FormTimesheet.txtWC.TabStop(True)
Gui.FormTimesheet.txtWC.TabIndex(6)
Gui.FormTimesheet.cmdAddWC.Create(Button)
Gui.FormTimesheet.cmdAddWC.Size(345,375)
Gui.FormTimesheet.cmdAddWC.Position(8220,270)
Gui.FormTimesheet.cmdAddWC.Caption("^")
Gui.FormTimesheet.cmdAddWC.DefaultValue("")
Gui.FormTimesheet.cmdAddWC.Event(Click,cmdAddWC_Click)
Gui.FormTimesheet.cmdAddWC.Enabled(True)
Gui.FormTimesheet.cmdAddWC.Visible(True)
Gui.FormTimesheet.cmdAddWC.Zorder(0)
Gui.FormTimesheet.cmdAddWC.FontName("Tahoma")
Gui.FormTimesheet.cmdAddWC.FontSize(8.25)
Gui.FormTimesheet.lblSun1.Create(Label,"Sun Hrs",False,675,225,0,19560,855,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblSun1.Anchor(9)
Gui.FormTimesheet.lblSun1.BorderStyle(0)
Gui.FormTimesheet.txtSunHrs.Create(TextBox,"",False,870,300,0,19560,1080,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtSunHrs.Locked(True)
Gui.FormTimesheet.txtSunHrs.ForeColor(0)
Gui.FormTimesheet.txtSunHrs.Anchor(9)
Gui.FormTimesheet.lblMon1.Create(Label,"Mon Hrs",False,690,225,0,19560,1500,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblMon1.Anchor(9)
Gui.FormTimesheet.lblMon1.BorderStyle(0)
Gui.FormTimesheet.lblTues1.Create(Label,"Tues Hrs",False,765,225,0,19560,2160,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblTues1.Anchor(9)
Gui.FormTimesheet.lblTues1.BorderStyle(0)
Gui.FormTimesheet.lblWed1.Create(Label,"Wed Hrs",False,720,225,0,19560,2820,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblWed1.Anchor(9)
Gui.FormTimesheet.lblWed1.BorderStyle(0)
Gui.FormTimesheet.lblThur1.Create(Label,"Thur Hrs",False,720,225,0,19560,3465,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblThur1.Anchor(9)
Gui.FormTimesheet.lblThur1.BorderStyle(0)
Gui.FormTimesheet.lblFri1.Create(Label,"Fri Hrs",False,555,225,0,19560,4095,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblFri1.Anchor(9)
Gui.FormTimesheet.lblFri1.BorderStyle(0)
Gui.FormTimesheet.lblSat1.Create(Label,"Sat Hrs",False,615,225,0,19560,4755,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblSat1.Anchor(9)
Gui.FormTimesheet.lblSat1.BorderStyle(0)
Gui.FormTimesheet.lbl8.Create(Label,"Total Hrs.",True,690,210,0,14325,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lbl8.BorderStyle(0)
Gui.FormTimesheet.txtFriHrs.Create(TextBox,"",False,870,300,0,19560,4335,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtFriHrs.ForeColor(0)
Gui.FormTimesheet.txtFriHrs.Locked(True)
Gui.FormTimesheet.txtFriHrs.Anchor(9)
Gui.FormTimesheet.txtThurHrs.Create(TextBox,"",False,870,300,0,19560,3705,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtThurHrs.ForeColor(0)
Gui.FormTimesheet.txtThurHrs.Locked(True)
Gui.FormTimesheet.txtThurHrs.Anchor(9)
Gui.FormTimesheet.txtWedHrs.Create(TextBox,"",False,870,300,0,19560,3045,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtWedHrs.ForeColor(0)
Gui.FormTimesheet.txtWedHrs.Locked(True)
Gui.FormTimesheet.txtWedHrs.Anchor(9)
Gui.FormTimesheet.txtTuesHrs.Create(TextBox,"",False,870,300,0,19560,2400,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtTuesHrs.ForeColor(0)
Gui.FormTimesheet.txtTuesHrs.Locked(True)
Gui.FormTimesheet.txtTuesHrs.Anchor(9)
Gui.FormTimesheet.txtMonHrs.Create(TextBox,"",False,870,300,0,19560,1740,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtMonHrs.ForeColor(0)
Gui.FormTimesheet.txtMonHrs.Locked(True)
Gui.FormTimesheet.txtMonHrs.Anchor(9)
Gui.FormTimesheet.txtSatHrs.Create(TextBox,"",False,870,300,0,19560,4995,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtSatHrs.ForeColor(0)
Gui.FormTimesheet.txtSatHrs.Locked(True)
Gui.FormTimesheet.txtSatHrs.Anchor(9)
Gui.FormTimesheet.txtTotHrs.Create(TextBox,"",True,870,300,0,14325,300,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtTotHrs.ForeColor(0)
Gui.FormTimesheet.txtTotHrs.Locked(True)
Gui.FormTimesheet.cmdFrmTemp.Create(Button)
Gui.FormTimesheet.cmdFrmTemp.Size(1770,375)
Gui.FormTimesheet.cmdFrmTemp.Position(11250,255)
Gui.FormTimesheet.cmdFrmTemp.TabStop(True)
Gui.FormTimesheet.cmdFrmTemp.TabIndex(7)
Gui.FormTimesheet.cmdFrmTemp.Caption("Add From Template")
Gui.FormTimesheet.cmdFrmTemp.DisableOnClick(20)
Gui.FormTimesheet.cmdFrmTemp.DefaultValue("")
Gui.FormTimesheet.cmdFrmTemp.Event(Click,cmdFrmTemp_Click)
Gui.FormTimesheet.cmdFrmTemp.Enabled(True)
Gui.FormTimesheet.cmdFrmTemp.Visible(True)
Gui.FormTimesheet.cmdFrmTemp.Zorder(0)
Gui.FormTimesheet.cmdFrmTemp.FontName("Tahoma")
Gui.FormTimesheet.cmdFrmTemp.FontSize(8.25)
Gui.FormTimesheet.lblDay.Create(Label,"Day",False,285,210,0,19845,75,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblDay.Anchor(9)
Gui.FormTimesheet.lblDay.BorderStyle(0)
Gui.FormTimesheet.txtBucketHrs.Create(TextBox,"Bucket Hrs.",False,1005,300,0,19545,255,False,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtBucketHrs.Anchor(9)
Gui.FormTimesheet.lblClockHrs.Create(Label,"Balance Hrs.",False,960,210,0,19590,615,False,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrs.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrs.Anchor(9)
Gui.FormTimesheet.lblClockHrs.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsMon.Create(Label,"Clock Hrs.",False,795,210,0,15990,9705,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsMon.Anchor(9)
Gui.FormTimesheet.lblClockHrsMon.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsMon.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsTues.Create(Label,"Clock Hrs.",False,795,210,0,16440,9675,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsTues.Anchor(9)
Gui.FormTimesheet.lblClockHrsTues.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsTues.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsWed.Create(Label,"Clock Hrs.",False,795,210,0,16845,9750,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsWed.Anchor(9)
Gui.FormTimesheet.lblClockHrsWed.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsWed.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsThur.Create(Label,"Clock Hrs.",False,795,210,0,17475,9735,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsThur.Anchor(9)
Gui.FormTimesheet.lblClockHrsThur.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsThur.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsFri.Create(Label,"Clock Hrs.",False,795,210,0,17835,9690,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsFri.Anchor(9)
Gui.FormTimesheet.lblClockHrsFri.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsFri.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsSat.Create(Label,"Clock Hrs.",False,795,210,0,18795,9750,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsSat.Anchor(9)
Gui.FormTimesheet.lblClockHrsSat.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsSat.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsSun.Create(Label,"Clock Hrs.",False,795,210,0,15660,9735,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsSun.Anchor(9)
Gui.FormTimesheet.lblClockHrsSun.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsSun.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsTotal.Create(Label,"Clock Hrs.",False,795,210,0,19560,9435,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsTotal.Anchor(10)
Gui.FormTimesheet.lblClockHrsTotal.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsTotal.BorderStyle(0)
Gui.FormTimesheet.txtHoursTA.Create(TextBox,"",False,870,300,0,13380,300,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtHoursTA.ForeColor(0)
Gui.FormTimesheet.txtHoursTA.Locked(True)
Gui.FormTimesheet.txtHoursBalance.Create(TextBox,"",False,870,300,0,15450,270,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtHoursBalance.ForeColor(0)
Gui.FormTimesheet.txtHoursBalance.Locked(True)
Gui.FormTimesheet.lbl9.Create(Label,"Hours TA",False,690,210,0,13380,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lbl9.BorderStyle(0)
Gui.FormTimesheet.lbl10.Create(Label,"Balance Hrs.",False,930,210,0,15450,75,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lbl10.BorderStyle(0)
Gui.FormTimesheet.txtGUIHours.Create(TextBox,"",False,870,300,0,15270,300,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtGUIHours.ForeColor(0)
Gui.FormTimesheet.txtGUIHours.Locked(True)
Gui.FormTimesheet.lbl11.Create(Label,"GUI Hrs.",False,600,210,0,15270,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lbl11.BorderStyle(0)
Gui.FormTimesheet.cmdAddNotes.Create(Button)
Gui.FormTimesheet.cmdAddNotes.Enabled(True)
Gui.FormTimesheet.cmdAddNotes.Visible(True)
Gui.FormTimesheet.cmdAddNotes.Zorder(0)
Gui.FormTimesheet.cmdAddNotes.Size(1125,345)
Gui.FormTimesheet.cmdAddNotes.Position(8640,270)
Gui.FormTimesheet.cmdAddNotes.Caption("Add Notes")
Gui.FormTimesheet.cmdAddNotes.FontName("Tahoma")
Gui.FormTimesheet.cmdAddNotes.FontSize(8.25)
Gui.FormTimesheet.cmdAddNotes.Event(Click,cmdAddNotes_Click)
Gui.FormTimesheet.ddlDateSelect.Create(DropDownList)
Gui.FormTimesheet.ddlDateSelect.Enabled(True)
Gui.FormTimesheet.ddlDateSelect.Visible(True)
Gui.FormTimesheet.ddlDateSelect.Zorder(0)
Gui.FormTimesheet.ddlDateSelect.Size(1830,300)
Gui.FormTimesheet.ddlDateSelect.Position(135,360)
Gui.FormTimesheet.ddlDateSelect.FontName("Tahoma")
Gui.FormTimesheet.ddlDateSelect.FontSize(8.25)
Gui.FormTimesheet.ddlDateSelect.Event(SelectedIndexChanged,ddlDateSelect_SelectedIndexChanged)
Gui.FormTimesheet.lblSun2.Create(Label,"Sun Hrs",False,675,225,0,19560,5385,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblSun2.BorderStyle(0)
Gui.FormTimesheet.lblSun2.Anchor(9)
Gui.FormTimesheet.txtSunHrs2.Create(TextBox,"",False,870,300,0,19560,5610,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtSunHrs2.Anchor(9)
Gui.FormTimesheet.txtSunHrs2.ForeColor(0)
Gui.FormTimesheet.txtSunHrs2.Locked(True)
Gui.FormTimesheet.lblMon2.Create(Label,"Mon Hrs",False,690,225,0,19560,6015,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblMon2.BorderStyle(0)
Gui.FormTimesheet.lblMon2.Anchor(9)
Gui.FormTimesheet.txtMonHrs2.Create(TextBox,"",False,870,300,0,19560,6255,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtMonHrs2.Anchor(9)
Gui.FormTimesheet.txtMonHrs2.ForeColor(0)
Gui.FormTimesheet.txtMonHrs2.Locked(True)
Gui.FormTimesheet.lblTues2.Create(Label,"Tues Hrs",False,765,225,0,19560,6630,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblTues2.BorderStyle(0)
Gui.FormTimesheet.lblTues2.Anchor(9)
Gui.FormTimesheet.txtTuesHrs2.Create(TextBox,"",False,870,300,0,19560,6870,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtTuesHrs2.Anchor(9)
Gui.FormTimesheet.txtTuesHrs2.ForeColor(0)
Gui.FormTimesheet.txtTuesHrs2.Locked(True)
Gui.FormTimesheet.lblWed2.Create(Label,"Wed Hrs",False,720,225,0,19560,7245,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblWed2.BorderStyle(0)
Gui.FormTimesheet.lblWed2.Anchor(9)
Gui.FormTimesheet.txtWedHrs2.Create(TextBox,"",False,870,300,0,19560,7470,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtWedHrs2.Anchor(9)
Gui.FormTimesheet.txtWedHrs2.ForeColor(0)
Gui.FormTimesheet.txtWedHrs2.Locked(True)
Gui.FormTimesheet.lblThur2.Create(Label,"Thur Hrs",False,720,225,0,19560,7860,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblThur2.BorderStyle(0)
Gui.FormTimesheet.lblThur2.Anchor(9)
Gui.FormTimesheet.txtThurHrs2.Create(TextBox,"",False,870,300,0,19560,8100,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtThurHrs2.Anchor(9)
Gui.FormTimesheet.txtThurHrs2.ForeColor(0)
Gui.FormTimesheet.txtThurHrs2.Locked(True)
Gui.FormTimesheet.lblFri2.Create(Label,"Fri Hrs",False,555,225,0,19560,8475,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblFri2.BorderStyle(0)
Gui.FormTimesheet.lblFri2.Anchor(9)
Gui.FormTimesheet.txtFriHrs2.Create(TextBox,"",False,870,300,0,19560,8715,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtFriHrs2.Anchor(9)
Gui.FormTimesheet.txtFriHrs2.ForeColor(0)
Gui.FormTimesheet.txtFriHrs2.Locked(True)
Gui.FormTimesheet.lblSat2.Create(Label,"Sat Hrs",False,615,225,0,19560,9090,True,0,"Arial",9,-2147483633,0,0)
Gui.FormTimesheet.lblSat2.BorderStyle(0)
Gui.FormTimesheet.lblSat2.Anchor(9)
Gui.FormTimesheet.txtSatHrs2.Create(TextBox,"",False,870,300,0,19560,9330,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtSatHrs2.Anchor(9)
Gui.FormTimesheet.txtSatHrs2.ForeColor(0)
Gui.FormTimesheet.txtSatHrs2.Locked(True)
Gui.FormTimesheet.lblPrevWeek.Create(Label,"Select Prev Pay Period",True,1635,210,1,16485,75,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblPrevWeek.BorderStyle(0)
Gui.FormTimesheet.lblPrevWeek.DefaultValue("")
Gui.FormTimesheet.ddlPrevWeek.Create(DropDownList)
Gui.FormTimesheet.ddlPrevWeek.Enabled(True)
Gui.FormTimesheet.ddlPrevWeek.Visible(True)
Gui.FormTimesheet.ddlPrevWeek.Zorder(0)
Gui.FormTimesheet.ddlPrevWeek.Size(1770,300)
Gui.FormTimesheet.ddlPrevWeek.Position(16470,315)
Gui.FormTimesheet.ddlPrevWeek.FontName("Tahoma")
Gui.FormTimesheet.ddlPrevWeek.FontSize(8.25)
Gui.FormTimesheet.cmdView.Create(Button)
Gui.FormTimesheet.cmdView.Enabled(True)
Gui.FormTimesheet.cmdView.Visible(True)
Gui.FormTimesheet.cmdView.Zorder(0)
Gui.FormTimesheet.cmdView.Size(870,345)
Gui.FormTimesheet.cmdView.Position(18300,285)
Gui.FormTimesheet.cmdView.Caption("View")
Gui.FormTimesheet.cmdView.FontName("Tahoma")
Gui.FormTimesheet.cmdView.FontSize(8.25)
Gui.FormTimesheet.cmdView.Event(Click,cmdView_Click)
Gui.F_Template..create(BaseForm)
Gui.F_Template..caption("Template Entry")
Gui.F_Template..size(5640,7380)
Gui.F_Template..minx(0)
Gui.F_Template..miny(0)
Gui.F_Template..position(0,0)
Gui.F_Template..event(UnLoad,f_template_unload)
Gui.F_Template..forecolor(0)
Gui.F_Template..BackColor(-2147483633)
Gui.F_Template..maxbutton(False)
Gui.F_Template..mousepointer(0)
Gui.F_Template..sizeable(False)
Gui.F_Template..AlwaysOnTop(False)
Gui.F_Template..FontName("Tahoma")
Gui.F_Template..FontSize(8.25)
Gui.F_Template..ControlBox(True)
Gui.F_Template..MinButton(True)
Gui.F_Template..Moveable(True)
Gui.F_Template..ShowInTaskBar(True)
Gui.F_Template..TitleBar(True)
Gui.F_Template.lblJob.create(label,"Job",True,660,255,1,125,155,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Template.lblJob.defaultvalue("")
Gui.F_Template.lblJob.BorderStyle(0)
Gui.F_Template.txtTmpJob.create(textbox,"",True,1050,300,0,105,375,True,0,"Arial",8,-2147483643,1)
Gui.F_Template.txtTmpJob.defaultvalue("")
Gui.F_Template.txtTmpJob.TabStop(True)
Gui.F_Template.txtTmpJob.TabIndex(1)
Gui.F_Template.lblSuff.create(label,"Suffix",True,645,255,1,1275,150,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Template.lblSuff.defaultvalue("")
Gui.F_Template.lblSuff.BorderStyle(0)
Gui.F_Template.txtTmpSuff.create(textbox,"",True,570,300,0,1275,375,True,0,"Arial",8,-2147483643,1)
Gui.F_Template.txtTmpSuff.defaultvalue("")
Gui.F_Template.txtTmpSuff.TabStop(True)
Gui.F_Template.txtTmpSuff.TabIndex(2)
Gui.F_Template.cmdTmpJobBrows.create(button)
Gui.F_Template.cmdTmpJobBrows.caption("^")
Gui.F_Template.cmdTmpJobBrows.size(345,375)
Gui.F_Template.cmdTmpJobBrows.position(1965,345)
Gui.F_Template.cmdTmpJobBrows.event(Click,cmdtmpjobbrows_click)
Gui.F_Template.cmdTmpJobBrows.defaultvalue("")
Gui.F_Template.cmdTmpJobBrows.TabStop(True)
Gui.F_Template.cmdTmpJobBrows.TabIndex(3)
Gui.F_Template.cmdTmpJobBrows.Enabled(True)
Gui.F_Template.cmdTmpJobBrows.Visible(True)
Gui.F_Template.cmdTmpJobBrows.Zorder(0)
Gui.F_Template.cmdTmpJobBrows.FontName("Tahoma")
Gui.F_Template.cmdTmpJobBrows.FontSize(8.25)
Gui.F_Template.lblSeq.create(label,"Sequence",True,1185,255,1,2580,150,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Template.lblSeq.defaultvalue("")
Gui.F_Template.lblSeq.BorderStyle(0)
Gui.F_Template.txtTmpSeq.create(textbox,"",True,765,300,0,2580,375,True,0,"Arial",8,-2147483643,1)
Gui.F_Template.txtTmpSeq.defaultvalue("")
Gui.F_Template.txtTmpSeq.TabStop(True)
Gui.F_Template.txtTmpSeq.TabIndex(4)
Gui.F_Template.cmdTmpSeqBrows.create(button)
Gui.F_Template.cmdTmpSeqBrows.caption("^")
Gui.F_Template.cmdTmpSeqBrows.size(345,375)
Gui.F_Template.cmdTmpSeqBrows.position(3480,345)
Gui.F_Template.cmdTmpSeqBrows.event(Click,cmdtmpseqbrows_click)
Gui.F_Template.cmdTmpSeqBrows.defaultvalue("")
Gui.F_Template.cmdTmpSeqBrows.TabStop(True)
Gui.F_Template.cmdTmpSeqBrows.TabIndex(5)
Gui.F_Template.cmdTmpSeqBrows.Enabled(True)
Gui.F_Template.cmdTmpSeqBrows.Visible(True)
Gui.F_Template.cmdTmpSeqBrows.Zorder(0)
Gui.F_Template.cmdTmpSeqBrows.FontName("Tahoma")
Gui.F_Template.cmdTmpSeqBrows.FontSize(8.25)
Gui.F_Template.cmdTmpAdd.create(button)
Gui.F_Template.cmdTmpAdd.caption("Add")
Gui.F_Template.cmdTmpAdd.size(855,375)
Gui.F_Template.cmdTmpAdd.position(105,825)
Gui.F_Template.cmdTmpAdd.event(Click,cmdtmpadd_click)
Gui.F_Template.cmdTmpAdd.defaultvalue("")
Gui.F_Template.cmdTmpAdd.TabStop(True)
Gui.F_Template.cmdTmpAdd.TabIndex(8)
Gui.F_Template.cmdTmpAdd.Enabled(True)
Gui.F_Template.cmdTmpAdd.Visible(True)
Gui.F_Template.cmdTmpAdd.Zorder(0)
Gui.F_Template.cmdTmpAdd.FontName("Tahoma")
Gui.F_Template.cmdTmpAdd.FontSize(8.25)
Gui.F_Template.cmdTmpDelete.create(button)
Gui.F_Template.cmdTmpDelete.caption("Delete")
Gui.F_Template.cmdTmpDelete.size(855,375)
Gui.F_Template.cmdTmpDelete.position(1065,810)
Gui.F_Template.cmdTmpDelete.event(Click,cmdtmpdelete_click)
Gui.F_Template.cmdTmpDelete.defaultvalue("")
Gui.F_Template.cmdTmpDelete.TabStop(True)
Gui.F_Template.cmdTmpDelete.TabIndex(9)
Gui.F_Template.cmdTmpDelete.Enabled(True)
Gui.F_Template.cmdTmpDelete.Visible(True)
Gui.F_Template.cmdTmpDelete.Zorder(0)
Gui.F_Template.cmdTmpDelete.FontName("Tahoma")
Gui.F_Template.cmdTmpDelete.FontSize(8.25)
Gui.F_Template.lvwTemp.create(listview)
Gui.F_Template.lvwTemp.view(3)
Gui.F_Template.lvwTemp.addlistviewcolumn("Job",915,0)
Gui.F_Template.lvwTemp.addlistviewcolumn("Suffix",660,0)
Gui.F_Template.lvwTemp.addlistviewcolumn("Seq",1000,0)
Gui.F_Template.lvwTemp.addlistviewcolumn("WC",660,0)
Gui.F_Template.lvwTemp.addlistviewcolumn("Description",2115,0)
Gui.F_Template.lvwTemp.size(5355,5055)
Gui.F_Template.lvwTemp.position(75,1305)
Gui.F_Template.lvwTemp.event(ItemClick,lvwtemp_itemclick)
Gui.F_Template.lvwTemp.Enabled(True)
Gui.F_Template.lvwTemp.Visible(True)
Gui.F_Template.lvwTemp.Zorder(0)
Gui.F_Template.lvwTemp.FontName("Tahoma")
Gui.F_Template.lvwTemp.FontSize(8)
Gui.F_Template.lvwTemp.Multiselect(False)
Gui.F_Template.lvwTemp.CheckBoxes(False)
Gui.F_Template.cmdTmpDeleteAll.create(button)
Gui.F_Template.cmdTmpDeleteAll.caption("Delete All")
Gui.F_Template.cmdTmpDeleteAll.size(1395,345)
Gui.F_Template.cmdTmpDeleteAll.position(90,6450)
Gui.F_Template.cmdTmpDeleteAll.event(Click,cmdtmpdeleteall_click)
Gui.F_Template.cmdTmpDeleteAll.defaultvalue("")
Gui.F_Template.cmdTmpDeleteAll.TabStop(True)
Gui.F_Template.cmdTmpDeleteAll.TabIndex(10)
Gui.F_Template.cmdTmpDeleteAll.Enabled(True)
Gui.F_Template.cmdTmpDeleteAll.Visible(True)
Gui.F_Template.cmdTmpDeleteAll.Zorder(0)
Gui.F_Template.cmdTmpDeleteAll.FontName("Tahoma")
Gui.F_Template.cmdTmpDeleteAll.FontSize(8.25)
Gui.F_Template.cmdTmpWC.Create(Button)
Gui.F_Template.cmdTmpWC.Size(345,375)
Gui.F_Template.cmdTmpWC.Position(5025,330)
Gui.F_Template.cmdTmpWC.Caption("^")
Gui.F_Template.cmdTmpWC.DefaultValue("")
Gui.F_Template.cmdTmpWC.Event(Click,cmdTmpAddWC_Click)
Gui.F_Template.cmdTmpWC.TabStop(True)
Gui.F_Template.cmdTmpWC.TabIndex(7)
Gui.F_Template.cmdTmpWC.Enabled(True)
Gui.F_Template.cmdTmpWC.Visible(True)
Gui.F_Template.cmdTmpWC.Zorder(0)
Gui.F_Template.cmdTmpWC.FontName("Tahoma")
Gui.F_Template.cmdTmpWC.FontSize(8.25)
Gui.F_Template.txtTmpWC.Create(TextBox,"",True,765,300,0,4110,375,True,0,"Arial",8,-2147483643,1)
Gui.F_Template.txtTmpWC.DefaultValue("")
Gui.F_Template.txtTmpWC.TabStop(True)
Gui.F_Template.txtTmpWC.TabIndex(6)
Gui.F_Template.lblSeq2.Create(Label,"Workcenter",True,1185,255,1,4050,150,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Template.lblSeq2.DefaultValue("")
Gui.F_Template.lblSeq2.BorderStyle(0)
Gui.fLogin..Create(BaseForm)
Gui.fLogin..Caption("Time Sheet Login")
Gui.fLogin..Size(4395,2280)
Gui.fLogin..MinX(0)
Gui.fLogin..MinY(0)
Gui.fLogin..Position(0,0)
Gui.fLogin..BackColor(-2147483633)
Gui.fLogin..MousePointer(0)
Gui.fLogin..Event(UnLoad,fLogin_UnLoad)
Gui.fLogin..AlwaysOnTop(False)
Gui.fLogin..FontName("Tahoma")
Gui.fLogin..FontSize(8.25)
Gui.fLogin..ControlBox(True)
Gui.fLogin..MaxButton(True)
Gui.fLogin..MinButton(True)
Gui.fLogin..Moveable(True)
Gui.fLogin..Sizeable(True)
Gui.fLogin..ShowInTaskBar(True)
Gui.fLogin..TitleBar(True)
Gui.fLogin.lbl1.Create(Label,"User Name :",True,1560,255,0,270,300,True,0,"Arial",12,-2147483633,0,0)
Gui.fLogin.lbl1.BorderStyle(0)
Gui.fLogin.txtUser.Create(TextBox,"",True,1680,390,0,2130,165,True,0,"Arial",12,-2147483643,1)
Gui.fLogin.txtUser.MaxLength(8)
Gui.fLogin.txtUser.Mask(">")
Gui.fLogin.lbl2.Create(Label,"Password : ",True,1605,255,0,270,720,True,0,"Arial",12,-2147483633,0,0)
Gui.fLogin.lbl2.BorderStyle(0)
Gui.fLogin.txtPassword.Create(TextBox,"",True,1680,390,0,2130,585,True,0,"Arial",12,-2147483643,1)
Gui.fLogin.txtPassword.PasswordChar("***********")
Gui.fLogin.cmdSignIn.Create(Button)
Gui.fLogin.cmdSignIn.Size(3555,450)
Gui.fLogin.cmdSignIn.Position(270,1125)
Gui.fLogin.cmdSignIn.Caption("Sign In")
Gui.fLogin.cmdSignIn.FontSize(12)
Gui.fLogin.cmdSignIn.Event(Click,cmdSignIn_Click)
Gui.fLogin.cmdSignIn.Enabled(True)
Gui.fLogin.cmdSignIn.Visible(True)
Gui.fLogin.cmdSignIn.Zorder(0)
Gui.fLogin.cmdSignIn.FontName("Tahoma")
Gui.fLogin.lblUsrName.Create(Label,"!",False,240,330,0,3870,255,True,0,"Arial",12,-2147483633,0,0)
Gui.fLogin.lblUsrName.ForeColor(255)
Gui.fLogin.lblUsrName.BorderStyle(0)
Gui.fLogin.lblPassWord.Create(Label,"!",False,240,330,0,3870,660,True,0,"Arial",12,-2147483633,0,0)
Gui.fLogin.lblPassWord.ForeColor(255)
Gui.fLogin.lblPassWord.BorderStyle(0)
Gui.FormMessageBox..Create(BaseForm)
Gui.FormMessageBox..Caption("Title")
Gui.FormMessageBox..Size(5715,2145)
Gui.FormMessageBox..MinX(0)
Gui.FormMessageBox..MinY(0)
Gui.FormMessageBox..Position(0,0)
Gui.FormMessageBox..AlwaysOnTop(True)
Gui.FormMessageBox..BackColor(-2147483633)
Gui.FormMessageBox..MaxButton(False)
Gui.FormMessageBox..MinButton(False)
Gui.FormMessageBox..MousePointer(0)
Gui.FormMessageBox..Sizeable(False)
Gui.FormMessageBox..Event(UnLoad,FormMessageBox_UnLoad)
Gui.FormMessageBox..FontName("Tahoma")
Gui.FormMessageBox..FontSize(8.25)
Gui.FormMessageBox..ControlBox(True)
Gui.FormMessageBox..Moveable(True)
Gui.FormMessageBox..ShowInTaskBar(True)
Gui.FormMessageBox..TitleBar(True)
Gui.FormMessageBox.lblMsgBox.Create(Label,"Message",True,5400,1245,0,105,165,True,2,"Arial",10,-2147483633,0,0)
Gui.FormMessageBox.lblMsgBox.ForeColor(16711680)
Gui.FormMessageBox.lblMsgBox.BorderStyle(0)
Gui.FormMessageBox.cmdMsgNo.Create(Button)
Gui.FormMessageBox.cmdMsgNo.Size(990,375)
Gui.FormMessageBox.cmdMsgNo.Position(4515,1425)
Gui.FormMessageBox.cmdMsgNo.Caption("No")
Gui.FormMessageBox.cmdMsgNo.Event(Click,cmdMsgNO_Click)
Gui.FormMessageBox.cmdMsgNo.Enabled(True)
Gui.FormMessageBox.cmdMsgNo.Visible(True)
Gui.FormMessageBox.cmdMsgNo.Zorder(0)
Gui.FormMessageBox.cmdMsgNo.FontName("Tahoma")
Gui.FormMessageBox.cmdMsgNo.FontSize(8.25)
Gui.FormMessageBox.cmdMsgYes.Create(Button)
Gui.FormMessageBox.cmdMsgYes.Size(990,375)
Gui.FormMessageBox.cmdMsgYes.Position(3390,1425)
Gui.FormMessageBox.cmdMsgYes.Caption("Yes")
Gui.FormMessageBox.cmdMsgYes.Event(Click,cmdMsgYes_Click)
Gui.FormMessageBox.cmdMsgYes.Enabled(True)
Gui.FormMessageBox.cmdMsgYes.Visible(True)
Gui.FormMessageBox.cmdMsgYes.Zorder(0)
Gui.FormMessageBox.cmdMsgYes.FontName("Tahoma")
Gui.FormMessageBox.cmdMsgYes.FontSize(8.25)
Gui.F_newNotes..Create(BaseForm)
Gui.F_newNotes..Caption("Job Seq Notes")
Gui.F_newNotes..Size(8730,6210)
Gui.F_newNotes..MinX(0)
Gui.F_newNotes..MinY(0)
Gui.F_newNotes..Position(0,0)
Gui.F_newNotes..AlwaysOnTop(False)
Gui.F_newNotes..FontName("Tahoma")
Gui.F_newNotes..FontSize(8.25)
Gui.F_newNotes..ControlBox(True)
Gui.F_newNotes..MaxButton(True)
Gui.F_newNotes..MinButton(True)
Gui.F_newNotes..MousePointer(0)
Gui.F_newNotes..Moveable(True)
Gui.F_newNotes..Sizeable(True)
Gui.F_newNotes..ShowInTaskBar(True)
Gui.F_newNotes..TitleBar(True)
Gui.F_newNotes..Event(UnLoad,F_newNotes_UnLoad)
Gui.F_newNotes.txtNewNotes.Create(TextboxM)
Gui.F_newNotes.txtNewNotes.Enabled(True)
Gui.F_newNotes.txtNewNotes.Visible(True)
Gui.F_newNotes.txtNewNotes.Zorder(0)
Gui.F_newNotes.txtNewNotes.Size(8580,5235)
Gui.F_newNotes.txtNewNotes.Position(75,420)
Gui.F_newNotes.txtNewNotes.FontName("Tahoma")
Gui.F_newNotes.txtNewNotes.FontSize(8.25)
Gui.F_newNotes.txtNewNotes.Anchor(15)
Gui.F_newNotes.cmdNotesOk.Create(Button)
Gui.F_newNotes.cmdNotesOk.Enabled(True)
Gui.F_newNotes.cmdNotesOk.Visible(True)
Gui.F_newNotes.cmdNotesOk.Zorder(0)
Gui.F_newNotes.cmdNotesOk.Size(1125,345)
Gui.F_newNotes.cmdNotesOk.Position(7515,30)
Gui.F_newNotes.cmdNotesOk.Caption("OK")
Gui.F_newNotes.cmdNotesOk.FontName("Tahoma")
Gui.F_newNotes.cmdNotesOk.FontSize(8.25)
Gui.F_newNotes.cmdNotesOk.Event(Click,cmdNotesOk_Click)
Gui.F_newNotes.cmdNotesOk.Anchor(9)
Gui.F_New_Line..Create(BaseForm)
Gui.F_New_Line..Caption("Job Seq Notes")
Gui.F_New_Line..Size(9435,6585)
Gui.F_New_Line..MinX(0)
Gui.F_New_Line..MinY(0)
Gui.F_New_Line..Position(0,0)
Gui.F_New_Line..AlwaysOnTop(False)
Gui.F_New_Line..FontName("Tahoma")
Gui.F_New_Line..FontSize(8.25)
Gui.F_New_Line..ControlBox(True)
Gui.F_New_Line..MaxButton(True)
Gui.F_New_Line..MinButton(True)
Gui.F_New_Line..MousePointer(0)
Gui.F_New_Line..Moveable(True)
Gui.F_New_Line..Sizeable(True)
Gui.F_New_Line..ShowInTaskBar(True)
Gui.F_New_Line..TitleBar(True)
Gui.F_New_Line..Event(UnLoad,F_New_Line_UnLoad)
Gui.F_New_Line.cmd_newOKLine.Create(Button)
Gui.F_New_Line.cmd_newOKLine.Enabled(True)
Gui.F_New_Line.cmd_newOKLine.Visible(True)
Gui.F_New_Line.cmd_newOKLine.Zorder(0)
Gui.F_New_Line.cmd_newOKLine.Size(1125,345)
Gui.F_New_Line.cmd_newOKLine.Position(8190,30)
Gui.F_New_Line.cmd_newOKLine.Caption("OK")
Gui.F_New_Line.cmd_newOKLine.FontName("Tahoma")
Gui.F_New_Line.cmd_newOKLine.FontSize(8.25)
Gui.F_New_Line.cmd_newOKLine.Event(Click,cmd_newOKLine_Click)
Gui.F_New_Line.cmd_newOKLine.Anchor(9)
Gui.F_New_Line.txt1.Create(TextboxM)
Gui.F_New_Line.txt1.Enabled(True)
Gui.F_New_Line.txt1.Visible(True)
Gui.F_New_Line.txt1.Zorder(0)
Gui.F_New_Line.txt1.Size(9285,5625)
Gui.F_New_Line.txt1.Position(60,420)
Gui.F_New_Line.txt1.FontName("Tahoma")
Gui.F_New_Line.txt1.FontSize(8.25)
Gui.FormTimeAdjust..Create(BaseForm)
Gui.FormTimeAdjust..Caption("Time Adjustment")
Gui.FormTimeAdjust..Size(6420,5430)
Gui.FormTimeAdjust..MinX(0)
Gui.FormTimeAdjust..MinY(0)
Gui.FormTimeAdjust..Position(0,0)
Gui.FormTimeAdjust..AlwaysOnTop(False)
Gui.FormTimeAdjust..FontName("Tahoma")
Gui.FormTimeAdjust..FontSize(8.25)
Gui.FormTimeAdjust..ControlBox(True)
Gui.FormTimeAdjust..MaxButton(True)
Gui.FormTimeAdjust..MinButton(True)
Gui.FormTimeAdjust..MousePointer(0)
Gui.FormTimeAdjust..Moveable(True)
Gui.FormTimeAdjust..Sizeable(False)
Gui.FormTimeAdjust..ShowInTaskBar(True)
Gui.FormTimeAdjust..TitleBar(True)
Gui.FormTimeAdjust..Event(UnLoad,FormTimeAdjust_UnLoad)
Gui.FormTimeAdjust.lblHr.Create(Label,"Decimal Time",True,915,195,0,210,210,True,0,"Tahoma",8.25,,0,0)
Gui.FormTimeAdjust.lblHr.BorderStyle(0)
Gui.FormTimeAdjust.txtHour.Create(TextBox,"",True,570,300,0,195,510,True,0,"Tahoma",8.25,,1)
Gui.FormTimeAdjust.txtHour.NumericOnly(1)
Gui.FormTimeAdjust.lblReason.Create(Label,"Reason",True,540,195,0,1620,255,True,0,"Tahoma",8.25,,0,0)
Gui.FormTimeAdjust.lblReason.BorderStyle(0)
Gui.FormTimeAdjust.ddlReason.Create(DropDownList)
Gui.FormTimeAdjust.ddlReason.Enabled(True)
Gui.FormTimeAdjust.ddlReason.Visible(True)
Gui.FormTimeAdjust.ddlReason.Zorder(0)
Gui.FormTimeAdjust.ddlReason.Size(2880,300)
Gui.FormTimeAdjust.ddlReason.Position(1575,540)
Gui.FormTimeAdjust.ddlReason.FontName("Tahoma")
Gui.FormTimeAdjust.ddlReason.FontSize(8.25)
Gui.FormTimeAdjust.lblNote.Create(Label,"Note",True,345,195,0,195,990,True,0,"Tahoma",8.25,,0,0)
Gui.FormTimeAdjust.lblNote.BorderStyle(0)
Gui.FormTimeAdjust.txtNote.Create(TextBoxR)
Gui.FormTimeAdjust.txtNote.Enabled(True)
Gui.FormTimeAdjust.txtNote.Visible(True)
Gui.FormTimeAdjust.txtNote.Zorder(0)
Gui.FormTimeAdjust.txtNote.Size(6000,3000)
Gui.FormTimeAdjust.txtNote.Position(180,1245)
Gui.FormTimeAdjust.txtNote.FontName("Tahoma")
Gui.FormTimeAdjust.txtNote.FontSize(8.25)
Gui.FormTimeAdjust.cmdUpdate.Create(Button)
Gui.FormTimeAdjust.cmdUpdate.Enabled(True)
Gui.FormTimeAdjust.cmdUpdate.Visible(True)
Gui.FormTimeAdjust.cmdUpdate.Zorder(0)
Gui.FormTimeAdjust.cmdUpdate.Size(1125,345)
Gui.FormTimeAdjust.cmdUpdate.Position(225,4485)
Gui.FormTimeAdjust.cmdUpdate.Caption("Update")
Gui.FormTimeAdjust.cmdUpdate.FontName("Tahoma")
Gui.FormTimeAdjust.cmdUpdate.FontSize(8.25)
Gui.FormTimeAdjust.cmdUpdate.Event(Click,cmdUpdate_Click1)
Gui.FormTimeAdjust.lblMin.Create(Label,"Minutes",False,555,195,0,5640,225,True,0,"Tahoma",8.25,,0,0)
Gui.FormTimeAdjust.lblMin.BorderStyle(0)
Gui.FormTimeAdjust.txtMin.Create(TextBox,"",False,480,300,0,5640,510,True,0,"Tahoma",8.25,,1)
Gui.FormTimeAdjust.txtMin.NumericOnly(2)
Gui.FormPrev..Create(BaseForm)
Gui.FormPrev..Caption("Previous PayPeriod Timesheet")
Gui.FormPrev..Size(19740,10800)
Gui.FormPrev..MinX(0)
Gui.FormPrev..MinY(0)
Gui.FormPrev..Position(0,0)
Gui.FormPrev..AlwaysOnTop(False)
Gui.FormPrev..FontName("Tahoma")
Gui.FormPrev..FontSize(8.25)
Gui.FormPrev..ControlBox(True)
Gui.FormPrev..MaxButton(True)
Gui.FormPrev..MinButton(True)
Gui.FormPrev..MousePointer(0)
Gui.FormPrev..Moveable(True)
Gui.FormPrev..Sizeable(True)
Gui.FormPrev..ShowInTaskBar(True)
Gui.FormPrev..TitleBar(True)
Gui.FormPrev..Event(UnLoad,FormPrev_UnLoad)
Gui.FormPrev.GsGridPrev.Create(GsGridControl)
Gui.FormPrev.GsGridPrev.Enabled(True)
Gui.FormPrev.GsGridPrev.Visible(True)
Gui.FormPrev.GsGridPrev.Zorder(0)
Gui.FormPrev.GsGridPrev.Size(19605,9795)
Gui.FormPrev.GsGridPrev.Position(90,105)
Gui.FormPrev.GsGridPrev.Anchor(15)
Gui.FormPrev.cmdPrevPrint.Create(Button)
Gui.FormPrev.cmdPrevPrint.Enabled(True)
Gui.FormPrev.cmdPrevPrint.Visible(True)
Gui.FormPrev.cmdPrevPrint.Zorder(0)
Gui.FormPrev.cmdPrevPrint.Size(1530,345)
Gui.FormPrev.cmdPrevPrint.Position(195,9960)
Gui.FormPrev.cmdPrevPrint.Caption("Print")
Gui.FormPrev.cmdPrevPrint.FontName("Tahoma")
Gui.FormPrev.cmdPrevPrint.FontSize(8.25)
Gui.FormPrev.cmdPrevPrint.Event(Click,cmdPrevPrint_Click)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
V.Global.sMessageBoxReturn.Declare(String)
V.Global.dDate.Declare(Date,1/1/1900)
V.Global.sDetl.Declare(String)
V.Global.sTA.Declare(String)
V.Global.iChk.Declare(Long,0)
V.Global.iRun.Declare(Long,0)
V.Global.sUser.Declare(String)
V.Global.bAdminMode.Declare(Boolean,False)
V.Global.iBIRUNID.Declare(Long,0)
V.Global.iLogID.Declare(Long,0)
V.Global.bSaveMsg.Declare(boolean,false)
V.Global.bReady.Declare(boolean,false)
v.Global.iRowId.Declare(Long,0)
V.Global.iIncr.Declare(Long,0)
V.Global.dStart.Declare(Date)
V.Global.dEnd.Declare(Date)
V.Global.sEmployee.Declare(String)
V.Global.bUpdate.Declare(Boolean,False)
V.Global.dDateRecord.Declare(Date)
V.Global.bCurrent.Declare(Boolean,False)
V.Global.sAdminUser.Declare(String)
Program.External.Include.Library("JB0455.lib")
Program.Sub.Preflight.End

Program.Sub.Main.Start
F.Intrinsic.Control.Try

v.Local.sSql.Declare(String)
v.Local.sCaption.Declare(String)

'current Lib file JB0455 doesn't have the two colums emple rate and scrap ref
F.Intrinsic.Control.If(V.DataTable.JB0455.Exists)
	F.Data.DataTable.Close("JB0455")

	F.Data.DataTable.Create("JB0455",True)
	F.Data.DataTable.AddColumn("JB0455","Date","String")
	F.Data.DataTable.AddColumn("JB0455","Employee","String")
	F.Data.DataTable.AddColumn("JB0455","Job","String")
	F.Data.DataTable.AddColumn("JB0455","Suffix","String")
	F.Data.DataTable.AddColumn("JB0455","Seq","String")
	F.Data.DataTable.AddColumn("JB0455","WC","String")
	F.Data.DataTable.AddColumn("JB0455","Hours","String")
	F.Data.DataTable.AddColumn("JB0455","Closed","String")
	F.Data.DataTable.AddColumn("JB0455","Indirect","String")
	F.Data.DataTable.AddColumn("JB0455","StartTime","String")
	F.Data.DataTable.AddColumn("JB0455","StopTime","String")
	F.Data.DataTable.AddColumn("JB0455","RateType","String")
	F.Data.DataTable.AddColumn("JB0455","GoodPcs","String")
	F.Data.DataTable.AddColumn("JB0455","ScrapPcs","String")
	F.Data.DataTable.AddColumn("JB0455","Reason","String")
	F.Data.DataTable.AddColumn("JB0455","EMPL-RATE","String")
	F.Data.DataTable.AddColumn("JB0455","SCRAP-REF","String")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(SetIcon)

F.Intrinsic.Control.If(v.Caller.Hook,=,15710)
	
	Variable.Passed.000020.Set("Timesheet")
F.Intrinsic.Control.Elseif(v.Caller.Hook,=,15770)
	F.Intrinsic.string.build("Select Distinct GS_USER from USER_INFORMATION where company = '{0}' or company_specific = 0",v.caller.CompanyCode,v.Local.sSql)
	F.ODBC.Connection!conx.OpenCommonConnection
	F.Intrinsic.Control.try	
		F.Data.DataTable.CreateFromSQL("USERDT","CONX",v.Local.sSql,true)
	F.Intrinsic.Control.Catch
		F.Intrinsic.UI.Msgbox("Oops! Something went wrong. Please contact Global Shop Solutions.")
	F.Intrinsic.Control.Finally
		F.ODBC.Connection!conx.Close
	F.Intrinsic.Control.EndTry
	F.Intrinsic.Control.If(v.DataTable.USERDT.Exists)
		F.Data.DataView.Create("USERDT","USERVw",22)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.CallSub(GetGSUserFromWindowsUser, "WindowsUser", V.System.UserName)
	
	F.Intrinsic.Control.If(V.Args.GSUser.Trim, =, "")
		F.Intrinsic.Control.BlockEvents
		F.Intrinsic.Control.CallSub(Get_PayPeriod)
		F.Intrinsic.Control.UnBlockEvents
		GUI.fLogin..Show
	F.Intrinsic.Control.Else
		V.Global.sUser.Set(V.Args.GSUser.Trim)
		F.Intrinsic.Control.BlockEvents
		F.Intrinsic.Control.CallSub(Get_PayPeriod)
		F.Intrinsic.Control.CallSub(PostSignIn)
		F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.CallSub(Get_PayPeriod)
	F.Intrinsic.Control.CallSub(PostSignIn)
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.GetGSUserFromWindowsUser.Start
'check the windows user when launched from the GUI. If there is a GS User tied to that open the timesheet for them
'Otherwise they need to sign in

F.Intrinsic.Control.Try
	
V.Local.sWindowsUser.Declare(String)
V.Local.sGSUser.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.bInString.Declare(Boolean)
V.Local.sMessage.Declare(String)
V.Local.sSplit.Declare(String)

V.Local.sWindowsUser.Set(V.Args.WindowsUser.Trim)
F.Intrinsic.String.Build("select USER_ID from USER_SECURITY where UPPER(WINDOW_USER) = '{0}'", V.Local.sWindowsUser.UCase, V.Local.sSQL)
F.ODBC.Connection!Com.OpenCommonConnection
F.ODBC.Connection!Com.ExecuteAndReturn(V.Local.sSQL, V.Local.sGSUser)
F.ODBC.Connection!Com.Close

F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
	V.Local.sGSUser.Set("")
F.Intrinsic.Control.EndIf

F.Intrinsic.String.IsInString(V.Local.sGSUser, "#$#", True, V.Local.bInString)
F.Intrinsic.Control.If(V.Local.bInString)
	F.Intrinsic.String.Build("Warning: Multiple GS Users with the windows username {0}. User will need to sign in.", V.Local.sWindowsUser, V.Local.sMessage)
	F.Intrinsic.UI.Msgbox(V.Local.sMessage)
	V.Local.sGSUser.Set("")
F.Intrinsic.Control.EndIf

F.Global.Security.GetUsernameFromID(V.Local.sGSUser, V.Local.sGSUser)
F.Intrinsic.Control.If(V.Local.sGSUser.IsNotNoReturn)
	F.Intrinsic.String.Split(V.Local.sGSUser, "*!*", V.Local.sSplit)
	V.Local.sGSUser.Set(V.Local.sSplit(0))
F.Intrinsic.Control.Else
	V.Local.sGSUser.Set("")
F.Intrinsic.Control.EndIf

F.Intrinsic.Variable.AddRV("GSUser", V.Local.sGSUser)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.GetGSUserFromWindowsUser.End

Program.Sub.cmdSignIn_Click.Start
F.Intrinsic.Control.Try

v.Local.sFilter.Declare
v.Local.sPass.Declare
v.Local.sUser.Declare
v.Local.bLogin.Declare

GUI.fLogin..Enabled(False)
v.Local.sUser.Set(v.Screen.fLogin!txtUser.text)
v.Local.sPass.Set(v.Screen.fLogin!txtPassword.text)
F.Intrinsic.Control.If(v.Local.sUser.trim,=,"")
	F.Intrinsic.UI.Msgbox("Please enter a User Name to login.")
	GUI.fLogin.lblUsrName.Visible(True)
	GUI.fLogin..Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Else
	GUI.fLogin.lblUsrName.Visible(False)
F.Intrinsic.Control.EndIf
F.Intrinsic.String.Build("GS_USER = '{0}'",v.Local.sUser.UCase,v.Local.sFilter)
F.Data.DataView.SetFilter("USERDT","USERVw",v.Local.sFilter)
F.Intrinsic.Control.If(v.DataView.USERDT!USERVw.RowCount,=,0)
	F.Intrinsic.UI.Msgbox("Please enter a Valid User Name to login.")
	GUI.fLogin.lblUsrName.Visible(True)
	GUI.fLogin..Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Else
	GUI.fLogin.lblUsrName.Visible(False)
F.Intrinsic.Control.EndIf

F.Global.Security.ValidateUser(v.Caller.CompanyCode,v.Local.sUser.UCase,v.Local.sPass,v.Local.bLogin)
F.Intrinsic.Control.If(v.Local.bLogin)
	GUI.fLogin.lblPassWord.Visible(False)
	GUI.fLogin..Visible(False)
	v.Global.sUser.set(v.Local.sUser.UCase)
	F.Intrinsic.Control.CallSub(PostSignIn)
F.Intrinsic.control.Else
	F.Intrinsic.UI.Msgbox("Password is Incorrect. Please enter a Valid Password.")
	GUI.fLogin.lblPassWord.Visible(True)
	GUI.fLogin..Enabled(True)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdSignIn_Click.End

Program.Sub.PostSignIn.Start
F.Intrinsic.Control.Try

F.ODBC.Connection!con.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass,7200)
F.Intrinsic.Control.CallSub(Admin_mode)
F.Intrinsic.Control.CallSub(Dtpweek_change)

F.Intrinsic.Control.CallSub(EmptyTotals)
F.Intrinsic.Control.CallSub(Gridload)

F.Intrinsic.Control.CallSub(Gridtitle)
F.Intrinsic.Control.CallSub(ComputeTotals)

GUI.FormTimesheet..Show
Gui.FormTimesheet..AlwaysOnTop(True)
Gui.FormTimesheet..AlwaysOnTop(False)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.PostSignIn.End

Program.Sub.fLogin_UnLoad.Start
F.Intrinsic.Control.Try

'F.Intrinsic.Control.End

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.fLogin_UnLoad.End

Program.Sub.dtpweek_change.Start
F.Intrinsic.Control.Try

V.Local.sFilter.Declare(String)
V.Local.bRet.Declare(Boolean,False)
V.Local.dDate.Declare(Date)
V.Local.dStart.Declare(Date)
V.Local.dEnd.Declare(Date)
'get the date value from the screen and compute the beginning of the week for that data. in this case we are looking for the Monday of that week
V.Local.dDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)

F.Intrinsic.String.Build("[Start] <= '#{0}#' and [End] >= '#{0}#'",V.Screen.FormTimesheet!dtpWeek.Value,V.Local.sFilter)

F.Data.DataView.Create("PayPeriods","Temp",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.DataView.PayPeriods!Temp.RowCount--,<>,-1)
	V.Global.bCurrent.Set(V.DataView.PayPeriods!Temp(V.DataView.PayPeriods!Temp.RowCount--).Current!FieldVal)
	F.Intrinsic.Control.BlockEvents
	Gui.FormTimesheet.dtpWeek.Value(V.DataView.PayPeriods!Temp(V.DataView.PayPeriods!Temp.RowCount--).Start!FieldVal)
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.DataTable.PayPeriods(V.DataTable.PayPeriods.RowCount--).End!FieldVal,<,V.Screen.FormTimesheet!dtpWeek.Value)
		F.Intrinsic.UI.Msgbox("No Future Time Cards.  Setting Date to Current Payperiod")
		F.Data.DataView.Create("PayPeriods","VCurrent",22,"Current = True","")
		V.Global.bCurrent.Set(True)
		F.Intrinsic.Control.BlockEvents
		Gui.FormTimesheet.dtpWeek.Value(V.DataView.PayPeriods!VCurrent(V.DataView.PayPeriods!VCurrent.RowCount--).Start!FieldVal)
		F.Intrinsic.Control.UnBlockEvents
		F.Data.DataView.Close("PayPeriods","VCurrent")
	F.Intrinsic.Control.Else
		V.Global.bCurrent.Set(False)
	
		Gui.FormTimesheet..Enabled(False)
		V.Local.dStart.Set(V.DataTable.PayPeriods(0).Start!FieldVal)
		F.Intrinsic.Control.DoUntil(V.Local.bRet)
			F.Intrinsic.Date.DateAdd("D",-1,V.Local.dStart,V.Local.dEnd)
			F.Intrinsic.Date.DateAdd("D",-14,V.Local.dStart,V.Local.dStart)
			F.Intrinsic.Control.If(V.Local.dStart,<=,V.Local.dDate,"AND",V.Local.dEnd,>=,V.Local.dDate)
				F.Intrinsic.Control.BlockEvents
				Gui.FormTimesheet.dtpWeek.Value(V.Local.dStart)
				F.Intrinsic.Control.UnBlockEvents
				V.Local.bRet.Set(True)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Loop
		Gui.FormTimesheet..Enabled(True)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("PayPeriods","Temp")
'F.Intrinsic.Date.BeginningOfWeek(V.Local.dDate,V.Local.dDate)

''set this as initial value
'GUI.FormTimesheet.dtpWeek.Value(V.Local.dDate)

V.Global.dDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)

F.Intrinsic.Control.BlockEvents
F.Intrinsic.UI.InvokeWaitDialog("Reloading the Grid.................")
F.Intrinsic.Control.CallSub(cmdRefresh_Click)
F.Intrinsic.UI.CloseWaitDialog
F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.dtpweek_change.End

Program.Sub.FormTimesheet_unload.Start
F.Intrinsic.Control.Try

V.Local.sRet.Declare(String)
V.Local.sSQL.Declare(String)
v.Local.bReady.Declare(Boolean)
V.Local.sSerialize.Declare(String)

F.Intrinsic.String.Build("Select Distinct(Flag_Ready) as Flag_Ready from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' ORDER BY JOB, SUFFIX, SEQ",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
F.ODBC.Connection!con.OpenRecordsetRO("rst",V.Local.sSql)

F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,"True")
	'check against the ready flag. If it's ready marked as true we are going to disable the save and enable the print.
	'and if we are not in admin mode.
	F.Intrinsic.Control.If(V.Global.bAdminMode,=,False)
		F.Intrinsic.Control.If(V.ODBC.con!rst.FieldValTrim!Flag_Ready,=,"True")
			V.Local.bReady.Set(True)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.ODBC.con!rst.MoveNext
F.Intrinsic.Control.Loop
F.ODBC.con!rst.Close

'check to see if the save varaible is true. this means changes were made and it asks if the user wants to save changes before exiting the application
f.Intrinsic.Control.If(v.DataTable.dtTimesheet.RowCount,>,0,"AND",v.Global.bAdminMode,=,false,v.Global.bSaveMsg,=,true)
	f.Intrinsic.Control.If(V.Local.bReady,=,false)
		F.Intrinsic.UI.Msgbox("Do you wish to save existing data before exiting?","Save Data?",3,V.Local.sRet)
		F.Intrinsic.Control.If(v.Local.sRet,=,2)
			F.Intrinsic.Control.ExitSub
		F.Intrinsic.Control.ElseIf(v.Local.sRet,=,6)
			v.Global.bSaveMsg.Set(false)
			F.Intrinsic.Control.CallSub(cmdsave_click)	
			v.Global.bSaveMsg.Set(false)
		F.Intrinsic.Control.Else
			v.Global.bSaveMsg.Set(false)			
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.ODBC.Connection!ConC.OpenCommonConnection
F.Intrinsic.String.Build("Delete From GS_REGISTRY where program = 'GVTIMESHEET' and REG_ID = 6873 and Seq < 2002 and Company = '{0}'",V.Caller.CompanyCode,V.Local.sSQL)
F.ODBC.Connection!conC.Execute(V.Local.sSQL)
F.ODBC.Connection!ConC.Close

GUI.FormTimesheet.gsgcTimesheet.Serialize("gvTimesheet", V.Local.sSerialize)
F.Global.Registry.AddValue(V.Caller.User, V.Caller.CompanyCode, "gvTimesheet", 6873, 2002, False, "Serialize", False, 0, -999.0 , 1/1/1980, 12:00:00 AM, V.Local.sSerialize)

F.ODBC.Connection!con.Close
F.Intrinsic.Control.End

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndTry
Program.Sub.FormTimesheet_unload.End

Program.Sub.GridTitle.Start
F.Intrinsic.Control.Try

V.Local.sDate.Declare(String)
V.Local.dDate.Declare(String)
V.Local.iCol.Declare(Long)

V.Global.dDateRecord.Redim(0,13)

'Set Table Header for Main Screen.
'set the header captions and column widths
F.Intrinsic.Control.BlockEvents
GUI.FormTimesheet.gsgcTimesheet.SuspendLayout

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","POTENTIAL_HOURS","caption","Potential Hours Decimal")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","POTENTIAL_HOURS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","POTENTIAL_HOURS","Visible",False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours","caption","Potential Hours")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "AllowEdit", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "ReadOnly", True)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","caption","Flag Hold")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","Visible", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","MinWidth", 50)

V.Global.dDateRecord.Set(V.Global.dDate.FORMATM/DD/YY)

F.Intrinsic.String.Build("Sun: {0}",V.Global.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Sun Notes: {0}",V.Global.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.Global.dDate,V.local.dDate)
V.Global.dDateRecord(1).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Mon: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Mon Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.local.dDate,V.Local.dDate)
V.Global.dDateRecord(2).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Tues: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Tues Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
V.Global.dDateRecord(3).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Wed: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Wed Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
V.Global.dDateRecord(4).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Thur: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","MaxWidth", 60)

V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Thur Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
V.Global.dDateRecord(5).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Fri: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Fri Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
V.Global.dDateRecord(6).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Sat: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Sat Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
V.Global.dDateRecord(7).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Sun: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY2_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY2_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY2_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Sun Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.local.dDate)
V.Global.dDateRecord(8).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Mon: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY2_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY2_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY2_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Mon Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.local.dDate,V.Local.dDate)
V.Global.dDateRecord(9).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Tues: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY2_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY2_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY2_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Tues Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
V.Global.dDateRecord(10).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Wed: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY2_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY2_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY2_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Wed Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
V.Global.dDateRecord(11).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Thur: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY2_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY2_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY2_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","MaxWidth", 60)

V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Thur Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
V.Global.dDateRecord(12).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Fri: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY2_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY2_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY2_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Fri Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_NOTES","HeaderWordWrap","Wrap")

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
V.Global.dDateRecord(13).Set(V.local.dDate.FORMATM/DD/YY)
F.Intrinsic.String.Build("Sat: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY2_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY2_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY2_HOURS_EDIT","HeaderWordWrap","Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS","Visible",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS","AllowShowHide",False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS","HeaderWordWrap","Wrap")

F.Intrinsic.String.Build("Sat Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_NOTES","caption",V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_NOTES","HeaderWordWrap","Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMask", "####0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMask", "####0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMask", "####0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMask", "####0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMask", "####0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMask", "####0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMask", "####0.00")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "EditMask", "####0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "EditMask", "####0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "EditMask", "####0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "EditMask", "####0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "EditMask", "####0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "EditMask", "####0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "EditMask", "####0.00")

gui.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet","SUNDAY_HOURS_EDIT","SUNDAY_HOURS_EDIT_Sum","Sum","","","n2")
GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "MONDAY_HOURS_EDIT","MONDAY_HOURS_EDIT_Sum","Sum","","","n2")
GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "TUESDAY_HOURS_EDIT","TUESDAY_HOURS_EDIT_Sum","Sum","","","n2")
GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "WEDNESDAY_HOURS_EDIT","WEDNESDAY_HOURS_EDIT_Sum","Sum","","","n2")
GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "THURSDAY_HOURS_EDIT","THURSDAY_HOURS_EDIT_Sum","Sum","","","n2")
GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "FRIDAY_HOURS_EDIT","FRIDAY_HOURS_EDIT_Sum","Sum","","","n2")
GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "SATURDAY_HOURS_EDIT","SATURDAY_HOURS_EDIT_Sum","Sum","","","n2")

gui.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet","SUNDAY2_HOURS_EDIT","SUNDAY2_HOURS_EDIT_Sum","Sum","","","n2")
GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "MONDAY2_HOURS_EDIT","MONDAY2_HOURS_EDIT_Sum","Sum","","","n2")
GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "TUESDAY2_HOURS_EDIT","TUESDAY2_HOURS_EDIT_Sum","Sum","","","n2")
GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "WEDNESDAY2_HOURS_EDIT","WEDNESDAY2_HOURS_EDIT_Sum","Sum","","","n2")
GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "THURSDAY2_HOURS_EDIT","THURSDAY2_HOURS_EDIT_Sum","Sum","","","n2")
GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "FRIDAY2_HOURS_EDIT","FRIDAY_HOURS2_EDIT_Sum","Sum","","","n2")
GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "SATURDAY2_HOURS_EDIT","SATURDAY2_HOURS_EDIT_Sum","Sum","","","n2")

GUI.FormTimesheet.gsgcTimesheet.AddSummaryItem("gvTimesheet", "JOB_TOTAL_TIME","JOB_TOTAL_TIME_Sum","Sum","","","n2")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_HOURS", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_HOURS", "EditMask", "####0.00")

GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "Flag_Ready", "Condition15", "Expression","FLAG_READY = TRUE AND UPDATED = FALSE")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "Flag_Ready", "Condition15", "BackColor", "#90ee90")
Gui.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet","Flag_Ready","Condition15","ApplyToRow",True)

GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "Updated", "Condition16", "Equal",TRUE)
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "Updated", "Condition16", "BackColor", "#9dceea")
Gui.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet","Updated","Condition16","ApplyToRow",True)

GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "P_Hours", "Condition17", "Expression","POTENTIAL_HOURS > HOURS_ESTIMATED")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "P_Hours", "Condition17", "BackColor", "#FF0000")

GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "OVT_HRS", "Condition18", "Expression","OVT_HRS > JOB_SUM AND OVT_HRS > 0")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "OVT_HRS", "Condition18", "BackColor", "#FF0000")

F.Intrinsic.Control.UnBlockEvents
GUI.FormTimesheet.gsgcTimesheet.ResumeLayout

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.GridTitle.End

Program.Sub.cmdrefresh_click.Start
F.Intrinsic.Control.Try

Gui.FormTimesheet.cmdRefresh.Enabled(False)
v.Global.bSaveMsg.Set(false)
F.Intrinsic.Control.CallSub(EmptyTotals)
F.Intrinsic.Control.CallSub(Gridload)
F.Intrinsic.Control.CallSub(Gridtitle)
F.Intrinsic.Control.CallSub(ComputeTotals)
Gui.FormTimesheet.cmdRefresh.Enabled(True)
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdrefresh_click.End

Program.Sub.GridLoad.Start
F.Intrinsic.Control.Try

V.Local.sJSS.Declare(String)
V.Local.sJS.Declare(String)
V.Local.sJob.Declare(String)
V.Local.sSeq.Declare(String)
V.Local.sSuffix.Declare(String)
V.Local.sSql.Declare(String)
V.Local.iUB.Declare(Long)
V.Local.i.Declare(Long)
V.Local.iCheck.Declare(Long)
V.Local.bReady.Declare
v.Local.sWC.Declare(String)
V.Local.bUpdated.Declare(Boolean, False)
V.Local.sCol.Declare(String)
V.Local.fEst.Declare(Float)
V.Local.fAct.Declare(Float)
V.Local.sDate.Declare(String)
V.Local.sSerialize.Declare(String)
V.Local.sFilter.Declare(String)
V.Local.sUserTemp.Declare(String)
V.Local.bRet.Declare(Boolean, False)
V.Local.dColDate.Declare(Date)
V.Local.sEmp.Declare(String,"")
V.Local.bSpedJob.Declare(Boolean,"")

V.Local.sEmp.Set(V.Global.sEmployee.Right3)

F.Intrinsic.Control.If(V.Local.sEmp.Left2,=,"00")
	V.Local.sEmp.Set(V.Local.sEmp.Right1)
F.Intrinsic.Control.ElseIf(V.Local.sEmp.Left1,=,"0")
	V.Local.sEmp.Set(V.Local.sEmp.Right2)
F.Intrinsic.Control.EndIf

V.Local.sUserTemp.Set(V.Screen.FormTimesheet!txtUser.Text)

F.Intrinsic.String.Build("[Start] <= '#{0}#' and [End] >= '#{0}#'",V.Screen.FormTimesheet!dtpWeek.Value,V.Local.sFilter)
F.Data.DataView.Create("PayPeriods","Temp",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.DataView.PayPeriods!Temp.RowCount--,<>,-1)
	V.Global.bCurrent.Set(V.DataView.PayPeriods!Temp(V.DataView.PayPeriods!Temp.RowCount--).Current!FieldVal)
F.Intrinsic.Control.Else
	V.Global.bCurrent.Set(False)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("PayPeriods","Temp")

V.Local.sDate.Set(V.Ambient.Date.FORMATM/DD/YY)

GUI.FormTimesheet.gsgcTimesheet.Visible(False)

V.Local.bReady.Set(False)
V.Local.bUpdated.Set(False)
F.Intrinsic.Control.BlockEvents

F.Data.Dictionary.Exists("DescDict",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("DescDict")
F.Intrinsic.Control.EndIf
F.data.dictionary.CreateFromSQL("DescDict","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,DESCRIPTION from V_JOB_HEADER ")
F.Data.Dictionary.SetDefaultReturn("DescDict","")

F.Data.Dictionary.Exists("FGDict",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("FGDict")
F.Intrinsic.Control.EndIf
F.data.dictionary.CreateFromSQL("FGDict","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,IF(Display_Part is null,PART,Display_Part) as Part from V_JOB_HEADER a Left Join Inv_LXR b on a.Part = b.Gss_Part")
F.Data.Dictionary.SetDefaultReturn("FGDict","")

F.Data.Dictionary.Exists("dictSeqDesc",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("dictSeqDesc")
F.Intrinsic.Control.EndIf
F.Data.Dictionary.CreateFromSQL("dictSeqDesc", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(DESCRIPTION) as DESCRIPTION from V_JOB_OPERATIONS where LMO = 'L'")
F.Data.Dictionary.SetDefaultReturn("dictSeqDesc", "")

F.Data.Dictionary.Exists("FGDate",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("FGDate")
F.Intrinsic.Control.EndIf
F.data.dictionary.CreateFromSQL("FGDate","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,Date_Due from V_JOB_HEADER ")
F.Data.Dictionary.SetDefaultReturn("FGDate","01/01/1900")

F.Data.Dictionary.Exists("dictEstHours",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("dictEstHours")
F.Intrinsic.Control.EndIf
F.Data.Dictionary.CreateFromSQL("dictEstHours", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, Hours_Estimated from V_JOB_OPERATIONS where LMO = 'L'")
F.Data.Dictionary.SetDefaultReturn("dictEstHours", "0.00")
F.Data.Dictionary.Exists("dictActHours",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("dictActHours")
F.Intrinsic.Control.EndIf
F.Data.Dictionary.CreateFromSQL("dictActHours", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, Hours_Actual from V_JOB_OPERATIONS where LMO = 'L'")
F.Data.Dictionary.SetDefaultReturn("dictActHours", "0.00")
F.Data.Dictionary.Exists("LSEQ",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("LSEQ")
F.Intrinsic.Control.EndIf
F.Data.Dictionary.CreateFromSQL("LSEQ", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(FLAG_CLOSED) as FLAG_CLOSED from V_JOB_OPERATIONS where LMO = 'L' and FLAG_CLOSED = 'Y'")
F.Data.Dictionary.SetDefaultReturn("LSEQ", "N")
F.Data.Dictionary.Exists("JHOLD",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("JHOLD")
F.Intrinsic.Control.EndIf
F.data.dictionary.CreateFromSQL("JHOLD","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,Flag_Hold from V_JOB_HEADER Where Flag_Hold = 'Y'")
F.Data.Dictionary.SetDefaultReturn("JHOLD","N")

F.Intrinsic.Control.If(V.Global.bAdminMode,=,False)
	'check for updated records for that week. 

	F.Intrinsic.Control.If(v.DataTable.dtTimesheet.exists,=,true)
		F.Data.DataTable.Close("dtTimesheet")
	F.Intrinsic.Control.EndIf
	
'	'if no updated records	
	F.Intrinsic.String.Build("Select USER_ID, RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,CAST(0 AS DOUBLE) AS HOURS_ESTIMATED, CAST(0 AS DOUBLE) AS HOURS_ACTUAL,SUN_HRS,SUN_NOTES, MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN2_HRS,SUN2_NOTES, MON2_HRS,MON2_NOTES, TUES2_HRS,TUES2_NOTES, WED2_HRS,WED2_NOTES, THUR2_HRS,THUR2_NOTES, FRI2_HRS,FRI2_NOTES, SAT2_HRS,SAT2_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper, JOB_NOTES, OVT_HRS from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
	F.DATA.DataTable.CreateFromSQL("dtTimesheet","con",V.Local.sSql,true)

'	F.Intrinsic.Control.If(V.Global.bCurrent)
		'get missing WO for the User
		F.Intrinsic.String.Build("Select '{3}' as User_ID, a.JOB, a.SUFFIX, SEQ,RTRIM(a.JOB) + RTRIM(a.SUFFIX) + RTRIM(SEQ) AS JSS,RTRIM(a.JOB) + RTRIM(a.SUFFIX) AS JS,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,RTRIM(b.Part) as WC, CAST(0 AS DOUBLE) AS HOURS_ESTIMATED, CAST(0 AS DOUBLE) AS HOURS_ACTUAL, CAST(0 AS DOUBLE) AS SUN_HRS,CAST(' ' as LONGVARCHAR) as SUN_NOTES, CAST(0 AS DOUBLE) AS MON_HRS,CAST(' ' as LONGVARCHAR) as MON_NOTES, CAST(0 AS DOUBLE) AS TUES_HRS,CAST(' ' as LONGVARCHAR)  as TUES_NOTES, CAST(0 AS DOUBLE) AS WED_HRS,CAST(' ' as LONGVARCHAR)  as WED_NOTES, CAST(0 AS DOUBLE) AS THUR_HRS,CAST(' ' as LONGVARCHAR)  as THUR_NOTES, CAST(0 AS DOUBLE) AS FRI_HRS,CAST(' ' as LONGVARCHAR)  as FRI_NOTES, CAST(0 AS DOUBLE) AS SAT_HRS,CAST(' ' as LONGVARCHAR)  as SAT_NOTES, CAST(0 AS DOUBLE) AS SUN2_HRS,CAST(' ' as LONGVARCHAR) as SUN2_NOTES, CAST(0 AS DOUBLE) AS MON2_HRS,CAST(' ' as LONGVARCHAR) as MON2_NOTES, CAST(0 AS DOUBLE) AS TUES2_HRS,CAST(' ' as LONGVARCHAR)  as TUES2_NOTES, CAST(0 AS DOUBLE) AS WED2_HRS,CAST(' ' as LONGVARCHAR)  as WED2_NOTES, CAST(0 AS DOUBLE) AS THUR2_HRS,CAST(' ' as LONGVARCHAR)  as THUR2_NOTES, CAST(0 AS DOUBLE) AS FRI2_HRS,CAST(' ' as LONGVARCHAR)  as FRI2_NOTES, CAST(0 AS DOUBLE) AS SAT2_HRS,CAST(' ' as LONGVARCHAR)  as SAT2_NOTES,CAST(0 AS BIT) AS UPDATED,CAST(0 AS BIT) AS FLAG_READY,CAST('A' as  CHAR(1)) as Wrapper, CAST(' ' as LONGVARCHAR)  as JOB_NOTES, Cast(0 as Double) as OVT_HRS from V_Job_Header a Left Join V_Job_Operations b on a.Job = b.Job and a.Suffix = b.Suffix where rtrim(b.Part) = '{0}' and LMO = 'L' and Flag_Closed <> 'Y' and Flag_Hold <> 'Y' and JSS NOT IN(Select RTRIM(C.JOB) + RTRIM(C.SUFFIX) + RTRIM(C.SEQ) from GCG_6873_TIMSHT C where UPPER(USER_ID) = '{1}' AND BEG_WEEK = '{2}') ORDER BY a.JOB,a.SUFFIX, SEQ",V.Local.sEmp,V.Global.sUser,V.Global.dDate.PervasiveDate,V.Global.sUser.Trim,V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("TempTime","con",V.Local.sSql,True)
		F.Intrinsic.Control.If(V.DataTable.TempTime.RowCount--,<>,-1)
			F.Data.DataTable.Merge("TempTime","dtTimesheet",False,2)
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.Close("TempTime")
'	F.Intrinsic.Control.EndIf
		GUI.FormTimesheet.cmdSave.Enabled(True)
		GUI.FormTimesheet.cmdAdd.Enabled(True)
		GUI.FormTimesheet.cmdFrmTemp.Enabled(True)
		GUI.FormTimesheet.cmdUpdate.Enabled(True)
		GUI.FormTimesheet.cmdAddJobBrows.Enabled(True)
		GUI.FormTimesheet.cmdSave.Enabled(True)
		GUI.FormTimesheet.cmdAddSeqBrows.Enabled(True)
		GUI.FormTimesheet.gsgcTimesheet.Enabled(True)
	
	F.Intrinsic.Control.If(v.DataTable.dtTimesheetCheck.exists,=,true)
		F.Data.DataTable.DeleteRow("dtTimesheetCheck")
		F.Data.DataTable.AcceptChanges("dtTimesheetCheck")
	F.Intrinsic.Control.Else
		F.Data.DataTable.Clone("dtTimesheet","dtTimesheetCheck",True)
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.Merge("dtTimesheet","dtTimesheetCheck",False,2)
		
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(v.DataTable.dtTimesheet.exists,=,true)
		F.Data.DataTable.Close("dtTimesheet")
	F.Intrinsic.Control.EndIf
	
	V.Local.sSql.Set(V.Screen.FormTimesheet!txtUser.Text)
	
	F.Intrinsic.Control.If(V.Local.sSql.Trim,<>,"")
		F.Intrinsic.String.Build("Select USER_ID, RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,CAST(0 AS DOUBLE) AS HOURS_ESTIMATED, CAST(0 AS DOUBLE) AS HOURS_ACTUAL,SUN_HRS,SUN_NOTES, MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN2_HRS,SUN2_NOTES, MON2_HRS,MON2_NOTES, TUES2_HRS,TUES2_NOTES, WED2_HRS,WED2_NOTES, THUR2_HRS,THUR2_NOTES, FRI2_HRS,FRI2_NOTES, SAT2_HRS,SAT2_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper, JOB_NOTES, OVT_HRS from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}'",V.Local.sSql,V.Global.dDate.PervasiveDate,V.Local.sSql)
		F.DATA.DataTable.CreateFromSQL("dtTimesheet","con",V.Local.sSql,true)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("Select USER_ID, RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,CAST(0 AS DOUBLE) AS HOURS_ESTIMATED, CAST(0 AS DOUBLE) AS HOURS_ACTUAL,SUN_HRS,SUN_NOTES, MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN2_HRS,SUN2_NOTES, MON2_HRS,MON2_NOTES, TUES2_HRS,TUES2_NOTES, WED2_HRS,WED2_NOTES, THUR2_HRS,THUR2_NOTES, FRI2_HRS,FRI2_NOTES, SAT2_HRS,SAT2_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper, JOB_NOTES, OVT_HRS from GCG_6873_TIMSHT where BEG_WEEK = '{0}'",V.Global.dDate.PervasiveDate,V.Local.sSql)
		F.DATA.DataTable.CreateFromSQL("dtTimesheet","con",V.Local.sSql,true)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

GUI.FormTimesheet.cmdPrint.Enabled(True)

GUI.FormTimesheet.cmdUnlock.Enabled(True)

GUI.FormTimesheet.gsgcTimesheet.Enabled(True)

F.Intrinsic.Control.If(V.Global.bAdminMode.Not)
	GUI.FormTimesheet.cmdReady.Enabled(True)
	GUI.FormTimesheet.cmdUpdate.Enabled(False)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.cmdReady.Enabled(False)
	GUI.FormTimesheet.cmdUpdate.Enabled(True)
F.Intrinsic.Control.EndIf

F.Data.Datatable.FillFromDictionary("dtTimesheet","DescDict","JS","Description")
F.Data.Datatable.FillFromDictionary("dtTimesheet","FGDict","JS","Part")

F.Data.DataTable.AddColumn("dtTimesheet", "SEQ_DESCRIPTION", "String")
F.Data.Datatable.FillFromDictionary("dtTimesheet","dictSeqDesc", "JSS", "SEQ_DESCRIPTION")
F.Data.Datatable.FillFromDictionary("dtTimesheet","dictActHours", "JSS", "Hours_Actual")
F.Data.Datatable.FillFromDictionary("dtTimesheet","dictEstHours", "JSS", "Hours_Estimated")

F.Data.DataTable.AddColumn("dtTimesheet","Delete","String")

F.Data.DataTable.AddExpressionColumn("dtTimesheet", "JOB_SUM", "Float", "MON_HRS + TUES_HRS + WED_HRS + THUR_HRS + FRI_HRS + SAT_HRS + SUN_HRS + MON2_HRS + TUES2_HRS + WED2_HRS + THUR2_HRS + FRI2_HRS + SAT2_HRS + SUN2_HRS")
F.Data.DataTable.AddExpressionColumn("dtTimesheet", "POTENTIAL_HOURS", "Float", "IIF(UPDATED = 0,JOB_SUM+HOURS_ACTUAL,HOURS_ACTUAL)")

F.Data.DataView.Create("dtTimesheet","dvTimesheet",22)

F.Data.DataView.Create("dtTimesheet","timeTemp",22,"OVT_HRS is Null","")
F.Data.DataView.SetValue("dtTimesheet","timeTemp",-1,"OVT_HRS","0.00")
F.Data.DataView.Close("dtTimesheet","timeTemp")
'F.Data.DataTable.AddColumn("dtTimesheet", "ACT_HOURS", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "EST_HOURS", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "SUNDAY_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "MONDAY_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "TUESDAY_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "WEDNESDAY_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "THURSDAY_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "FRIDAY_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "SATURDAY_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "SUNDAY2_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "MONDAY2_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "TUESDAY2_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "WEDNESDAY2_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "THURSDAY2_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "FRIDAY2_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "SATURDAY2_HOURS_EDIT", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "JOB_TOTAL_TIME", "String", "0:00")
'F.Data.DataTable.AddColumn("dtTimesheet", "Due_Date", "Date")
'F.Data.DataTable.AddColumn("dtTimesheet", "SEQ_CLOSED", "String")
'F.Data.DataTable.AddColumn("dtTimesheet", "FLAG_Hold", "String")
'F.Data.DataTable.AddColumn("dtTimesheet", "P_HOURS","String","0:00")
F.Data.DataTable.AddColumn("dtTimesheet", "ACT_HOURS", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "EST_HOURS", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "SUNDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "MONDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "TUESDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "WEDNESDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "THURSDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "FRIDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "SATURDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "SUNDAY2_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "MONDAY2_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "TUESDAY2_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "WEDNESDAY2_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "THURSDAY2_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "FRIDAY2_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "SATURDAY2_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "JOB_TOTAL_TIME", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "Due_Date", "Date")
F.Data.DataTable.AddColumn("dtTimesheet", "SEQ_CLOSED", "String")
F.Data.DataTable.AddColumn("dtTimesheet", "FLAG_Hold", "String")
F.Data.DataTable.AddColumn("dtTimesheet", "P_HOURS","String","0.00")

F.Data.DataTable.FillFromDictionary("dtTimesheet","FGDate","JS","Due_Date")
F.Data.DataTable.FillFromDictionary("dtTimesheet","LSEQ","JSS","SEQ_CLOSED")
F.Data.DataTable.FillFromDictionary("dtTimesheet","JHOLD","JS","FLAG_Hold")

v.Local.sSQL.Set("select distinct MACHINE from WORKCENTERS")
F.data.DataTable.CreateFromSQL("WCDT","con",v.Local.sSQL)
F.Data.Dataview.Create("WCDT","WCDTVW",22)
F.data.DataView.ToString("WCDT","WCDTVW","MACHINE","@!@","*!*",v.Local.sWC)
F.Data.DataView.Close("WCDT","WCDTVW")
F.Data.DataTable.Close("WCDT")

F.Intrinsic.Control.CallSub(CalculateAllTimeColumns)

GUI.FormTimesheet.gsgcTimesheet.AddGridviewFromDataview("gvTimesheet","dtTimesheet","dvTimesheet")

GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet","OptionsViewRowAutoHeight",False)
GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet", "OptionsViewColumnAutoWidth", False)
GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet","OptionsSelectionEnableAppearanceFocusedRow",False)
GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet","OptionsViewShowAutoFilterRow",True)
GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet","ColumnPanelRowHeight",40)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "Due_Date", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "Due_Date", "AllowShowHide", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY2_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY2_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY2_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY2_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY2_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY2_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY2_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","caption","Job Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","readonly", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","allowedit", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","MaxWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","visible","false")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JS","visible","false")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","User_ID","visible","false")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","User_ID","AllowShowHide","False")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Wrapper","visible","False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Wrapper","AllowShowHide","False")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","Caption", "Ready")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","visible",True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","Fixed","Right")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FLAG_READY", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","Caption", "Updated")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","visible","True")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","Fixed","Right")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "UPDATED", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.ColumnEdit("gvTimesheet","Delete","EditorButton","Delete")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","allowedit", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","caption","Job")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","MinWidth", 50)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","MaxWidth", 50)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","Fixed", "Left")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","EST_HOURS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","EST_HOURS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","EST_HOURS","caption","Est. Hours")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","EST_HOURS","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","EST_HOURS","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","EST_HOURS","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "EST_HOURS", "HeaderWordWrap", "Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","EST_HOURS","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","ACT_HOURS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","ACT_HOURS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","ACT_HOURS","caption","Applied Hours")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","ACT_HOURS","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","ACT_HOURS","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","ACT_HOURS","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "ACT_HOURS", "HeaderWordWrap", "Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","ACT_HOURS","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","POTENTIAL_HOURS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","POTENTIAL_HOURS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","POTENTIAL_HOURS","caption","Potential Hours Decimal")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","POTENTIAL_HOURS","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","POTENTIAL_HOURS","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","POTENTIAL_HOURS","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "POTENTIAL_HOURS", "HeaderWordWrap", "Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","POTENTIAL_HOURS","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours","caption","Potential Hours Decimal")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "AllowEdit", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "ReadOnly", True)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "P_Hours", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ESTIMATED","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ESTIMATED","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ESTIMATED","caption","Est. Hours (Dec)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ESTIMATED","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ESTIMATED","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ESTIMATED","MinWidth", 50)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ESTIMATED","MaxWidth", 50)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ESTIMATED","Visible", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ESTIMATED","AllowShowHide", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "HOURS_ESTIMATED", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ACTUAL","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ACTUAL","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ACTUAL","caption","Applied Hours (Dec)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ACTUAL","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ACTUAL","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ACTUAL","MinWidth", 50)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ACTUAL","MaxWidth", 50)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ACTUAL","Visible", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","HOURS_ACTUAL","AllowShowHide", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "HOURS_ACTUAL", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","caption","Job Total (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","MaxWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_SUM", "DisplayCustomNumeric", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_SUM", "Visible", "0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_SUM", "AllowShowHide", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_SUM", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","caption","Job Total")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","MaxWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_TOTAL_TIME", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","caption","Job SS")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","MinWidth", 80)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","caption","Suffix")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","MinWidth", 50)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","MaxWidth", 50)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","Fixed", "Left")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "Suffix", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","visible","True")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","Fixed","Right")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","caption","Seq")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","MinWidth", 50)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","MaxWidth", 50)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","Fixed", "Left")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "Seq", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","caption","Part/Project")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","MinWidth", 80)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "PART", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","caption","Description (Job)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","MinWidth", 110)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "Description", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","caption","Description (Seq)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","MinWidth", 110)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","Visible", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "seq_Description", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","caption","Work Center")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","readonly", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","allowedit", False)
'GUI.FormTimesheet.gsgcTimesheet.ColumnEdit("gvTimesheet","WC","Dropdownlist",v.Local.sWC)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","MinWidth", 50)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","MaxWidth", 50)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","Fixed", "Left")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WC", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","caption","Sun Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","caption","Mon Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","caption","Tues Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","caption","Wed Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","caption","Th Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","caption","Fri Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","caption","Sat Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","Visible", "False")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_NOTES","caption","Sun Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_NOTES","caption","Mon Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_NOTES","caption","Tues Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_NOTES","caption","Wed Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_NOTES","caption","Th Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_NOTES","caption","Fri Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_HRS","allowshowhide", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_NOTES","caption","Sat Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_NOTES","MinWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT2_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN2_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON2_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES2_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED2_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR2_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI2_NOTES","Visible", "False")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq_Closed","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq_Closed","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq_Closed","caption","Seq Closed")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq_Closed","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq_Closed","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq_Closed","Visible", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq_Closed","MinWidth", 50)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","caption","Flag Hold")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","Visible", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Hold","MinWidth", 50)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","VisibleIndex", 0)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUFFIX","VisibleIndex", 1)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","VisibleIndex", 5)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SEQ","VisibleIndex", 2)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","VisibleIndex", 9)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Part","VisibleIndex", 4)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","VisibleIndex", 3)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","EST_HOURS","VisibleIndex", 6)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","ACT_HOURS","VisibleIndex", 7)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","VisibleIndex", 9)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","VisibleIndex", 10)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","VisibleIndex", 11)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","VisibleIndex", 12)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","VisibleIndex", 13)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","VisibleIndex", 14)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","VisibleIndex", 15)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY2_HOURS_EDIT","VisibleIndex", 16)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY2_HOURS_EDIT","VisibleIndex", 17)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY2_HOURS_EDIT","VisibleIndex", 18)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY2_HOURS_EDIT","VisibleIndex", 19)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY2_HOURS_EDIT","VisibleIndex", 20)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY2_HOURS_EDIT","VisibleIndex", 21)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY2_HOURS_EDIT","VisibleIndex", 22)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","VisibleIndex", 23)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq_Closed","VisibleIndex", 24)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Ready","VisibleIndex", 25)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Updated","VisibleIndex", 26)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","OVT_HRS","VisibleIndex", 27)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","VisibleIndex", 28)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "OVT_HRS", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "OVT_HRS", "Caption", "OT Hours")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "OVT_HRS", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "OVT_HRS", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "OVT_HRS", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "OVT_HRS", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "OVT_HRS", "EditMask", "##0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "OVT_HRS", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "OVT_HRS", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "OVT_HRS", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.MainView("gvTimesheet")

F.Global.Registry.ReadValue(V.Caller.User, V.Caller.CompanyCode, "gvTimesheet", 6873, 2002, 6, "", V.Local.sSerialize)
F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
	Gui.FormTimesheet.gsgcTimesheet.Deserialize(V.Local.sSerialize)
F.Intrinsic.Control.EndIf

V.Local.sCol.Redim(0,13)
V.Local.dColDate.Redim(0,13)

Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","SUNDAY_HOURS_EDIT",V.Local.sCol)
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","MONDAY_HOURS_EDIT",V.Local.sCol(1))
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","TUESDAY_HOURS_EDIT",V.Local.sCol(2))
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","WEDNESDAY_HOURS_EDIT",V.Local.sCol(3))
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","THURSDAY_HOURS_EDIT",V.Local.sCol(4))
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","FRIDAY_HOURS_EDIT",V.Local.sCol(5))
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","SATURDAY_HOURS_EDIT",V.Local.sCol(6))

Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","SUNDAY2_HOURS_EDIT",V.Local.sCol(7))
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","MONDAY2_HOURS_EDIT",V.Local.sCol(8))
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","TUESDAY2_HOURS_EDIT",V.Local.sCol(9))
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","WEDNESDAY2_HOURS_EDIT",V.Local.sCol(10))
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","THURSDAY2_HOURS_EDIT",V.Local.sCol(11))
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","FRIDAY2_HOURS_EDIT",V.Local.sCol(12))
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","SATURDAY2_HOURS_EDIT",V.Local.sCol(13))

V.Local.dColDate.Set(V.Global.dDate.FORMATM/DD/YY)
F.Intrinsic.Date.DateAdd("D",1,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(1))
F.Intrinsic.Date.DateAdd("D",2,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(2))
F.Intrinsic.Date.DateAdd("D",3,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(3))
F.Intrinsic.Date.DateAdd("D",4,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(4))
F.Intrinsic.Date.DateAdd("D",5,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(5))
F.Intrinsic.Date.DateAdd("D",6,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(6))
F.Intrinsic.Date.DateAdd("D",7,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(7))
F.Intrinsic.Date.DateAdd("D",8,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(8))
F.Intrinsic.Date.DateAdd("D",9,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(9))
F.Intrinsic.Date.DateAdd("D",10,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(10))
F.Intrinsic.Date.DateAdd("D",11,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(11))
F.Intrinsic.Date.DateAdd("D",12,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(12))
F.Intrinsic.Date.DateAdd("D",13,V.Global.dDate.FORMATM/DD/YY,V.Local.dColDate(13))

Gui.FormTimesheet.lblSun1.Caption(V.Local.dColDate.FormatM/DD/YYYY)
Gui.FormTimesheet.lblMon1.Caption(V.Local.dColDate(1).FormatM/DD/YYYY)
Gui.FormTimesheet.lblTues1.Caption(V.Local.dColDate(2).FormatM/DD/YYYY)
Gui.FormTimesheet.lblWed1.Caption(V.Local.dColDate(3).FormatM/DD/YYYY)
Gui.FormTimesheet.lblThur1.Caption(V.Local.dColDate(4).FormatM/DD/YYYY)
Gui.FormTimesheet.lblFri1.Caption(V.Local.dColDate(5).FormatM/DD/YYYY)
Gui.FormTimesheet.lblSat1.Caption(V.Local.dColDate(6).FormatM/DD/YYYY)
Gui.FormTimesheet.lblSun2.Caption(V.Local.dColDate(7).FormatM/DD/YYYY)
Gui.FormTimesheet.lblMon2.Caption(V.Local.dColDate(8).FormatM/DD/YYYY)
Gui.FormTimesheet.lblTues2.Caption(V.Local.dColDate(9).FormatM/DD/YYYY)
Gui.FormTimesheet.lblWed2.Caption(V.Local.dColDate(10).FormatM/DD/YYYY)
Gui.FormTimesheet.lblThur2.Caption(V.Local.dColDate(11).FormatM/DD/YYYY)
Gui.FormTimesheet.lblFri2.Caption(V.Local.dColDate(12).FormatM/DD/YYYY)
Gui.FormTimesheet.lblSat2.Caption(V.Local.dColDate(13).FormatM/DD/YYYY)

F.Intrinsic.Control.For(V.Local.i,0,V.DataView.dtTimesheet!dvTimesheet.RowCount--,1)
	F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Local.i).Updated!FieldVal,=,True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol,V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(1),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(2),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(3),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(4),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(5),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(7),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(8),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(9),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(10),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(11),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(12),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(13),V.Local.i,"Locked", True)
	F.Intrinsic.Control.ElseIf(V.DataTable.dtTimesheet(V.Local.i).Updated!FieldVal,=,False,"AND",V.DataTable.dtTimesheet(V.Local.i).Flag_Ready!FieldVal,=,True)
'		F.Intrinsic.Control.If(V.Global.bAdminMode)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol,V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(1),V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(2),V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(3),V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(4),V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(5),V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(7),V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(8),V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(9),V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(10),V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(11),V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(12),V.Local.i,"Locked", False)
'			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(13),V.Local.i,"Locked", False)
'		F.Intrinsic.Control.Else
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol,V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(1),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(2),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(3),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(4),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(5),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(7),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(8),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(9),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(10),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(11),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(12),V.Local.i,"Locked", True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(13),V.Local.i,"Locked", True)
'		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.ElseIf(V.Local.sDate,>,V.DataView.dtTimesheet!dvTimesheet(V.Local.i).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol,V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(1),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(2),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(3),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(4),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(5),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(7),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(8),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(9),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(10),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(11),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(12),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(13),V.Local.i,"Locked", True)
	F.Intrinsic.Control.ElseIf(V.DataTable.dtTimesheet(V.Local.i).Updated!FieldVal,=,True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol,V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(1),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(2),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(3),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(4),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(5),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(7),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(8),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(9),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(10),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(11),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(12),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(13),V.Local.i,"Locked", True)
	F.Intrinsic.Control.ElseIf(V.DataTable.dtTimesheet(V.Local.i).Seq_Closed!FieldValTrim,=,"Y","OR",V.DataTable.dtTimesheet(V.Local.i).Flag_Hold!FieldValTrim,=,"Y")
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol,V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(1),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(2),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(3),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(4),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(5),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(7),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(8),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(9),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(10),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(11),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(12),V.Local.i,"Locked", True)
		GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(13),V.Local.i,"Locked", True)
	F.Intrinsic.Control.Else
		V.Local.bSpedJob.Set(False)
		V.Local.sJob.Set(V.DataTable.dtTimesheet(V.Local.i).Job!FieldValTrim)
		V.Local.sJob.Set(V.Local.sJob.UCase)
'		V.Local.sJob.Set(V.Local.sJob.Left3)
		F.Intrinsic.Control.If(V.Local.sJob.Left3,=,"HOL","OR",V.Local.sJob.Left3,=,"VAC")
			V.Local.bSpedJob.Set(True)
		F.Intrinsic.Control.ElseIf(V.Local.sJob.Left2,=,"SL")
			V.Local.bSpedJob.Set(True)
		F.Intrinsic.Control.ElseIf(V.Local.sJob.Left5,=,"EMRGL")
			V.Local.bSpedJob.Set(True)
		F.Intrinsic.Control.ElseIf(V.Local.sJob.Left2,=,"HD")
			V.Local.bSpedJob.Set(True)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).SUNDAY_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(0),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(0),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(0),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(0),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).MONDAY_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(1),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(1),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(1),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(1),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).TUESDAY_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(2),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(2),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(2),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(2),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).WEDNESDAY_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(3),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(3),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(3),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(3),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).THURSDAY_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(4),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(4),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(4),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(4),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).FRIDAY_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(5),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(5),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(5),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(5),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).SATURDAY_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(6),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(6),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).SUNDAY2_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(7),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(7),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(7),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(7),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).MONDAY2_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(8),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(8),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(8),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(8),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).TUESDAY2_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(9),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(9),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(9),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(9),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).WEDNESDAY2_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(10),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(10),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(10),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(10),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).THURSDAY2_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(11),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(11),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(11),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(11),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).FRIDAY2_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(12),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(12),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(12),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(12),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvTimesheet(V.Local.i).SATURDAY2_HOURS_EDIT!FieldVal,<>,"0","OR",V.Global.bAdminMode,=,True)
			GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(13),V.Local.i,"Locked", True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.dColDate(13),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(13),V.Local.i,"Locked", True)
			F.Intrinsic.Control.Else
				GUI.FormTimesheet.gsgcTimesheet.setcellproperty("gvTimesheet",V.Local.sCol(13),V.Local.i,"Locked", False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.Control.UnBlockEvents

GUI.FormTimesheet.gsgcTimesheet.Visible(True)
'GUI.FormTimesheet.gsgcTimesheet.ResumeLayout

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.GridLoad.End

Program.Sub.ComputeTotals.Start
F.Intrinsic.Control.Try

v.Local.fMonHrs.Declare(float)
v.Local.fTuesHrs.Declare(float)
v.Local.fWedHrs.Declare(float)
v.Local.fThurHrs.Declare(float)
v.Local.fFriHrs.Declare(float)
v.Local.fSatHrs.Declare(float)
v.Local.fSunHrs.Declare(float)
v.Local.fTotHrs.Declare(float)
v.Local.sHold.Declare(String)
V.Local.fTemp.Declare(Float)
V.Local.sTemp.Declare(String)
V.Local.fHours1.Declare(Float)
V.Local.fHours2.Declare(Float)
V.Local.fHours3.Declare(Float)
V.Local.fUnrounded.Declare(Float)
V.Local.iCounter.Declare(Long)
V.Local.sTime.Declare(String)

V.Local.sTime.Redim(0, 13)
V.Local.fUnrounded.Redim(0, 7)

'computes the total hours and loads them onto text boxes to the side
F.Data.DataView.ToDataTable("dtTimesheet","dvTimesheet","CompDT")
F.Intrinsic.Control.If(v.DataTable.CompDT.RowCount,<>,0)

	F.Data.DataTable.Compute("CompDT","Sum(SUN_HRS)","",V.Local.fUnrounded(0))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(0))
	GUI.FormTimesheet.txtSunHrs.Text(V.Args.Time)
	V.Local.sTime(0).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(MON_HRS)","",V.Local.fUnrounded(1))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(1))
	GUI.FormTimesheet.txtMonHrs.Text(V.Args.Time)
	V.Local.sTime(1).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(TUES_HRS)","",V.Local.fUnrounded(2))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(2))
	GUI.FormTimesheet.txtTuesHrs.Text(V.Args.Time)
	V.Local.sTime(2).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(WED_HRS)","",V.Local.fUnrounded(3))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(3))
	GUI.FormTimesheet.txtWedHrs.Text(V.Args.Time)
	V.Local.sTime(3).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(THUR_HRS)","",V.Local.fUnrounded(4))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(4))
	GUI.FormTimesheet.txtThurHrs.Text(V.Args.Time)
	V.Local.sTime(4).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(FRI_HRS)","",V.Local.fUnrounded(5))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(5))
	GUI.FormTimesheet.txtFriHrs.Text(V.Args.Time)
	V.Local.sTime(5).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(SAT_HRS)","",V.Local.fUnrounded(6))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(6))
	GUI.FormTimesheet.txtSatHrs.Text(V.Args.Time)
	V.Local.sTime(6).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(SUN2_HRS)","",V.Local.fUnrounded(0))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(0))
	GUI.FormTimesheet.txtSunHrs2.Text(V.Args.Time)
	V.Local.sTime(7).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(MON2_HRS)","",V.Local.fUnrounded(1))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(1))
	GUI.FormTimesheet.txtMonHrs2.Text(V.Args.Time)
	V.Local.sTime(8).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(TUES2_HRS)","",V.Local.fUnrounded(2))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(2))
	GUI.FormTimesheet.txtTuesHrs2.Text(V.Args.Time)
	V.Local.sTime(9).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(WED2_HRS)","",V.Local.fUnrounded(3))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(3))
	GUI.FormTimesheet.txtWedHrs2.Text(V.Args.Time)
	V.Local.sTime(10).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(THUR2_HRS)","",V.Local.fUnrounded(4))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(4))
	GUI.FormTimesheet.txtThurHrs2.Text(V.Args.Time)
	V.Local.sTime(11).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(FRI2_HRS)","",V.Local.fUnrounded(5))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(5))
	GUI.FormTimesheet.txtFriHrs2.Text(V.Args.Time)
	V.Local.sTime(12).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(SAT2_HRS)","",V.Local.fUnrounded(6))
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(6))
	GUI.FormTimesheet.txtSatHrs2.Text(V.Args.Time)
	V.Local.sTime(13).Set(V.Args.Time)
	
	V.Local.fTotHrs.Set(0)
	F.Intrinsic.Control.For(V.Local.iCounter, 0, V.Local.sTime.UBound, 1)
		F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Local.sTime(V.Local.iCounter))
		F.Intrinsic.Math.Add(V.Local.fTotHrs, V.Args.Decimal, V.Local.fTotHrs)
	F.Intrinsic.Control.Next(V.Local.iCounter)
	
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotHrs)
'	GUI.FormTimesheet.txtTotHrs.Text(V.Args.Time)
	GUI.FormTimesheet.txtTotHrs.Text(V.Local.fTotHrs)
	
	F.Data.DataTable.Close("CompDT")
F.Intrinsic.Control.Else
	F.Intrinsic.Control.CallSub(EmptyTotals)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(LoadClockInTime)

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtMonHrs.Text)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtMonHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtMonHrs.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtTuesHrs.Text)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtTuesHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtTuesHrs.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtWedHrs.Text)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtWedHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtWedHrs.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtThurHrs.Caption)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtThurHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtThurHrs.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtFriHrs.Text)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtFriHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtFriHrs.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtSatHrs.Text)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtSatHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtSatHrs.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtSunHrs.Text)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtSunHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtSunHrs.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtMonHrs2.Text)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtMonHrs2.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtMonHrs2.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtTuesHrs2.Text)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtTuesHrs2.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtTuesHrs2.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtWedHrs2.Text)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtWedHrs2.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtWedHrs2.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtThurHrs2.Caption)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtThurHrs2.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtThurHrs2.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtFriHrs2.Text)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtFriHrs2.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtFriHrs2.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtSatHrs2.Text)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtSatHrs2.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtSatHrs2.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtSunHrs2.Text)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtSunHrs2.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtSunHrs2.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(LoadJobTime)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtHoursTA.Text.Trim)
V.Local.fHours1.Set(V.Args.Decimal)
F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtTotHrs.Text.Trim)
V.Local.fHours2.Set(V.Args.Decimal)
F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtGUIHours.Text.Trim)
V.Local.fHours3.Set(V.Args.Decimal)

F.Intrinsic.Math.Add(V.Local.fHours2, V.Local.fHours3, V.Local.fTemp)
F.Intrinsic.Math.Sub(V.Local.fHours1, V.Local.fTemp, V.Local.fTemp)
F.Intrinsic.Math.Sub(0, V.Local.fTemp, V.Local.fTemp)
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTemp)
GUI.FormTimesheet.txtHoursBalance.Text(V.Args.Time)

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtHoursBalance.Caption)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtHoursBalance.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtHoursBalance.BackColor("#89CFF0")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.ComputeTotals.End

Program.Sub.LoadClockInTime.Start
'get the actual time and attendance clock in time for the selected employee/week

F.Intrinsic.Control.Try

V.Local.sEmployee.Declare(String)
V.Local.dStartDate.Declare(Date)
V.Local.dEndDate.Declare(Date)
V.Local.sSQL.Declare(String)
V.Local.sMessage.Declare(String)
V.Local.iCounter.Declare(Long)
V.Local.dInTemp.Declare(Date)
V.Local.dOutTemp.Declare(Date)
V.Local.iMinutes.Declare(Long)
V.Local.iTotalMinutes.Declare(Long)
V.Local.iHours.Declare(Long)
V.Local.fHours.Declare(Float)
V.Local.fTotalHours.Declare(Float)
V.Local.dDate.Declare(Date)
V.Local.sFilter.Declare(String)
V.Local.fTemp.Declare(Float)
V.Local.sTemp.Declare(String)
V.Local.sMonday.Declare(String)
V.Local.sTuesday.Declare(String)
V.Local.sWednesday.Declare(String)
V.Local.sThursday.Declare(String)
V.Local.sFriday.Declare(String)
V.Local.sSaturday.Declare(String)
V.Local.sSunday.Declare(String)
V.Local.sTotal.Declare(String)

'get employee
F.Intrinsic.Control.If(v.Global.bAdminMode)
	V.Local.sEmployee.Set(V.Screen.FormTimesheet!txtEmployee.Text.Trim)
F.Intrinsic.Control.Else
	F.Global.Security.GetEmpNoFromUser(V.Global.sUser, V.Local.sEmployee)
	F.Intrinsic.Control.If(V.Local.sEmployee.IsNoReturn)
		F.Intrinsic.String.Build("No employee tied to the user '{0}', clock in time will not be pulled in.", V.Global.sUser, V.Local.sMessage)
		F.Intrinsic.UI.Msgbox(V.Local.sMessage)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

'get date range
V.Local.dStartDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)
F.Intrinsic.Date.DateAdd("D", 6, V.Local.dStartDate, V.Local.dEndDate)

'get data
F.Intrinsic.String.Build("select CHARGE_DATE, DATE_IN, DATE_OUT, IsNull(HOURS_HH, 0) as HOURS_HH, IsNull(HOURS_MM, 0) as HOURS_MM, OUT_TS_MIN, IN_TS_MIN, TIME_IN, TIME_OUT from V_TIME_ATTENDANCE where CHARGE_DATE between '{0}' and '{1}' and EMPLOYEE = '{2}'", V.Local.dStartDate.FormatYYYY-MM-DD, V.Local.dEndDate.FormatYYYY-MM-DD, V.Local.sEmployee, V.Local.sSQL)
F.Data.DataTable.CreateFromSQL("dtClock", "Con", V.Local.sSQL)

'if still clocked in will need to calculate
'currently I'm assuming there's no overnight
F.Data.DataTable.AddColumn("dtClock", "Hours", "Long", 0)
F.Data.DataTable.AddColumn("dtClock", "Minutes", "Long", 0)
F.Data.DataTable.AddColumn("dtClock", "Curr_Hours_Float", "Float", 0)
F.Data.DataTable.AddColumn("dtClock", "Total_Minutes", "Long", 0)
F.Data.DataView.Create("dtClock", "dvClockedIn", 22, "DATE_OUT = '1900-01-01'", "")
F.Intrinsic.Control.For(V.Local.iCounter, 0, V.DataView.dtClock!dvClockedIn.RowCount--, 1)
	V.Local.dInTemp.Set(V.DataView.dtClock!dvClockedIn(V.Local.iCounter).Time_In!FieldVal)
	V.Local.dOutTemp.Set(V.Ambient.Time)
	F.Intrinsic.Date.DateDiff("N", V.Local.dInTemp, V.Local.dOutTemp, V.Local.iTotalMinutes)
	F.Intrinsic.Math.Mod(V.Local.iTotalMinutes, 60, V.Local.iMinutes)
	F.Intrinsic.Math.Div(V.Local.iTotalMinutes, 60, V.Local.fHours)
	F.Intrinsic.Math.Round(V.Local.fHours, 0, V.Local.iHours)
	F.Data.DataView.SetValue("dtClock", "dvClockedIn", V.Local.iCounter, "Total_Minutes", V.Local.iTotalMinutes, "Hours", V.Local.iHours, "Minutes", V.Local.iMinutes, "Curr_Hours_Float", V.Local.fHours)
	
F.Intrinsic.Control.Next(V.Local.iCounter)
F.Data.DataView.Close("dtClock", "dvClockedIn")

F.Data.DataTable.AddExpressionColumn("dtClock", "Prev_Hours_Float", "Float", "[HOURS_HH] + ([HOURS_MM] / 60)")
F.Data.DataTable.AddExpressionColumn("dtClock", "Hours_Float", "Float", "[Prev_Hours_Float] + [Curr_Hours_Float]")

F.Data.DataTable.AddColumn("dtClock", "FInal_Time", "Float")
F.Data.DataTable.SetValueFormat("dtClock", -1, "Hours_Float", "Final_Time", "##############.00##")

'create job time datatable to remove it from the sum
F.Intrinsic.String.Build("select DATE_SEQUENCE, EMPL, SUM(HOURS_WORKED) HOURS from V_JOB_DETAIL where EMPL = '{0}' and DATE_SEQUENCE between '{1}' and '{2}' group by DATE_SEQUENCE, EMPL", V.Local.sEmployee, V.Local.dStartDate.FormatYYYY-MM-DD, V.Local.dEndDate.FormatYYYY-MM-DD, V.Local.sSQL)
F.Data.DataTable.CreateFromSQL("dtJobDetail", "con", V.Local.sSQL)
F.Data.DataView.Create("dtJobDetail", "dvJobDetail", 22)

V.Local.dDate.Set(V.Local.dStartDate)
V.Local.fTotalHours.Redim(0, 7)
F.Intrinsic.Control.For(V.Local.iCounter, 0, 6, 1)
	F.Intrinsic.String.Build("CHARGE_DATE = '{0}'", V.Local.dDate, V.Local.sFilter)
	F.Data.DataTable.Compute("dtClock", "Sum(Final_Time)", V.Local.sFilter, V.Local.fHours)
	
	'subtract job hours
	F.Intrinsic.String.Build("DATE_SEQUENCE = '{0}'", V.Local.dDate, V.Local.sFilter)
	F.Data.DataView.SetFilter("dtJobDetail", "dvJobDetail", V.Local.sFilter)
	F.Intrinsic.Control.If(V.DataView.dtJobDetail!dvJobDetail.RowCount, >, 0)
		F.Intrinsic.Math.Sub(V.Local.fHours, V.DataView.dtJobDetail!dvJobDetail(0).HOURS!FieldValFloat, V.Local.fHours)
	F.Intrinsic.Control.EndIf
	
	V.Local.fTotalHours(V.Local.iCounter).Set(V.Local.fHours)
	F.Intrinsic.Date.DateAdd("d", 1, V.Local.dDate, V.Local.dDate)
F.Intrinsic.Control.Next(V.Local.iCounter)

F.Data.DataTable.Compute("dtClock", "Sum(Final_Time)", "", V.Local.fHours)
V.Local.fTotalHours(7).Set(V.Local.fHours)

F.Data.DataView.Close("dtJobDetail", "dvJobDetail")
F.Data.DataTable.Close("dtJobDetail")

'Exergy wants the clock in time to count down to 0 (cancel out) as bucket time is entered
F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtSunHrs.Text.Trim)

F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(0), V.Local.fTotalHours(0))

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(0))
V.Local.sSunday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtMonHrs.Text.Trim)

F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(1), V.Local.fTotalHours(1))

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(1))
V.Local.sMonday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtTuesHrs.Text.Trim)

F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(2), V.Local.fTotalHours(2))

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(2))
V.Local.sTuesday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtWedHrs.Text.Trim)

F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(3), V.Local.fTotalHours(3))

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(3))
V.Local.sWednesday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtThurHrs.Text.Trim)

F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(4), V.Local.fTotalHours(4))

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(4))
V.Local.sThursday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtFriHrs.Text.Trim)

F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(5), V.Local.fTotalHours(5))

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(5))
V.Local.sFriday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtSatHrs.Text.Trim)

F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(6), V.Local.fTotalHours(6))

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(6))
V.Local.sSaturday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(7))
V.Local.sTotal.Set(V.Args.Time)

GUI.FormTimesheet.lblClockHrsMon.Caption(V.Local.sMonday)
GUI.FormTimesheet.lblClockHrsTues.Caption(V.Local.sTuesday)
GUI.FormTimesheet.lblClockHrsWed.Caption(V.Local.sWednesday)
GUI.FormTimesheet.lblClockHrsThur.Caption(V.Local.sThursday)
GUI.FormTimesheet.lblClockHrsFri.Caption(V.Local.sFriday)
GUI.FormTimesheet.lblClockHrsSat.Caption(V.Local.sSaturday)
GUI.FormTimesheet.lblClockHrsSun.Caption(V.Local.sSunday)

GUI.FormTimesheet.txtHoursTA.Text(V.Local.sTotal)

F.Data.DataTable.Close("dtClock")

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.LoadClockInTime.End

Program.Sub.EmptyTotals.Start
F.Intrinsic.Control.Try

GUI.FormTimesheet.txtSunHrs.Text("0:00")
GUI.FormTimesheet.txtMonHrs.Text("0:00")
GUI.FormTimesheet.txtTuesHrs.Text("0:00")
GUI.FormTimesheet.txtWedHrs.Text("0:00")
GUI.FormTimesheet.txtThurHrs.Text("0:00")
GUI.FormTimesheet.txtFriHrs.Text("0:00")
GUI.FormTimesheet.txtSatHrs.Text("0:00")
GUI.FormTimesheet.txtTotHrs.Text("0.00")
GUI.FormTimesheet.txtHoursTA.Text("0:00")
GUI.FormTimesheet.txtHoursBalance.Text("0:00")

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.EmptyTotals.End

Program.Sub.cmdaddjobbrows_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sJob.Declare(String)

V.Local.sTitle.Set("Job*!*Suffix*!*Part*!*Description")
V.Local.sWidth.Set("1200*!*700*!*2200*!*2700")
V.Local.sJob.Set(v.screen.FormTimesheet!txtAJob.text)
F.Intrinsic.Control.If(V.Local.sJob.trim,<>,"")
	V.Local.sSql.Set("Select JOB, SUFFIX, PART, DESCRIPTION from V_JOB_HEADER ORDER BY JOB, SUFFIX")
	F.Intrinsic.String.Build("Select JOB, SUFFIX, PART, DESCRIPTION from V_JOB_HEADER where job >= '{0}' ORDER BY JOB, SUFFIX",v.screen.FormTimesheet!txtAJob.text.trim,v.Local.sSql)
F.Intrinsic.Control.Else
	V.Local.sSql.Set("Select JOB, SUFFIX, PART, DESCRIPTION from V_JOB_HEADER ORDER BY JOB, SUFFIX")
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select Job","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	GUI.FormTimesheet.txtAJob.Text(V.Local.sRet(0))
	GUI.FormTimesheet.txtASufF.Text(V.Local.sRet(1))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdaddjobbrows_click.End

Program.Sub.cmdaddseqbrows_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sWC.Declare(String)

F.Intrinsic.Control.If(V.Screen.FormTimesheet!txtAJob.Text,=,"")
	F.Intrinsic.UI.Msgbox("No job selected!","Select Job")
F.Intrinsic.Control.Else
	V.Local.sTitle.Set("Sequence*!*Workcenter*!*Description")
	V.Local.sWidth.Set("1200*!*1000*!*4800")
	F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
	F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	F.Intrinsic.String.Build("Select SEQ, PART, DESCRIPTION from V_JOB_OPERATIONS where JOB = '{0}' AND SUFFIX = '{1}' AND LMO = 'L' and SEQ < 995000 order by job,suffix,seq",V.Screen.FormTimesheet!txtAJob.Text,V.Screen.FormTimesheet!txtASuff.Text,V.Local.sSql)
	F.Intrinsic.UI.Browser("Select Sequence","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		V.Local.sWC.set(V.Local.sRet(1))
		F.Intrinsic.String.Left(v.Local.sWC,4,v.Local.sWC)
		GUI.FormTimesheet.txtASeq.Text(V.Local.sRet(0))
		GUI.FormTimesheet.txtWC.Text(v.Local.sWC)
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdaddseqbrows_click.End

Program.Sub.cmdadd_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
v.Local.iCheck.Declare(Long)
v.Local.iCheck1.Declare(Long)
v.Local.iCheck2.Declare(Long)
v.Local.sWC.Declare(String)
v.Local.sJSS.Declare(String)
v.Local.sJS.Declare(String)
V.Local.bRet.Declare(Boolean,False)


v.Local.sWC.Set(V.Screen.FormTimesheet!txtWC.text)

F.Intrinsic.String.UCase(v.Local.sWC,v.Local.sWC)
F.Intrinsic.String.Build("Select count(JOB) from V_JOB_OPERATIONS WHERE JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Screen.FormTimesheet!txtAJob.Text,V.Screen.FormTimesheet!txtASuff.Text,V.Screen.FormTimesheet!txtASeq.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck1)

F.Intrinsic.String.Build("Select count(JOB) from V_JOB_HEADER WHERE JOB = '{0}' AND SUFFIX = '{1}'",V.Screen.FormTimesheet!txtAJob.Text,V.Screen.FormTimesheet!txtASuff.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck)
F.Intrinsic.String.Build("Select count(MACHINE) from WORKCENTERS WHERE MACHINE = '{0}'",v.Local.sWC,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck2)

F.Intrinsic.Control.If(v.Global.bAdminMode)
	V.Global.sUser.Set(v.Screen.FormTimesheet!txtUser.text)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormTimesheet!txtAJob.Text.trim,=,"")
	F.Intrinsic.UI.Msgbox("No job selected or entered to save!","Add Job")
F.Intrinsic.Control.ElseIf(V.Screen.FormTimesheet!txtASeq.Text.TRIM,=,"")
	F.Intrinsic.UI.Msgbox("No sequence selected to save!","Select Sequence")
F.Intrinsic.Control.ElseIf(V.Global.sUser.Trim,=,"")
	F.Intrinsic.UI.Msgbox("No Employee Selected!","Select Employee")
F.Intrinsic.Control.ElseIf(v.Local.iCheck,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Job and Suffix entered!","Incorrect Job or Suffix")
F.Intrinsic.Control.ElseIf(v.Local.iCheck1,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Sequence entered!","Incorrect Sequence")
F.Intrinsic.Control.ElseIf(v.Local.iCheck2,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Work Center entered!","Incorrect Work Center")
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("Select * from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND JOB = '{1}' AND SUFFIX = '{2}' AND SEQ = '{3}' AND BEG_WEEK = '{4}'",V.Global.sUser,V.Screen.FormTimesheet!txtAJob.Text,V.Screen.FormTimesheet!txtASuff.Text,V.Screen.FormTimesheet!txtASeq.Text,V.Global.dDate.PervasiveDate,V.Local.sSql)
	F.ODBC.Connection!con.OpenRecordsetRW("rst",V.Local.sSql)
	F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,True)
		F.ODBC.con!rst.AddNew
		F.ODBC.con!rst.Set!USER_ID(V.Global.sUser)
		F.ODBC.con!rst.Set!JOB(V.Screen.FormTimesheet!txtAJob.Text)
		F.ODBC.con!rst.Set!SUFFIX(V.Screen.FormTimesheet!txtASuff.Text)
		F.ODBC.con!rst.Set!SEQ(V.Screen.FormTimesheet!txtASeq.Text)
		F.ODBC.con!rst.Set!WC(v.Local.sWC)
		F.ODBC.con!rst.Set!BEG_WEEK(V.Global.dDate.PervasiveDate)
		F.ODBC.con!rst.Set!SUN_HRS(0)
		F.ODBC.con!rst.Set!SUN_NOTES("")
		F.ODBC.con!rst.Set!MON_HRS(0)
		F.ODBC.con!rst.Set!MON_NOTES("")
		F.ODBC.con!rst.Set!TUES_HRS(0)
		F.ODBC.con!rst.Set!TUES_NOTES("")
		F.ODBC.con!rst.Set!WED_HRS(0)
		F.ODBC.con!rst.Set!WED_NOTES("")
		F.ODBC.con!rst.Set!THUR_HRS(0)
		F.ODBC.con!rst.Set!THUR_NOTES("")
		F.ODBC.con!rst.Set!FRI_HRS(0)
		F.ODBC.con!rst.Set!FRI_NOTES("")
		F.ODBC.con!rst.Set!SAT_HRS(0)
		F.ODBC.con!rst.Set!SAT_NOTES("")
		F.ODBC.con!rst.Set!SUN2_HRS(0)
		F.ODBC.con!rst.Set!SUN2_NOTES("")
		F.ODBC.con!rst.Set!MON2_HRS(0)
		F.ODBC.con!rst.Set!MON2_NOTES("")
		F.ODBC.con!rst.Set!TUES2_HRS(0)
		F.ODBC.con!rst.Set!TUES2_NOTES("")
		F.ODBC.con!rst.Set!WED2_HRS(0)
		F.ODBC.con!rst.Set!WED2_NOTES("")
		F.ODBC.con!rst.Set!THUR2_HRS(0)
		F.ODBC.con!rst.Set!THUR2_NOTES("")
		F.ODBC.con!rst.Set!FRI2_HRS(0)
		F.ODBC.con!rst.Set!FRI2_NOTES("")
		F.ODBC.con!rst.Set!SAT2_HRS(0)
		F.ODBC.con!rst.Set!SAT2_NOTES("")
		F.ODBC.con!rst.Set!UPDATED(0)
		F.ODBC.con!rst.Set!Flag_Ready(0)
		F.ODBC.con!rst.Set!JOB_NOTES(v.Screen.F_newNotes!txtNewNotes.Text)
		F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,v.Local.sJSS)
		F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,v.Local.sJS)
		F.Data.DataTable.AddRow("dtTimesheet","JSS",v.Local.sJSS,"JS",v.Local.sJS,"Job",V.ODBC.con!rst.FieldValTrim!JOB,"Suffix",V.ODBC.con!rst.FieldValTrim!SUFFIX,"SEQ",V.ODBC.con!rst.FieldValTrim!SEQ,"WC",V.ODBC.con!rst.FieldValTrim!WC,"SUN_HRS",V.ODBC.con!rst.FieldVal!SUN_HRS,"MON_HRS",V.ODBC.con!rst.FieldVal!MON_HRS,"TUES_HRS",V.ODBC.con!rst.FieldVal!TUES_HRS,"WED_HRS",V.ODBC.con!rst.FieldVal!WED_HRS,"THUR_HRS",V.ODBC.con!rst.FieldVal!THUR_HRS,"FRI_HRS",V.ODBC.con!rst.FieldVal!FRI_HRS,"SAT_HRS",V.ODBC.con!rst.FieldVal!SAT_HRS,"UPDATED",V.ODBC.con!rst.FieldVal!UPDATED,"FLAG_READY",V.ODBC.con!rst.FieldVal!FLAG_READY,"Wrapper","A", "JOB_NOTES", V.ODBC.con!rst.FieldVal!JOB_NOTES)
		F.Data.DataTable.SetValue("dtTimesheet",V.DataTable.dtTimesheet.RowCount--,"SUN2_HRS",V.ODBC.con!rst.FieldVal!SUN2_HRS,"MON2_HRS",V.ODBC.con!rst.FieldVal!MON2_HRS,"TUES2_HRS",V.ODBC.con!rst.FieldVal!TUES2_HRS,"WED2_HRS",V.ODBC.con!rst.FieldVal!WED2_HRS,"THUR2_HRS",V.ODBC.con!rst.FieldVal!THUR2_HRS,"FRI2_HRS",V.ODBC.con!rst.FieldVal!FRI2_HRS,"SAT2_HRS",V.ODBC.con!rst.FieldVal!SAT2_HRS)
		F.Data.Dictionary.Exists("DescDict",V.Local.bRet)
		F.Intrinsic.Control.If(V.Local.bRet)
			F.Data.Dictionary.Close("DescDict")
		F.Intrinsic.Control.EndIf
		F.data.dictionary.CreateFromSQL("DescDict","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,DESCRIPTION from V_JOB_HEADER ")
		F.Data.Dictionary.SetDefaultReturn("DescDict","")
		
		F.Data.Dictionary.Exists("FGDict",V.Local.bRet)
		F.Intrinsic.Control.If(V.Local.bRet)
			F.Data.Dictionary.Close("FGDict")
		F.Intrinsic.Control.EndIf
		F.data.dictionary.CreateFromSQL("FGDict","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,PART from V_JOB_HEADER ")
		F.Data.Dictionary.SetDefaultReturn("FGDict","")
		
		F.Data.Dictionary.Exists("dictSeqDesc",V.Local.bRet)
		F.Intrinsic.Control.If(V.Local.bRet)
			F.Data.Dictionary.Close("dictSeqDesc")
		F.Intrinsic.Control.EndIf
		F.Data.Dictionary.CreateFromSQL("dictSeqDesc", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(DESCRIPTION) as DESCRIPTION from V_JOB_OPERATIONS where LMO = 'L'")
		F.Data.Dictionary.SetDefaultReturn("dictSeqDesc", "")
		
		F.Data.Dictionary.Exists("FGDate",V.Local.bRet)
		F.Intrinsic.Control.If(V.Local.bRet)
			F.Data.Dictionary.Close("FGDate")
		F.Intrinsic.Control.EndIf
		F.data.dictionary.CreateFromSQL("FGDate","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,Date_Due from V_JOB_HEADER ")
		F.Data.Dictionary.SetDefaultReturn("FGDate","01/01/1900")
		
		F.Data.Dictionary.Exists("dictEstHours",V.Local.bRet)
		F.Intrinsic.Control.If(V.Local.bRet)
			F.Data.Dictionary.Close("dictEstHours")
		F.Intrinsic.Control.EndIf
		F.Data.Dictionary.CreateFromSQL("dictEstHours", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, Hours_Estimated from V_JOB_OPERATIONS where LMO = 'L'")
		F.Data.Dictionary.SetDefaultReturn("dictEstHours", "0.00")
		F.Data.Dictionary.Exists("dictActHours",V.Local.bRet)
		F.Intrinsic.Control.If(V.Local.bRet)
			F.Data.Dictionary.Close("dictActHours")
		F.Intrinsic.Control.EndIf
		F.Data.Dictionary.CreateFromSQL("dictActHours", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, Hours_Actual from V_JOB_OPERATIONS where LMO = 'L'")
		F.Data.Dictionary.SetDefaultReturn("dictActHours", "0.00")
		F.Data.Dictionary.Exists("LSEQ",V.Local.bRet)
		F.Intrinsic.Control.If(V.Local.bRet)
			F.Data.Dictionary.Close("LSEQ")
		F.Intrinsic.Control.EndIf
		F.Data.Dictionary.CreateFromSQL("LSEQ", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(FLAG_CLOSED) as FLAG_CLOSED from V_JOB_OPERATIONS where LMO = 'L' and FLAG_CLOSED = 'Y'")
		F.Data.Dictionary.SetDefaultReturn("LSEQ", "N")
		F.Data.Dictionary.Exists("JHOLD",V.Local.bRet)
		F.Intrinsic.Control.If(V.Local.bRet)
			F.Data.Dictionary.Close("JHOLD")
		F.Intrinsic.Control.EndIf
		F.data.dictionary.CreateFromSQL("JHOLD","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,Flag_Hold from V_JOB_HEADER Where Flag_Hold = 'Y'")
		F.Data.Dictionary.SetDefaultReturn("JHOLD","N")
		F.Data.Datatable.FillFromDictionary("dtTimesheet","DescDict","JS","Description")
		F.Data.Datatable.FillFromDictionary("dtTimesheet","FGDict","JS","Part")
		F.Data.Datatable.FillFromDictionary("dtTimesheet","dictSeqDesc", "JSS", "SEQ_DESCRIPTION")
		F.Data.DataTable.FillFromDictionary("dtTimesheet","FGDate","JS","Due_Date")
		F.Data.Datatable.FillFromDictionary("dtTimesheet","dictActHours", "JSS", "Hours_Actual")
		F.Data.Datatable.FillFromDictionary("dtTimesheet","dictEstHours", "JSS", "Hours_Estimated")
		F.Data.DataTable.FillFromDictionary("dtTimesheet","LSEQ","JSS","SEQ_CLOSED")
		F.Data.DataTable.FillFromDictionary("dtTimesheet","JHOLD","JS","FLAG_HOLD")
		F.ODBC.con!rst.Update
		F.ODBC.con!rst.Close
		GUI.FormTimesheet.txtAJob.Text("")
		GUI.FormTimesheet.txtASuff.Text("")
		GUI.FormTimesheet.txtASeq.Text("")
		GUI.FormTimesheet.txtWC.Text("")
		gui.F_newNotes.txtNewNotes.Text("")
	F.Intrinsic.Control.Else
		F.ODBC.con!rst.Close
		F.Intrinsic.UI.Msgbox("Job sequence already exists on timesheet!","Save Error")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

v.Global.bSaveMsg.Set(False)
F.Intrinsic.Control.CallSub(cmdsave_click)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdadd_click.End

Program.Sub.cmdtemp_click.Start
F.Intrinsic.Control.Try

GUI.FormTimesheet..Enabled(False)
F.Intrinsic.Control.CallSub(Templist)
GUI.F_Template..Show

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdtemp_click.End

Program.Sub.TempList.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sKey.Declare(String)

'Loads Template listview with the template data found in ATG_TIMSHEET_TEMP
GUI.F_Template.lvwTemp.ClearItems
F.Intrinsic.String.Build("Select * from GCG_6873_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' ORDER BY JOB,SUFFIX,SEQ",V.Global.sUser,V.Local.sSql)
F.ODBC.Connection!con.OpenRecordsetRO("rst",V.Local.sSql)

F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,True)
	F.Intrinsic.String.Build("{0}*!*{1}*!*{2}",V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,V.Local.sKey)
	GUI.F_Template.lvwTemp.AddListItem(V.Local.sKey,V.ODBC.con!rst.FieldValTrim!JOB)
	GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,1,V.ODBC.con!rst.FieldValTrim!SUFFIX)
	GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,2,V.ODBC.con!rst.FieldValTrim!SEQ)
	GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,3,V.ODBC.con!rst.FieldValTrim!WC)
	F.Intrinsic.String.Build("Select DESCRIPTION from V_JOB_OPERATIONS_WC where JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,V.Local.sSql)
	F.ODBC.Connection!con.OpenRecordsetRO("rstDesc",V.Local.sSql)

	F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,<>,True)
		GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,4,V.ODBC.con!rstDesc.FieldValTrim!DESCRIPTION)
	F.Intrinsic.Control.EndIf

	F.ODBC.con!rstDesc.Close
	F.ODBC.con!rst.MoveNext
F.Intrinsic.Control.Loop

F.ODBC.con!rst.Close

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.TempList.End

Program.Sub.f_template_unload.Start
F.Intrinsic.Control.Try

GUI.F_Template..Visible(False)
GUI.F_Template.txtTmpJob.Text("")
GUI.F_Template.txtTmpSeq.Text("")
GUI.F_Template.txtTmpSuff.Text("")
GUI.FormTimesheet..Enabled(True)
GUI.FormTimesheet..setfocus

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.f_template_unload.End

Program.Sub.cmdtmpjobbrows_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)

V.Local.sTitle.Set("Job*!*Suffix*!*Part*!*Description")
V.Local.sWidth.Set("1200*!*700*!*2200*!*2700")
V.Local.sSql.Set("Select JOB, SUFFIX, PART, DESCRIPTION from V_JOB_HEADER ORDER BY JOB, SUFFIX")

F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select Job","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	GUI.F_Template.txtTmpJob.Text(V.Local.sRet(0))
	GUI.F_Template.txtTmpSuff.Text(V.Local.sRet(1))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdtmpjobbrows_click.End

Program.Sub.cmdAddWC_Click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)

V.Local.sTitle.Set("Work Center*!*WC Name*!*WC Dept")
V.Local.sWidth.Set("1200*!*2700*!*1200")
V.Local.sSql.Set("Select MACHINE, WC_DEPT, WC_NAME from WORKCENTERS ORDER BY MACHINE, WC_DEPT")

F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select WorkCenter","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	GUI.FormTimesheet.txtWC.Text(V.Local.sRet(0))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdAddWC_Click.End

Program.Sub.cmdTmpAddWC_Click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)

V.Local.sTitle.Set("Work Center*!*WC Name*!*WC Dept")
V.Local.sWidth.Set("1200*!*2700*!*1200")
V.Local.sSql.Set("Select MACHINE, WC_DEPT, WC_NAME from WORKCENTERS ORDER BY MACHINE, WC_DEPT")

F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select WorkCenter","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	GUI.F_Template.txtTmpWC.Text(V.Local.sRet(0))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdTmpAddWC_Click.End

Program.Sub.cmdtmpseqbrows_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sWC.Declare(String)

F.Intrinsic.Control.If(V.Screen.F_Template!txtTmpJob.Text,=,"")
	F.Intrinsic.UI.Msgbox("No job selected!","Select Job")
F.Intrinsic.Control.Else
	V.Local.sTitle.Set("Sequence*!*Workcenter*!*Description")
	V.Local.sWidth.Set("1200*!*1000*!*4800")
	
	F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
	F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	F.Intrinsic.String.Build("Select SEQ, PART, DESCRIPTION from V_JOB_OPERATIONS where JOB = '{0}' AND SUFFIX = '{1}' AND LMO = 'L' and SEQ < 995000 ORDER BY Job,Suffix,SEQ",V.Screen.F_Template!txtTmpJob.Text,V.Screen.F_Template!txtTmpSuff.Text,V.Local.sSql)
	F.Intrinsic.UI.Browser("Select Sequence","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		V.Local.sWC.set(V.Local.sRet(1))
		F.Intrinsic.String.Left(v.Local.sWC,4,v.Local.sWC)
		GUI.F_Template.txtTmpSeq.Text(V.Local.sRet(0))
		GUI.F_Template.txtTmpWC.Text(v.Local.sWC)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdtmpseqbrows_click.End

Program.Sub.cmdtmpadd_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
v.Local.iCheck.Declare(Long)
v.Local.iCheck1.Declare(Long)
v.Local.iCheck2.Declare(Long)
v.Local.sWC.Declare(String)

v.Global.bSaveMsg.Set(False)

v.Local.sWC.Set(V.Screen.F_Template!txtTmpWC.text)

F.Intrinsic.String.UCase(v.Local.sWC,v.Local.sWC)
F.Intrinsic.String.Build("Select count(JOB) from V_JOB_OPERATIONS WHERE JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Screen.F_Template!txtTmpJob.text,V.Screen.F_Template!txtTmpSuff.text,V.Screen.F_Template!txtTmpSeq.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck1)

F.Intrinsic.String.Build("Select count(JOB) from V_JOB_HEADER WHERE JOB = '{0}' AND SUFFIX = '{1}'",V.Screen.F_Template!txtTmpJob.Text,V.Screen.F_Template!txtTmpSuff.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck)
F.Intrinsic.String.Build("Select count(MACHINE) from WORKCENTERS WHERE MACHINE = '{0}'",v.Local.sWC,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck2)

F.Intrinsic.Control.If(V.Screen.F_Template!txtTmpJob.Text,=,"")
	F.Intrinsic.UI.Msgbox("No job selected to save!","Save Job")
F.Intrinsic.Control.ElseIf(V.Screen.F_Template!txtTmpSeq.Text,=,"")
	F.Intrinsic.UI.Msgbox("No sequence selected to save!","Save Sequence")
F.Intrinsic.Control.ElseIf(V.Screen.F_Template!txtTmpWC.Text,=,"")	
	F.Intrinsic.UI.Msgbox("No Workcenter selected to save!","Save Work Center")
F.Intrinsic.Control.ElseIf(v.Local.iCheck,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Job and Suffix entered!","Incorrect Job or Suffix")
F.Intrinsic.Control.ElseIf(v.Local.iCheck1,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Sequence entered!","Incorrect Sequence")
F.Intrinsic.Control.ElseIf(v.Local.iCheck2,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Work Center entered!","Incorrect Work Center")
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("Select * from GCG_6873_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' AND JOB = '{1}' AND SUFFIX = '{2}' AND SEQ = '{3}'",V.Global.sUser,V.Screen.F_Template!txtTmpJob.Text,V.Screen.F_Template!txtTmpSuff.Text,V.Screen.F_Template!txtTmpSeq.Text,V.Local.sSql)
	F.ODBC.Connection!con.OpenRecordsetRW("rst",V.Local.sSql)

	F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,True)
		F.ODBC.con!rst.AddNew
		F.ODBC.con!rst.Set!USER_ID(V.Global.sUser)
		F.ODBC.con!rst.Set!JOB(V.Screen.F_Template!txtTmpJob.Text)
		F.ODBC.con!rst.Set!SUFFIX(V.Screen.F_Template!txtTmpSuff.Text)
		F.ODBC.con!rst.Set!SEQ(V.Screen.F_Template!txtTmpSeq.Text)
		F.ODBC.con!rst.Set!WC(V.Screen.F_Template!txtTmpWC.Text)
		F.ODBC.con!rst.Update
		GUI.F_Template.txtTmpJob.Text("")
		GUI.F_Template.txtTmpSuff.Text("")
		GUI.F_Template.txtTmpSeq.Text("")
		GUI.F_Template.txtTmpWC.Text("")
		F.ODBC.con!rst.Close
		F.Intrinsic.Control.CallSub(Templist)
	F.Intrinsic.Control.Else
		F.ODBC.con!rst.Close
		F.Intrinsic.UI.Msgbox("Job sequence already exists on template!","Sequence Exists")
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdtmpadd_click.End

Program.Sub.cmdtmpdelete_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sRet.Declare(String)

F.Intrinsic.Control.If(V.Screen.F_Template!txtTmpJob.Text,=,"")
	F.Intrinsic.UI.Msgbox("No job selected to delete!","Delete Job")
F.Intrinsic.Control.ElseIf(V.Screen.F_Template!txtTmpSeq.Text,=,"")
	F.Intrinsic.UI.Msgbox("No sequence selected to delete!","Delete Sequence")
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Are you sure you want to delete this record from template?","Delete Record",4,V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet,=,"6")
		F.Intrinsic.String.Build("Delete from GCG_6873_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' AND JOB = '{1}' AND SUFFIX = '{2}' AND SEQ = '{3}'",v.Global.sUser,V.Screen.F_Template!txtTmpJob.Text,V.Screen.F_Template!txtTmpSuff.Text,V.Screen.F_Template!txtTmpSeq.Text,V.Local.sSql)
		F.ODBC.Connection!con.Execute(V.Local.sSql)
		GUI.F_Template.txtTmpJob.Text("")
		GUI.F_Template.txtTmpSuff.Text("")
		GUI.F_Template.txtTmpSeq.Text("")
		F.Intrinsic.Control.CallSub(Templist)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdtmpdelete_click.End

Program.Sub.cmdtmpdeleteall_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sRet.Declare(String)

F.Intrinsic.UI.Msgbox("This will delete your entire template, are you sure?","Delete Template",4,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,=,"6")
	F.Intrinsic.String.Build("Delete GCG_6873_TIMSHT_TEMP where UPPER(USER_ID) = '{0}'",V.Global.sUser,V.Local.sSql)
	F.ODBC.Connection!con.Execute(V.Local.sSql)
	GUI.F_Template.txtTmpJob.Text("")
	GUI.F_Template.txtTmpSuff.Text("")
	GUI.F_Template.txtTmpSeq.Text("")
	F.Intrinsic.Control.CallSub(Templist)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdtmpdeleteall_click.End

Program.Sub.lvwtemp_itemclick.Start
F.Intrinsic.Control.Try

V.Local.sRet.Declare(String)

'Template Entries Screen, this sets the values of the textboxes to the values you selected in the grid
F.Intrinsic.String.Split(V.Screen.F_Template!lvwTemp.SelectedItemKey,"*!*",V.Local.sRet)
GUI.F_Template.txtTmpJob.Text(V.Local.sRet(0))
GUI.F_Template.txtTmpSuff.Text(V.Local.sRet(1))
GUI.F_Template.txtTmpSeq.Text(V.Local.sRet(2))

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.lvwtemp_itemclick.End

Program.Sub.cmdsave_click.Start
F.Intrinsic.Control.Try

V.Local.i.Declare(Long)
V.Local.sSql.Declare(String)
V.Local.iRow.Declare(Long)
V.Local.sRow.Declare(String)
V.Local.sRowArray.Declare(String)
V.Local.sMap.Declare(String)
V.Local.sFilter.Declare(String)
V.Local.sSerialize.Declare(String)

'F.Intrinsic.Control.If(V.Caller.User.UCase,=,"DFRANKS")
'	Function.Intrinsic.Debug.InvokeDebugger
'	Function.Intrinsic.Debug.Stop
'	
'F.Intrinsic.Control.EndIf
Gui.FormTimesheet.cmdSave.Enabled(False)
Gui.FormTimesheet..Enabled(False)
F.Intrinsic.UI.InvokeWaitDialog("Saving Time Records and Reloading the Grid.................")

F.Data.DataView.ToDataTable("dtTimesheet","dvTimesheet","SavinDT")

'F.Data.DataView.Create("SavinDT","SaveVw",22,"UPDATED = 0","")
F.Data.DataView.Create("SavinDT","SaveVw",22,"","")

F.Data.DataView.ToDataTable("SavinDT","SaveVw","SaveDT")

F.Intrinsic.Control.For(V.Local.iRow,V.DataTable.SaveDT.RowCount--,0,-1)
	F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and User_ID = '{3}'",V.DataTable.SaveDT(V.Local.iRow).Job!FieldValTrim,V.DataTable.SaveDT(V.Local.iRow).Suffix!FieldValTrim,V.DataTable.SaveDT(V.Local.iRow).Seq!FieldValTrim,V.DataTable.SaveDT(V.Local.iRow).USER_ID!FieldValTrim,V.Local.sFilter)
	F.Data.DataView.Create("Reason","Temp",22,V.Local.sFilter,"")
	F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
'		F.Data.DataView.Create("SaveDT","Temp",22,"JOB_SUM = 0","")
		F.Intrinsic.Control.If(V.DataTable.SaveDT(V.Local.iRow).Job_Sum!FieldValFloat,=,"0")
			F.Data.DataTable.DeleteRow("SaveDT",V.Local.iRow)
		F.Intrinsic.Control.EndIf
'		F.Data.DataView.Close("SaveDT","Temp")
	F.Intrinsic.Control.EndIf
	F.Data.DataView.Close("Reason","Temp")
F.Intrinsic.Control.Next(V.Local.iRow)
F.Data.DataTable.AcceptChanges("SaveDT")
'F.Data.DataTable.AddColumn("SaveDT","USER_ID","STRING")
'F.Data.DataTable.SetValue("SaveDT",-1,"USER_ID",V.Global.sUser)

F.Data.DataTable.AddColumn("SaveDT","BEG_WEEK","STRING")
F.Data.DataTable.SetValue("SaveDT",-1,"BEG_WEEK",V.Global.dDate.PervasiveDate)

v.Local.sMap.set("USER_ID@!@USER_ID*!*JOB@!@JOB*!*SUFFIX@!@SUFFIX*!*SEQ@!@SEQ*!*BEG_WEEK@!@BEG_WEEK*!*WC@!@WC*!*SUN_HRS@!@SUN_HRS*!*MON_HRS@!@MON_HRS*!*TUES_HRS@!@TUES_HRS*!*WED_HRS@!@WED_HRS*!*THUR_HRS@!@THUR_HRS*!*FRI_HRS@!@FRI_HRS*!*SAT_HRS@!@SAT_HRS*!*UPDATED@!@UPDATED*!*FLAG_READY@!@FLAG_READY*!*SUN_NOTES@!@SUN_NOTES*!*MON_NOTES@!@MON_NOTES*!*TUES_NOTES@!@TUES_NOTES*!*WED_NOTES@!@WED_NOTES*!*THUR_NOTES@!@THUR_NOTES*!*FRI_NOTES@!@FRI_NOTES*!*SAT_NOTES@!@SAT_NOTES*!*JOB_NOTES@!@JOB_NOTES*!*SUN2_HRS@!@SUN2_HRS*!*MON2_HRS@!@MON2_HRS*!*TUES2_HRS@!@TUES2_HRS*!*WED2_HRS@!@WED2_HRS*!*THUR2_HRS@!@THUR2_HRS*!*FRI2_HRS@!@FRI2_HRS*!*SAT2_HRS@!@SAT2_HRS*!*SUN2_NOTES@!@SUN2_NOTES*!*MON2_NOTES@!@MON2_NOTES*!*TUES2_NOTES@!@TUES2_NOTES*!*WED2_NOTES@!@WED2_NOTES*!*THUR2_NOTES@!@THUR2_NOTES*!*FRI2_NOTES@!@FRI2_NOTES*!*SAT2_NOTES@!@SAT2_NOTES*!*OVT_HRS@!@OVT_HRS")
Function.Data.DataTable.SaveToDB("SaveDT","con","GCG_6873_TIMSHT","USER_ID*!*JOB*!*SUFFIX*!*SEQ*!*BEG_WEEK",256,v.Local.sMap)

F.Data.DataTable.Close("SaveDT")
F.Data.DataTable.Close("SavinDT")

F.Intrinsic.Control.If(V.DataTable.Reason.RowCount--,<>,-1)
	Function.Data.DataTable.SaveToDB("Reason","con","GCG_6873_REC_CHANGE","REC_NO",3)
	F.Data.DataTable.DeleteRow("Reason")
	F.Data.DataTable.AcceptChanges("Reason")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(v.Global.bSaveMsg,=,true)
	F.Intrinsic.UI.Msgbox("All records saved!","Save Records")
	v.Global.bSaveMsg.Set(false)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!ConC.OpenCommonConnection
F.Intrinsic.String.Build("Delete From GS_REGISTRY where program = 'GVTIMESHEET' and REG_ID = 6873 and Seq < 2002 and Company = '{0}'",V.Caller.CompanyCode,V.Local.sSql)
F.ODBC.Connection!conC.Execute(V.Local.sSql)
F.ODBC.Connection!ConC.Close
GUI.FormTimesheet.gsgcTimesheet.Serialize("gvTimesheet", V.Local.sSerialize)
F.Global.Registry.AddValue(V.Caller.User, V.Caller.CompanyCode, "gvTimesheet", 6873, 2002, False, "Serialize", False, 0, -999.0 , 1/1/1980, 12:00:00 AM, V.Local.sSerialize)

F.Intrinsic.Control.CallSub(cmdRefresh_Click)
'this will get re enabled or not on the Grid Load Sub

F.Intrinsic.UI.CloseWaitDialog
Gui.FormTimesheet..Enabled(True)
Gui.FormTimesheet.cmdSave.Enabled(True)
'F.Intrinsic.Control.CallSub(ComputeTotals)

'v.Global.bSaveMsg.Set(false)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdsave_click.End

Program.Sub.cmdupdate_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.iRet.Declare(Long)
V.Local.sEmp.Declare(String)
V.Local.sDay.Declare(String)
V.Local.sFile.Declare(String)
V.Local.sExecute.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sQuery.Declare(String)
V.Local.sFilter.Declare(String)

'update to the update.
'We now have a new checkbox that has the option to update ALL employees whose times are ready Flag_Ready for the selected Week.
'the quote says jack about showing all employees within the grid when they want to do a global update. so being the good guy I'm going to wrn them say hay... this will
'update all employees that are ready. Since you have that checked.
'F.Intrinsic.Control.If(V.Global.iRun,<,1)
'	F.Intrinsic.Math.Add(V.Global.iRun,1,V.Global.iRun)
'	GUI.FormTimesheet.dtpWeek.Enabled(False)
'	F.Intrinsic.Control.If(V.Global.bAdminMode,=,True,"AND",V.Screen.FormTimesheet!chkAllEmployees.Value,=,1)
'		F.Intrinsic.UI.Msgbox("Are you sure you want to post this week's hours to Global Shop for ALL EMPLOYEES whose records are marked as READY?","Update Records",4,V.Local.iRet)
'	F.Intrinsic.Control.Else
'		F.Intrinsic.UI.Msgbox("Are you sure you want to post this week's hours to Global Shop?","Update Records",4,V.Local.iRet)
'	F.Intrinsic.Control.EndIf
'	V.Global.iChk.Set(1)
'	F.Intrinsic.Control.CallSub(Cmdsave_click)
'	V.Global.iChk.Set(0)

'	F.Intrinsic.Control.If(V.Local.iRet,=,6)
'		F.Intrinsic.Control.If(V.Screen.FormTimesheet!chkAllEmployees.Value,=,1)
'			F.Intrinsic.String.Build("Select Distinct UPPER(user_ID) AS user_ID from GCG_6873_TIMSHT Where BEG_WEEK = '{0}' And Flag_Ready = '1' and Updated = '0' Order By User_ID",V.Global.dDate.PervasiveDate,V.Local.sSql)
'		F.Intrinsic.Control.Else
'			F.Intrinsic.String.Build("Select Distinct UPPER(USER_ID) as USER_ID from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' And Flag_ready = '1' and Updated = '0'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
'		F.Intrinsic.Control.EndIf

'		F.ODBC.Connection!con.OpenRecordsetRW("rst",V.Local.sSql)

'		F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,True)
'			F.Intrinsic.UI.Msgbox("No saved records to update!","Save Records")
'		
'		F.Intrinsic.Control.Else
'	
'	'fudge
'	'we have to loop through our recordset, requery the info cause all we want is the current line, then do it all over again.
'				F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,True)

'					F.Intrinsic.UI.InvokeWaitDialog("Loading records to Global Shop!","Update")
'					
'					F.Intrinsic.String.Build("Select EMPLOYEE from V_EMPLOYEE_MSTR where PR_USER_ID = '{0}'",V.ODBC.con!rst.FieldValTrim!User_ID,V.Local.sQuery)
'					F.ODBC.Connection!con.OpenLocalRecordsetRO("rstEmp",V.Local.sQuery)
'					F.Intrinsic.Control.If(V.ODBC.con!rstEmp.EOF,=,False)
'						V.Local.sEmp.Set(V.ODBC.con!rstEmp.FieldValTrim!Employee)
'					F.Intrinsic.Control.Else
''						letthemselecttheemployee? cause it's blank. may be a setup issue, but lets handle it.
'						F.Intrinsic.String.Build("Employee ID can't be found for User: {0}. Please select now.",V.ODBC.con!rst.FieldValTrim!User_ID,V.Local.sQuery)
'						F.Intrinsic.UI.Msgbox(V.Local.sQuery)
'						F.Intrinsic.UI.Browser(51,"",V.Local.sRet)
'						F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"***CANCEL***")
'							F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
'							V.Local.sEmp.Set(V.Local.sRet(0).Trim)
'						F.Intrinsic.Control.Else
'							V.Local.sEmp.Set("")
'						F.Intrinsic.Control.EndIf
'					F.Intrinsic.Control.EndIf
'					F.ODBC.con!rstEmp.Close

'					F.Intrinsic.Control.If(V.Local.sEmp.Trim,<>,"")
'						F.Intrinsic.Control.If(v.DataTable.DTtime.Exists,=,True)
'							F.Data.DataTable.Close("DTtime")
'						F.Intrinsic.Control.EndIf
'						F.Intrinsic.String.Build("Select * from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' And Flag_ready = '1' and updated = '0'",V.ODBC.con!rst.FieldValTrim!USER_ID,V.Global.dDate.PervasiveDate,V.Local.sSql)
'						F.Data.DataTable.CreateFromSQL("DTtime","con",v.local.sSql,true)
'						F.Intrinsic.String.Build("Update GCG_6873_Timsht Set Updated = '1' Where Beg_Week = '{0}' And UPPER(USER_ID) = '{1}'",V.Global.dDate.PervasiveDate,V.ODBC.con!rst.FieldValTrim!User_ID,V.Local.sSql)
'						F.ODBC.Connection!con.Execute(V.Local.sSql)
'						
'						V.Local.sDay.Set("Sun")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SUN_HRS")
'								
'						V.Local.sDay.Set("Mon")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","MON_HRS")
'						
'						V.Local.sDay.Set("Tues")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","TUES_HRS")
'						
'						V.Local.sDay.Set("Wed")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","WED_HRS")
'						
'						V.Local.sDay.Set("Thur")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","THUR_HRS")
'						
'						V.Local.sDay.Set("Fri")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","FRI_HRS")
'						
'						V.Local.sDay.Set("Sat")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SAT_HRS")

'						F.Intrinsic.Control.CallSub(JB0455Sync)
'						
'						F.ODBC.Connection!con.Execute(V.Local.sSql)
'					F.Intrinsic.Control.EndIf

'					F.ODBC.con!rst.MoveNext
'				F.Intrinsic.Control.Loop
'				
'				GUI.FormTimesheet.cmdUpdate.Enabled(False)
'				GUI.FormTimesheet.gsgcTimesheet.Enabled(False)
'				F.Intrinsic.UI.CloseWaitDialog

'		F.Intrinsic.Control.EndIf
'		F.ODBC.con!rst.close
'		F.Intrinsic.Control.If(V.DataTable.Reason.RowCount--,<>,-1)
'			Function.Data.DataTable.SaveToDB("Reason","con","GCG_6873_REC_CHANGE","REC_NO",3)
'			F.Data.DataTable.DeleteRow("Reason")
'			F.Data.DataTable.AcceptChanges("Reason")
'		F.Intrinsic.Control.EndIf
'	F.Intrinsic.Control.EndIf

'	V.Global.iRun.Set(0)
'	GUI.FormTimesheet.dtpWeek.Enabled(True)
'F.Intrinsic.Control.EndIf

F.Data.DataView.Create("dtTimesheet","JobDtl",22,"[Flag_Ready] = True and [Updated] = False","USER_ID")
F.Data.DataView.ToDataTableDistinct("dtTimesheet","JobDtl","Users","USER_ID",True)
F.Data.DataView.Close("dtTimesheet","JobDtl")
F.Intrinsic.Control.For(V.Local.iRet,0,V.DataTable.Users.RowCount--,1)
	F.Intrinsic.String.Build("Select EMPLOYEE from V_EMPLOYEE_MSTR where PR_USER_ID = '{0}'",V.DataTable.Users(V.Local.iRet).User_Id!FieldValTrim,V.Local.sQuery)
	F.ODBC.Connection!con.OpenLocalRecordsetRO("rstEmp",V.Local.sQuery)
	F.Intrinsic.Control.If(V.ODBC.con!rstEmp.EOF,=,False)
		V.Local.sEmp.Set(V.ODBC.con!rstEmp.FieldValTrim!Employee)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("Employee ID can't be found for User: {0}. Please select now.",V.DataTable.Users(V.Local.iRet).User_Id!FieldValTrim,V.Local.sQuery)
		F.Intrinsic.UI.Msgbox(V.Local.sQuery)
		F.Intrinsic.UI.Browser(51,"",V.Local.sRet)
		F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"***CANCEL***")
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			V.Local.sEmp.Set(V.Local.sRet(0).Trim)
		F.Intrinsic.Control.Else
			V.Local.sEmp.Set("")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.ODBC.con!rstEmp.Close
	F.Intrinsic.Control.If(V.Local.sEmp.Trim,<>,"")
		F.Intrinsic.String.Build("[Flag_Ready] = True and [Updated] = False and [User_ID] = '{0}'",V.DataTable.Users(V.Local.iRet).User_Id!FieldValTrim,V.Local.sFilter)
		F.Data.DataView.Create("dtTimesheet","JobDtl",22,V.Local.sFilter,"USER_ID")
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!JobDtl.RowCount--,<>,-1)
			F.Data.DataView.ToDataTable("dtTimesheet","JobDtl","DTtime",True)
'			V.Local.sDay.Set("Sun")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SUN_HRS")
'					
'			V.Local.sDay.Set("Mon")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","MON_HRS")
'			
'			V.Local.sDay.Set("Tues")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","TUES_HRS")
'			
'			V.Local.sDay.Set("Wed")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","WED_HRS")
'			
'			V.Local.sDay.Set("Thur")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","THUR_HRS")
'			
'			V.Local.sDay.Set("Fri")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","FRI_HRS")
'			
'			V.Local.sDay.Set("Sat")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SAT_HRS")

'			V.Local.sDay.Set("Sun2")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SUN2_HRS")
'					
'			V.Local.sDay.Set("Mon2")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","MON2_HRS")
'			
'			V.Local.sDay.Set("Tues2")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","TUES2_HRS")
'			
'			V.Local.sDay.Set("Wed2")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","WED2_HRS")
'			
'			V.Local.sDay.Set("Thur2")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","THUR2_HRS")
'			
'			V.Local.sDay.Set("Fri2")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","FRI2_HRS")
'			
'			V.Local.sDay.Set("Sat2")
'			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SAT2_HRS")
			
			'fliping order to be able to put overtime on last days of pay period
			V.Local.sDay.Set("Sat2")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SAT2_HRS")
			
			V.Local.sDay.Set("Fri2")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","FRI2_HRS")
			
			V.Local.sDay.Set("Thur2")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","THUR2_HRS")
			
			V.Local.sDay.Set("Wed2")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","WED2_HRS")
			
			V.Local.sDay.Set("Tues2")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","TUES2_HRS")
			
			V.Local.sDay.Set("Mon2")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","MON2_HRS")
			
			V.Local.sDay.Set("Sun2")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SUN2_HRS")
			
			V.Local.sDay.Set("Sat")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SAT_HRS")
			
			V.Local.sDay.Set("Fri")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","FRI_HRS")
			
			V.Local.sDay.Set("Thur")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","THUR_HRS")
			
			V.Local.sDay.Set("Wed")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","WED_HRS")
			
			V.Local.sDay.Set("Tues")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","TUES_HRS")
			
			V.Local.sDay.Set("Mon")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","MON_HRS")
			
			V.Local.sDay.Set("Sun")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SUN_HRS")
			
			F.Intrinsic.Control.CallSub(JB0455Sync)
			F.Data.DataTable.Close("DTtime")
			F.Data.DataView.SetValue("dtTimesheet","JobDtl",-1,"Updated",True)
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Close("dtTimesheet","JobDtl")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.iRet)

F.Data.DataTable.Close("Users")

F.Intrinsic.Control.CallSub(cmdSave_Click)

GUI.FormTimesheet..AlwaysOnTop(True)
GUI.FormTimesheet..AlwaysOnTop(False)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdupdate_click.End

Program.Sub.BuildFile.Start
F.Intrinsic.Control.Try

V.Local.dDate.Declare(Date)
V.Local.sDate.Declare(String)
V.Local.iDay.Declare(Long)
V.Local.sDay.Declare(String)
V.Local.sBegTime.Declare(String)
V.Local.i.Declare(Long)
V.Local.sHrs.Declare(String)
V.Local.sTime.Declare(String)
V.Local.sStart.Declare(String)
V.Local.sStop.Declare(String)
V.Local.sStartHH.Declare(String)
V.Local.sStartMM.Declare(String)
V.Local.sStopHH.Declare(String)
V.Local.sStopMM.Declare(String)
V.Local.sSql.Declare(String)
V.Local.sJob.Declare(String)
V.Local.sSuff.Declare(String)
V.Local.sSeq.Declare(String)
V.Local.sWC.Declare(String)
v.Local.fMm.Declare(Float)
V.Local.sRet.Declare(String)
V.Local.fOTHrs.Declare(Float)
V.Local.fTemp.Declare(Float)
V.Local.sOvtRate.Declare(String)
V.Local.sComm3.Declare(String)

F.Intrinsic.Control.If(V.Args.Day,=,"Sun")
	V.Local.dDate.Set(V.Global.dDate)
	V.Local.iDay.Set(1)
	V.Local.sDay.Set("START_SUN")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Mon")
	F.Intrinsic.Date.DateAdd("D",1,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(2)
	V.Local.sDay.Set("START_MON")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Tues")
	F.Intrinsic.Date.DateAdd("D",2,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(3)
	V.Local.sDay.Set("START_TUE")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Wed")
	F.Intrinsic.Date.DateAdd("D",3,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(4)
	V.Local.sDay.Set("START_WED")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Thur")
	F.Intrinsic.Date.DateAdd("D",4,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(5)
	V.Local.sDay.Set("START_THR")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Fri")
	F.Intrinsic.Date.DateAdd("D",5,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(6)
	V.Local.sDay.Set("START_FRI")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Sat")
	F.Intrinsic.Date.DateAdd("D",6,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(7)
	V.Local.sDay.Set("START_SAT")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Sun2")
	F.Intrinsic.Date.DateAdd("D",7,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(8)
	V.Local.sDay.Set("START_SUN")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Mon2")
	F.Intrinsic.Date.DateAdd("D",8,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(9)
	V.Local.sDay.Set("START_MON")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Tues2")
	F.Intrinsic.Date.DateAdd("D",9,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(10)
	V.Local.sDay.Set("START_TUE")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Wed2")
	F.Intrinsic.Date.DateAdd("D",10,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(11)
	V.Local.sDay.Set("START_WED")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Thur2")
	F.Intrinsic.Date.DateAdd("D",11,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(12)
	V.Local.sDay.Set("START_THR")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Fri2")
	F.Intrinsic.Date.DateAdd("D",12,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(13)
	V.Local.sDay.Set("START_FRI")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Sat2")
	F.Intrinsic.Date.DateAdd("D",13,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(14)
	V.Local.sDay.Set("START_SAT")
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select rtrim(ucase(Comments_3)) From Employee_Mstr Where Employee = '{0}'", V.Args.Emp, V.Local.dDate.FormatYYYYMMDD, V.Local.sSQL)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql, V.Local.sComm3)

'grab actual clock in time for start time
F.Intrinsic.String.Build("select RTRIM(SUBSTRING(TIME_IN, 1, 4)) from TIME_ATTENDANCE where EMPLOYEE = '{0}' and CHARGE_DATE = '{1}'", V.Args.Emp, V.Local.dDate.FormatYYYYMMDD, V.Local.sSQL)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql, V.Local.sRet)
F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
	V.Local.sBegTime.Set("0800")
	V.Local.sStart.Set("0800")
	V.Local.sStop.Set("0800")
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Local.sRet.Trim, =, "")
		V.Local.sBegTime.Set("0800")
		V.Local.sStart.Set("0800")
		V.Local.sStop.Set("0800")
	F.Intrinsic.Control.Else
		V.Local.sBegTime.Set(V.Local.sRet)
		F.Intrinsic.Math.Div(V.Local.sRet.Right2, 0.6, V.Local.sRet)
		F.Intrinsic.String.Format(V.Local.sRet, "00", V.Local.sRet)
		F.Intrinsic.String.Build("{0}{1}", V.Local.sBegTime.Left2, V.Local.sRet, V.Local.sStart)
		V.Local.sStop.Set(V.Local.sStart)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.For(V.Local.i,0,v.DataTable.DTtime.RowCount--,1)
	F.Intrinsic.Control.If(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,<>,0)
		F.Intrinsic.Control.If(v.DataTable.DTtime(V.Local.i).OVT_HRS!FieldValFloat,=,0)
			F.Intrinsic.String.Format(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,"####0.0000",V.Local.sHrs)
			F.Intrinsic.String.Format(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,"###00.00",V.Local.sTime)
			
			V.Local.sStart.Set(V.Local.sStop)
			F.Intrinsic.String.Right(V.Local.sStart,2,V.Local.sStartMM)
			F.Intrinsic.String.Left(V.Local.sStart,2,V.Local.sStartHH)
			F.Intrinsic.String.Right(V.Local.sTime,2,V.Local.sStopMM)
			F.Intrinsic.String.Left(V.Local.sTime,2,V.Local.sStopHH)
			F.Intrinsic.Math.Add(V.Local.sStartHH,V.Local.sStopHH,V.Local.sStopHH)
			
			'at this point, stop is in decimal and start is in minutes
			F.Intrinsic.Math.Mult(V.Local.sStopMM, 0.6, V.Local.sStopMM)
			F.Intrinsic.Math.Add(V.Local.sStartMM,V.Local.sStopMM,V.Local.sStopMM)
			
			F.Intrinsic.Control.If(V.Local.sStopMM.Long, >= , 60)
				F.Intrinsic.Math.Add(V.Local.sStopHH,1,V.Local.sStopHH)
				F.Intrinsic.Math.Sub(V.Local.sStopMM,60,V.Local.sStopMM)
			F.Intrinsic.Control.EndIf
	
			F.Intrinsic.String.Format(V.Local.sStopHH,"00",V.Local.sStopHH)
			F.Intrinsic.String.Format(V.Local.sStopMM,"00",V.Local.sStopMM)
			F.Intrinsic.String.Build("{0}{1}",V.Local.sStopHH,V.Local.sStopMM,V.Local.sStop)
	
			F.Intrinsic.Control.If(V.Local.sStop,=,"2400")
				V.Local.sStop.Set("2359")
			F.Intrinsic.Control.EndIf
	
			V.Local.sJob.Set(v.DataTable.DTtime(V.Local.i).Job!FieldVal)
			V.Local.sSuff.Set(v.DataTable.DTtime(V.Local.i).Suffix!FieldVal)
			V.Local.sSeq.Set(v.DataTable.DTtime(V.Local.i).Seq!FieldVal)
			F.Intrinsic.String.Build("Select WORKCENTER from V_JOB_OPERATIONS_WC where JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Local.sJob,V.Local.sSuff,V.Local.sSeq,V.Local.sSql)
			F.ODBC.Connection!con.OpenLocalRecordsetRO("rstWC",V.Local.sSql)
			V.Local.sWC.Set(v.DataTable.DTtime(V.Local.i).WC!FieldVal)
	
			F.ODBC.con!rstWC.Close
			F.Intrinsic.String.Format(V.Local.dDate,"MMDDYY",V.Local.sDate)
			
'			F.Data.DataTable.AddRow("JB0455","Date",V.Local.sDate,"Employee",V.Args.Emp,"Job",V.Local.sJob,"Suffix",V.Local.sSuff,"Seq",V.Local.sSeq,"WC",V.Local.sWC,"Closed","N","Indirect","D","StartTime",V.Local.sStart,"StopTime",V.Local.sStop,"RateType","R","GoodPcs","0","ScrapPcs","0")
			F.Data.DataTable.AddRow("JB0455","Date",V.Local.sDate,"Employee",V.Args.Emp,"Job",V.Local.sJob,"Suffix",V.Local.sSuff,"Seq",V.Local.sSeq,"WC",V.Local.sWC,"Closed","N","Indirect","D","Hours",V.Local.sTime,"RateType","R","GoodPcs","0","ScrapPcs","0")
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,>=,v.DataTable.DTtime(V.Local.i).OVT_HRS!FieldValFloat)
				F.Intrinsic.Math.Sub(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,v.DataTable.DTtime(V.Local.i).OVT_HRS!FieldValFloat,V.Local.fTemp)
				F.Intrinsic.Control.If(V.Local.fTemp,>,0)
					F.Intrinsic.String.Format(V.Local.fTemp,"####0.0000",V.Local.sHrs)
					F.Intrinsic.String.Format(V.Local.fTemp,"###00.00",V.Local.sTime)
					
					V.Local.sStart.Set(V.Local.sStop)
					F.Intrinsic.String.Right(V.Local.sStart,2,V.Local.sStartMM)
					F.Intrinsic.String.Left(V.Local.sStart,2,V.Local.sStartHH)
					F.Intrinsic.String.Right(V.Local.sTime,2,V.Local.sStopMM)
					F.Intrinsic.String.Left(V.Local.sTime,2,V.Local.sStopHH)
					F.Intrinsic.Math.Add(V.Local.sStartHH,V.Local.sStopHH,V.Local.sStopHH)
					
					'at this point, stop is in decimal and start is in minutes
					F.Intrinsic.Math.Mult(V.Local.sStopMM, 0.6, V.Local.sStopMM)
					F.Intrinsic.Math.Add(V.Local.sStartMM,V.Local.sStopMM,V.Local.sStopMM)
					
					F.Intrinsic.Control.If(V.Local.sStopMM.Long, >= , 60)
						F.Intrinsic.Math.Add(V.Local.sStopHH,1,V.Local.sStopHH)
						F.Intrinsic.Math.Sub(V.Local.sStopMM,60,V.Local.sStopMM)
					F.Intrinsic.Control.EndIf
			
					F.Intrinsic.String.Format(V.Local.sStopHH,"00",V.Local.sStopHH)
					F.Intrinsic.String.Format(V.Local.sStopMM,"00",V.Local.sStopMM)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sStopHH,V.Local.sStopMM,V.Local.sStop)
			
					F.Intrinsic.Control.If(V.Local.sStop,=,"2400")
						V.Local.sStop.Set("2359")
					F.Intrinsic.Control.EndIf
			
					V.Local.sJob.Set(v.DataTable.DTtime(V.Local.i).Job!FieldVal)
					V.Local.sSuff.Set(v.DataTable.DTtime(V.Local.i).Suffix!FieldVal)
					V.Local.sSeq.Set(v.DataTable.DTtime(V.Local.i).Seq!FieldVal)
					F.Intrinsic.String.Build("Select WORKCENTER from V_JOB_OPERATIONS_WC where JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Local.sJob,V.Local.sSuff,V.Local.sSeq,V.Local.sSql)
					F.ODBC.Connection!con.OpenLocalRecordsetRO("rstWC",V.Local.sSql)
					V.Local.sWC.Set(v.DataTable.DTtime(V.Local.i).WC!FieldVal)
			
					F.ODBC.con!rstWC.Close
					F.Intrinsic.String.Format(V.Local.dDate,"MMDDYY",V.Local.sDate)
			
'					F.Data.DataTable.AddRow("JB0455","Date",V.Local.sDate,"Employee",V.Args.Emp,"Job",V.Local.sJob,"Suffix",V.Local.sSuff,"Seq",V.Local.sSeq,"WC",V.Local.sWC,"Closed","N","Indirect","D","StartTime",V.Local.sStart,"StopTime",V.Local.sStop,"RateType","R","GoodPcs","0","ScrapPcs","0")
					F.Data.DataTable.AddRow("JB0455","Date",V.Local.sDate,"Employee",V.Args.Emp,"Job",V.Local.sJob,"Suffix",V.Local.sSuff,"Seq",V.Local.sSeq,"WC",V.Local.sWC,"Closed","N","Indirect","D","Hours",V.Local.sTime,"RateType","R","GoodPcs","0","ScrapPcs","0")
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.String.Format(v.DataTable.DTtime(V.Local.i).OVT_HRS!FieldValFloat,"####0.0000",V.Local.sHrs)
				F.Intrinsic.String.Format(v.DataTable.DTtime(V.Local.i).OVT_HRS!FieldValFloat,"###00.00",V.Local.sTime)
				
				F.Data.DataTable.SetValue("DTtime",V.Local.i,"OVT_HRS","0.00")
				
				V.Local.sStart.Set(V.Local.sStop)
				F.Intrinsic.String.Right(V.Local.sStart,2,V.Local.sStartMM)
				F.Intrinsic.String.Left(V.Local.sStart,2,V.Local.sStartHH)
				F.Intrinsic.String.Right(V.Local.sTime,2,V.Local.sStopMM)
				F.Intrinsic.String.Left(V.Local.sTime,2,V.Local.sStopHH)
				F.Intrinsic.Math.Add(V.Local.sStartHH,V.Local.sStopHH,V.Local.sStopHH)
				
				'at this point, stop is in decimal and start is in minutes
				F.Intrinsic.Math.Mult(V.Local.sStopMM, 0.6, V.Local.sStopMM)
				F.Intrinsic.Math.Add(V.Local.sStartMM,V.Local.sStopMM,V.Local.sStopMM)
				
				F.Intrinsic.Control.If(V.Local.sStopMM.Long, >= , 60)
					F.Intrinsic.Math.Add(V.Local.sStopHH,1,V.Local.sStopHH)
					F.Intrinsic.Math.Sub(V.Local.sStopMM,60,V.Local.sStopMM)
				F.Intrinsic.Control.EndIf
		
				F.Intrinsic.String.Format(V.Local.sStopHH,"00",V.Local.sStopHH)
				F.Intrinsic.String.Format(V.Local.sStopMM,"00",V.Local.sStopMM)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sStopHH,V.Local.sStopMM,V.Local.sStop)
		
				F.Intrinsic.Control.If(V.Local.sStop,=,"2400")
					V.Local.sStop.Set("2359")
				F.Intrinsic.Control.EndIf
		
				V.Local.sJob.Set(v.DataTable.DTtime(V.Local.i).Job!FieldVal)
				V.Local.sSuff.Set(v.DataTable.DTtime(V.Local.i).Suffix!FieldVal)
				V.Local.sSeq.Set(v.DataTable.DTtime(V.Local.i).Seq!FieldVal)
				F.Intrinsic.String.Build("Select WORKCENTER from V_JOB_OPERATIONS_WC where JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Local.sJob,V.Local.sSuff,V.Local.sSeq,V.Local.sSql)
				F.ODBC.Connection!con.OpenLocalRecordsetRO("rstWC",V.Local.sSql)
				V.Local.sWC.Set(v.DataTable.DTtime(V.Local.i).WC!FieldVal)
		
				F.ODBC.con!rstWC.Close
				F.Intrinsic.String.RPad(V.Local.sComm3,"0",2,V.Local.sComm3)
				F.Intrinsic.Control.If(V.Local.sComm3.Left2,=,"MG")
					V.Local.sOvtRate.Set("0.00")
				F.Intrinsic.Control.ElseIf(V.Local.sComm3.Left2,=,"NE")
					F.Intrinsic.String.Build("Select rate*1.5 From Employee_Mstr Where Employee = '{0}'",V.Args.Emp,V.Local.sSql)
					F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sOvtRate)
					F.Intrinsic.String.Format(V.Local.sOvtRate,"###0.00",V.Local.sOvtRate)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Select rate From Employee_Mstr Where Employee = '{0}'",V.Args.Emp,V.Local.sSql)
					F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sOvtRate)
					F.Intrinsic.String.Format(V.Local.sOvtRate,"###0.00",V.Local.sOvtRate)
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.String.Format(V.Local.dDate,"MMDDYY",V.Local.sDate)
			
'				F.Data.DataTable.AddRow("JB0455","Date",V.Local.sDate,"Employee",V.Args.Emp,"Job",V.Local.sJob,"Suffix",V.Local.sSuff,"Seq",V.Local.sSeq,"WC",V.Local.sWC,"Closed","N","Indirect","D","StartTime",V.Local.sStart,"StopTime",V.Local.sStop,"RateType","R","GoodPcs","0","ScrapPcs","0","EMPL-RATE",V.Local.sOvtRate)
				F.Data.DataTable.AddRow("JB0455","Date",V.Local.sDate,"Employee",V.Args.Emp,"Job",V.Local.sJob,"Suffix",V.Local.sSuff,"Seq",V.Local.sSeq,"WC",V.Local.sWC,"Closed","N","Indirect","D","Hours",V.Local.sTime,"RateType","R","GoodPcs","0","ScrapPcs","0","EMPL-RATE",V.Local.sOvtRate)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Format(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,"####0.0000",V.Local.sHrs)
				F.Intrinsic.String.Format(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,"###00.00",V.Local.sTime)
				
				V.Local.sStart.Set(V.Local.sStop)
				F.Intrinsic.String.Right(V.Local.sStart,2,V.Local.sStartMM)
				F.Intrinsic.String.Left(V.Local.sStart,2,V.Local.sStartHH)
				F.Intrinsic.String.Right(V.Local.sTime,2,V.Local.sStopMM)
				F.Intrinsic.String.Left(V.Local.sTime,2,V.Local.sStopHH)
				F.Intrinsic.Math.Add(V.Local.sStartHH,V.Local.sStopHH,V.Local.sStopHH)
				
				'at this point, stop is in decimal and start is in minutes
				F.Intrinsic.Math.Mult(V.Local.sStopMM, 0.6, V.Local.sStopMM)
				F.Intrinsic.Math.Add(V.Local.sStartMM,V.Local.sStopMM,V.Local.sStopMM)
				
				F.Intrinsic.Control.If(V.Local.sStopMM.Long, >= , 60)
					F.Intrinsic.Math.Add(V.Local.sStopHH,1,V.Local.sStopHH)
					F.Intrinsic.Math.Sub(V.Local.sStopMM,60,V.Local.sStopMM)
				F.Intrinsic.Control.EndIf
		
				F.Intrinsic.String.Format(V.Local.sStopHH,"00",V.Local.sStopHH)
				F.Intrinsic.String.Format(V.Local.sStopMM,"00",V.Local.sStopMM)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sStopHH,V.Local.sStopMM,V.Local.sStop)
		
				F.Intrinsic.Control.If(V.Local.sStop,=,"2400")
					V.Local.sStop.Set("2359")
				F.Intrinsic.Control.EndIf
		
				V.Local.sJob.Set(v.DataTable.DTtime(V.Local.i).Job!FieldVal)
				V.Local.sSuff.Set(v.DataTable.DTtime(V.Local.i).Suffix!FieldVal)
				V.Local.sSeq.Set(v.DataTable.DTtime(V.Local.i).Seq!FieldVal)
				F.Intrinsic.String.Build("Select WORKCENTER from V_JOB_OPERATIONS_WC where JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Local.sJob,V.Local.sSuff,V.Local.sSeq,V.Local.sSql)
				F.ODBC.Connection!con.OpenLocalRecordsetRO("rstWC",V.Local.sSql)
				V.Local.sWC.Set(v.DataTable.DTtime(V.Local.i).WC!FieldVal)
		
				F.ODBC.con!rstWC.Close
				
				F.Intrinsic.Control.If(V.Local.sComm3,=,"NE")
					V.Local.sOvtRate.Set("0.00")
				F.Intrinsic.Control.ElseIf(V.Local.sComm3,=,"EX")
					F.Intrinsic.String.Build("Select rate From Employee_Mstr Where Employee = '{0}'",V.Args.Emp,V.Local.sSql)
					F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sOvtRate)
					F.Intrinsic.String.Format(V.Local.sOvtRate,"###0.00",V.Local.sOvtRate)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Select rate*1.5 From Employee_Mstr Where Employee = '{0}'",V.Args.Emp,V.Local.sSql)
					F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sOvtRate)
					F.Intrinsic.String.Format(V.Local.sOvtRate,"###0.00",V.Local.sOvtRate)
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.String.Format(V.Local.dDate,"MMDDYY",V.Local.sDate)
				
				F.Intrinsic.Math.Sub(v.DataTable.DTtime(V.Local.i).OVT_HRS!FieldValFloat,v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,V.Local.fTemp)
				F.Data.DataTable.SetValue("DTtime",V.Local.i,"OVT_HRS",V.Local.fTemp)
				
'				F.Data.DataTable.AddRow("JB0455","Date",V.Local.sDate,"Employee",V.Args.Emp,"Job",V.Local.sJob,"Suffix",V.Local.sSuff,"Seq",V.Local.sSeq,"WC",V.Local.sWC,"Closed","N","Indirect","D","StartTime",V.Local.sStart,"StopTime",V.Local.sStop,"RateType","R","GoodPcs","0","ScrapPcs","0","EMPL-RATE",V.Local.sOvtRate)
				F.Data.DataTable.AddRow("JB0455","Date",V.Local.sDate,"Employee",V.Args.Emp,"Job",V.Local.sJob,"Suffix",V.Local.sSuff,"Seq",V.Local.sSeq,"WC",V.Local.sWC,"Closed","N","Indirect","D","Hours",V.Local.sTime,"RateType","R","GoodPcs","0","ScrapPcs","0","EMPL-RATE",V.Local.sOvtRate)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.BuildFile.End

Program.Sub.cmdready_click.Start
F.Intrinsic.Control.Try

V.Local.sRet.Declare(String)
V.Local.sSQL.Declare(String)
v.Local.bReady.Declare(Boolean)
V.Local.sMsg.Declare(String)

F.Intrinsic.Control.If(V.Global.suSer.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("dtTimesheet","VTemp",22,"POTENTIAL_HOURS > HOURS_ESTIMATED","")

F.Intrinsic.Control.If(V.DataView.dtTimesheet!VTemp.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Potential Hours is greater than Est Hours.  Get with your Admin to adjust Est Hours","Attention")
	F.Data.DataView.Close("dtTimesheet","VTemp")
	f.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("dtTimesheet","VTemp")

F.Data.DataView.Create("dtTimesheet","VTemp",22,"OVT_HRS > JOB_SUM AND OVT_HRS > 0","")

F.Intrinsic.Control.If(V.DataView.dtTimesheet!VTemp.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Overtime Hours is greater than Time Entered.  Adjust Overtime hours to be less than or equal Job Total Time","Attention")
	F.Data.DataView.Close("dtTimesheet","VTemp")
	f.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("dtTimesheet","VTemp")

F.Intrinsic.Control.If(v.DataTable.dtTimesheet.RowCount,>,0,"AND",v.Global.bAdminMode,=,false)
	F.Intrinsic.String.Build("Do you wish to flag the displayed time{0} as Ready for Approval?",V.Ambient.NewLine,V.Local.sMsg)
	F.Intrinsic.Control.CallSub(MessageBox, "Title", "Flag as ready?", "Message", V.Local.sMsg, "YesAndNo", True)

	F.Intrinsic.Control.If(V.Global.sMessageBoxReturn.Trim, =, "YES")
		F.Intrinsic.Control.CallSub(cmdsave_click)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Update GCG_6873_TIMSHT Set FLAG_READY = '1' Where UPPER(USER_ID) = '{0}' And Beg_Week = '{1}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSQL)
F.ODBC.Connection!con.Execute(V.Local.sSQL)

F.Data.DataTable.SetValue("dtTimesheet",-1,"Flag_ready",true)

F.Intrinsic.String.Build("Records with date {0} and User {1}{2}have been marked as Ready.",V.Global.dDate,V.Global.sUser,V.Ambient.NewLine,V.Local.sMsg)
F.Intrinsic.Control.CallSub(MessageBox, "Title", "", "Message", V.Local.sMsg, "YesAndNo", False)

GUI.FormTimesheet.cmdReady.Enabled(False)
GUI.FormTimesheet.cmdUpdate.Enabled(true)
F.Intrinsic.Control.If(V.Global.bAdminMode,=,False)
'	'disable save
'	GUI.FormTimesheet.cmdSave.Enabled(False)
'	GUI.FormTimesheet.cmdAdd.Enabled(False)
'	GUI.FormTimesheet.cmdFrmTemp.Enabled(False)
'	
'	'disable the add button cause when they can adda a new job it some how re enables the save.
'	GUI.FormTimesheet.cmdAdd.Enabled(False)

'	'rintGushee
	GUI.FormTimesheet.cmdPrint.Enabled(True)
	
	'flexgridGUI.F_Ti
'	GUI.FormTimesheet.gsgcTimesheet.Enabled(False)

F.Intrinsic.Control.Else
	GUI.FormTimesheet.cmdUnlock.Enabled(True)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdready_click.End

Program.Sub.cmdprint_click.Start
F.Intrinsic.Control.Try

V.Local.sSQL.Declare(String)
V.Local.iRPTID.Declare(Long)
V.Local.sParam.Declare(String)
V.Local.sVals.Declare(String)
V.Local.sRet.Declare(String)

Gui.FormTimesheet.cmdPrint.Enabled(False)

V.Local.sParam.Set("START_DATE*!*BIRUNID*!*GUI_HOURS*!*BALANCE_HOURS*!*HOURS_TA")

F.Intrinsic.UI.InvokeWaitDialog("Printing Report...")

F.global.BI.GetIDFromName("GCG_6873_Timesheet.rpt",V.Local.iRPTID)

F.Intrinsic.Control.If(V.Local.iRPTID,=,-1)
	F.Intrinsic.UI.CloseWaitDialog
	F.Intrinsic.UI.Msgbox("GCG_6873_Timesheet.rpt not found as an active report. Please Activate within Report Maintenance")
	Gui.FormTimesheet.cmdPrint.Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.BlockEvents

F.Global.BI.GetRunID(V.Global.iBIRUNID)
F.Global.BI.StartLogging(V.Global.iBIRUNID,V.Local.iRptID,-1,"",V.Global.iLogID)
F.Intrinsic.String.Build("{0}*!*{1}*!*{2}*!*{3}*!*{4}",V.Global.dDate.formatYYYYMMDD,V.Global.iBIRUNID, V.Screen.FormTimesheet!txtGUIHours.Text.Trim, V.Screen.FormTimesheet!txtHoursBalance.Text.Trim, V.Screen.FormTimesheet!txtHoursTA.Text.Trim, V.Local.sVals)

'ask user in admin mode if they want to print all ready recrods for all employees or just employee selected.
F.Intrinsic.Control.If(V.Global.bAdminMode,=,True)
	'Print Records for all or just selected.")
	F.Intrinsic.UI.Msgbox("Print ready time for ALL employees?","All Employees?",4,V.Local.sRet)
F.Intrinsic.Control.EndIf

'so we have to figure out if it's for all users or employee selected.
'we can only print the users ready time

F.Intrinsic.Control.If(V.Local.sRet.Long,=,6)
	'tey want all users.
	F.Intrinsic.String.Build("select UPPER(USER_ID) AS USER_ID,E.Employee,E.Name,GCG.Job,GCG.Suffix,GCG.Seq as SEQUENCE,JO.Description,WC,Sun_HRS,Mon_HRS,Tues_HRS,WED_HRS,THUR_HRS, FRI_HRS,SAT_HRS, Sun2_HRS,Mon2_HRS,Tues2_HRS,WED2_HRS,THUR2_HRS, FRI2_HRS,SAT2_HRS, JOB_NOTES, OVT_HRS from GCG_6873_TIMSHT As GCG Left Join V_Employee_Mstr As E On GCG.USER_ID = E.PR_USER_ID Left Join V_Job_Operations AS JO On GCG.Job = JO.Job And GCG.Suffix = JO.Suffix and GCG.Seq = JO.SEQ Where Flag_Ready = '1' And BEG_WEEK = '{0}' ",V.Global.dDate.Pervasivedate,V.Local.sSQL)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("select UPPER(USER_ID) AS USER_ID,E.Employee,E.Name,GCG.Job,GCG.Suffix,GCG.Seq as SEQUENCE,JO.Description,WC,Sun_HRS,Mon_HRS,Tues_HRS,WED_HRS,THUR_HRS, FRI_HRS,SAT_HRS, Sun2_HRS,Mon2_HRS,Tues2_HRS,WED2_HRS,THUR2_HRS, FRI2_HRS,SAT2_HRS, JOB_NOTES, OVT_HRS from GCG_6873_TIMSHT As GCG Left Join V_Employee_Mstr As E On GCG.USER_ID = E.PR_USER_ID Left Join V_Job_Operations AS JO On GCG.Job = JO.Job And GCG.Suffix = JO.Suffix and GCG.Seq = JO.SEQ Where GCG.USER_ID ='{0}' And BEG_WEEK = '{1}' ",V.Global.sUser,V.Global.dDate.Pervasivedate,V.Local.sSQL)
F.Intrinsic.Control.EndIf

F.Data.DataTable.CreateFromSQL("DTGetData","con",v.Local.sSQL)
F.Intrinsic.Control.if(v.DataTable.DTGetData.RowCount,=,0)
	F.Intrinsic.UI.Msgbox("There are no records made ready for printing.")
	F.Data.DataTable.Close("DTGetData")
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.UI.CloseWaitDialog
	Gui.FormTimesheet.cmdPrint.Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("Select * from GCG_6873_TIMESHT_BI where BIRUNID = '{0}'",V.Global.iBIRUNID,v.Local.sSQL)
	F.data.DataTable.CreateFromSQL("DTBiUpload","con",v.Local.sSQL)
'	F.Data.DataTable.RemoveColumn("DTGetData","USER_ID")
	F.Data.DataTable.AddColumn("DTGetData","BIRUNID","Long")
	F.Data.DataTable.SetValue("DTGetData",-1,"BIRUNID",V.Global.iBIRUNID)
	F.Data.datatable.Merge("DTGetData","DTBiUpload",false,2)
	F.Data.DataTable.Close("DTGetData")

	F.Intrinsic.Control.If(V.DataTable.DTBiUpload.RowCount,>,0)
		F.ODBC.Connection!con.Execute("Delete From GCG_6873_TIMESHT_BI")
		F.Data.DataTable.SaveToDB("DTBiUpload","con","GCG_6873_TIMESHT_BI","BIRUNID",128)
		F.Data.DataTable.Close("DTBiUpload")
	
		F.Global.BI.RunReportPreProcessor(V.Global.iBIRUNID,V.Global.iLogID,V.Local.sParam,V.Local.sVals,"",-1,False,"",-1,"",-1,"","",V.Global.iBIRUNID)

	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.endif

F.Intrinsic.UI.CloseWaitDialog

Gui.FormTimesheet.cmdPrint.Enabled(True)

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdprint_click.End

Program.Sub.Admin_Mode.Start
F.Intrinsic.Control.Try

v.Local.iRet.Declare

'Are we Admin or not?
'We are looking for Group PYRLADMN
F.Intrinsic.Control.If(v.Global.sUser.Trim,=,"")
	v.Global.sUser.Set(v.Caller.User)
	F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
F.Intrinsic.Control.EndIf

F.Global.Security.IsInGroup(v.Global.sUser,"PYRLADMN",V.Caller.CompanyCode,V.Global.bAdminMode)

F.Intrinsic.Control.If(V.Global.bAdminMode)
	V.Global.sAdminUser.Set(V.Global.sUser)
	F.Intrinsic.UI.Msgbox("Your User ID has been flagged as an Admin for this Dashboard. Do you want to continue as an Admin or Launch the dashboard as a user to update your personal time sheet? Click 'Yes' to Launch as Admin or 'No' to Launch as a User.","Launch in Admin Mode?",4,v.Local.iRet)
	F.Intrinsic.Control.If(v.Local.iRet,=,7)
		v.Global.bAdminMode.Set(False)
		V.Global.sAdminUser.Set("")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

'If we admin we have to Remove the Template buton and shiFt the ready and print buttons
F.Intrinsic.Control.If(V.Global.bAdminMode)
	GUI.FormTimesheet.cmdTemp.Visible(True)
	GUI.FormTimesheet.chkAllEmployees.Position(8190,9795)
	GUI.FormTimesheet.cmdTemp.Position(6990,9720)
	GUI.FormTimesheet.cmdUpdate.Position(2990,9720)
	GUI.FormTimesheet.cmdUnlock.Position(4980,9720)
 	GUI.FormTimesheet.cmdPrint.Position(5990,9720)
 	GUI.FormTimesheet.cmdReady.position(1095,9720)
	'unhide the employee search options and the unlock button
	GUI.FormTimesheet.lblEmp.Visible(True)
	GUI.FormTimesheet.txtEmployee.Visible(True)
	GUI.FormTimesheet.txtEmployee.Enabled(True)
	GUI.FormTimesheet.cmdEmpBrws.Visible(True)
	GUI.FormTimesheet.cmdEmpBrws.Enabled(True)
	GUI.FormTimesheet.cmdEmpSearch.Visible(True)
	GUI.FormTimesheet.cmdEmpSearch.Enabled(True)
	GUI.FormTimesheet.cmdUnlock.Visible(True)
	GUI.FormTimesheet.cmdPrint.Enabled(True)
	GUI.FormTimesheet.lblUser.Visible(True)
	GUI.FormTimesheet.txtUser.Visible(True)
	GUI.FormTimesheet.txtUser.Enabled(True)
'	GUI.FormTimesheet.chkAllEmployees.Visible(True)
	
	GUI.FormTimesheet.lblAJob.Visible(True)
	GUI.FormTimesheet.txtAJob.Visible(True)
	GUI.FormTimesheet.lblASuff.Visible(True)
	GUI.FormTimesheet.txtASuff.Visible(True)
	GUI.FormTimesheet.cmdAddJobBrows.Visible(True)
	GUI.FormTimesheet.lblASeq.Visible(True)
	GUI.FormTimesheet.txtASeq.Visible(True)
	GUI.FormTimesheet.cmdAddSeqBrows.Visible(True)
	GUI.FormTimesheet.lblASeq2.Visible(True)
	GUI.FormTimesheet.txtWC.Visible(True)
	GUI.FormTimesheet.cmdAddWC.Visible(True)
	GUI.FormTimesheet.cmdAdd.Visible(True)
	GUI.FormTimesheet.cmdFrmTemp.Visible(True)
	GUI.FormTimesheet.cmdTemp.Visible(True)
	GUI.FormTimesheet.cmdAddNotes.Visible(True)
	Gui.FormTimesheet.ddlDateSelect.Visible(False)
	Gui.FormTimesheet.dtpWeek.Visible(True)
	
	'V.Global.sUser.Set(v.Screen.FormTimesheet!txtUser.text)
	GUI.FormTimesheet..Caption("Timesheet Entry (Admin Mode)")
F.Intrinsic.Control.Else
	'if we aint admins, we need to remove the update button and shift temp ready and print buttons
	GUI.FormTimesheet.cmdUpdate.Visible(False)
	GUI.FormTimesheet.cmdUpdate.Position(5080,9720)
	GUI.FormTimesheet.cmdTemp.Position(1100,9720)
	GUI.FormTimesheet.cmdReady.Position(2200,9720)
	GUI.FormTimesheet.cmdPrint.Position(4050,9720)
	
	GUI.FormTimesheet.lblAJob.Visible(False)
	GUI.FormTimesheet.txtAJob.Visible(False)
	GUI.FormTimesheet.lblASuff.Visible(False)
	GUI.FormTimesheet.txtASuff.Visible(False)
	GUI.FormTimesheet.cmdAddJobBrows.Visible(False)
	GUI.FormTimesheet.lblASeq.Visible(False)
	GUI.FormTimesheet.txtASeq.Visible(False)
	GUI.FormTimesheet.cmdAddSeqBrows.Visible(False)
	GUI.FormTimesheet.lblASeq2.Visible(False)
	GUI.FormTimesheet.txtWC.Visible(False)
	GUI.FormTimesheet.cmdAddWC.Visible(False)
	GUI.FormTimesheet.cmdAdd.Visible(False)
	GUI.FormTimesheet.cmdFrmTemp.Visible(False)
	GUI.FormTimesheet.cmdTemp.Visible(False)
	GUI.FormTimesheet.cmdAddNotes.Visible(False)
	Gui.FormTimesheet.ddlDateSelect.Visible(True)
	Gui.FormTimesheet.dtpWeek.Visible(False)
	
F.Intrinsic.Control.EndIf

GUI.FormTimesheet.txtUser.Text(v.Global.sUser)
F.Intrinsic.Control.CallSub(txtUser_LostFocus)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.Admin_Mode.End

Program.Sub.cmdempbrws_click.Start
F.Intrinsic.Control.Try

V.Local.sTitle.Declare(String)
V.Local.iWidth.Declare(Long)
V.Local.sRet.Declare(String)

F.Intrinsic.String.Split("Employee*!*Name*!*GS User ID","*!*",V.Local.sTitle)
F.Intrinsic.String.Split("3500*!*3500*!*0","*!*",V.Local.iWidth)
F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select an Employee","con","Select Employee,Name,PR_USER_ID FROM V_EMPLOYEE_MSTR",V.Local.sTitle,V.Local.iWidth,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"***CANCEL***")
	
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	F.Intrinsic.Control.If(V.Local.sRet(0).Trim,<>,V.Screen.FormTimesheet!txtEmployee.Text)
		
		GUI.FormTimesheet.txtEmployee.Text(V.Local.sRet(0).Trim)
		V.Global.sUser.Set(V.Local.sRet(2).Trim)
		F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
		GUI.FormTimesheet.txtUser.Text(V.Global.sUser.Trim)
		F.Intrinsic.Control.If(V.Global.sUser.Trim,=,"")
	'		Askthemfortheuser.
			F.Intrinsic.UI.Browser(10,"",V.Local.sRet)
			F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"***CANCEL***")
				F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
				V.Global.sUser.Set(V.Local.sret(1).Trim)
				F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
				GUI.FormTimesheet.txtUser.Text(V.Global.sUser.Trim)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdempbrws_click.End

Program.Sub.cmdempsearch_click.Start
F.Intrinsic.Control.Try

V.Local.sSQL.Declare(String)
V.Local.sUser.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sEmployee.Declare(String)

'F.Intrinsic.Control.If(V.Screen.FormTimesheet!txtEmployee.Text,=,"")
'	F.Intrinsic.Control.ExitSub
'F.Intrinsic.Control.EndIf

F.Intrinsic.Control.BlockEvents

F.Intrinsic.Control.CallSub(EmptyTotals)
F.Intrinsic.Control.CallSub(Gridload)
F.Intrinsic.Control.CallSub(GridTitle)
F.Intrinsic.Control.CallSub(ComputeTotals)

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdempsearch_click.End

Program.Sub.cmdunlock_click.Start
F.Intrinsic.Control.Try

V.Local.sSQL.Declare(String)
v.Local.iCount.Declare

F.Intrinsic.Control.If(V.Global.suSer.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'F.Intrinsic.String.Build("Select Count(UPDATED) from GCG_6873_TIMSHT Where UPPER(USER_ID) = '{0}' And Beg_Week = '{1}' and UPDATED = 1",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSQL)
'F.ODBC.Connection!con.executeandreturn(v.Local.sSQL,v.Local.iCount)
'F.Intrinsic.Control.If(v.Local.iCount,>,0)
'	F.Intrinsic.Control.CallSub(MessageBox, "Title", "", "Message", "Records have already been posted to GSS and cannot be unlocked.", "YesAndNo", False)
'	F.Intrinsic.Control.ExitSub
'F.Intrinsic.Control.EndIf

'F.Intrinsic.String.Build("Update GCG_6873_TIMSHT Set FLAG_READY = '0' Where UPPER(USER_ID) = '{0}' And Beg_Week = '{1}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSQL)
'F.ODBC.Connection!con.Execute(V.Local.sSQL)

'F.Intrinsic.UI.Msgbox("Records have been Unlocked...")
F.Intrinsic.Control.For(V.Local.iCount,0,V.DataTable.dtTimesheet.RowCount--,1)
	F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Local.iCount).Flag_Ready!FieldVal,=,True,"AND",V.DataTable.dtTimesheet(V.Local.iCount).Updated!FieldVal,=,False)
		F.Data.DataTable.SetValue("dtTimesheet",V.Local.iCount,"Flag_ready",False)
		V.Local.bSave.Set(True)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.iCount)

F.Intrinsic.Control.If(V.Local.bSave)
	F.Intrinsic.Control.If(V.Global.bSaveMsg)
		V.Global.bSaveMsg.Set(False)
		F.Intrinsic.Control.CallSub(cmdsave_click)
		V.Global.bSaveMsg.Set(True)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(cmdsave_click)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(cmdRefresh_Click)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdunlock_click.End

Program.Sub.gsgcTimesheet_RowCellClick.Start
F.Intrinsic.Control.Try

v.Local.ssql.Declare(string)
v.Local.sParam.Declare(string)
v.Local.sJob.Declare(string)
v.Local.sSuffix.Declare(string)
v.Local.sNotes.Declare(String)
V.Local.sDate.Declare(String)
V.Local.fFullDecimal.Declare(Float)
V.Local.iRet.Declare(Long,0)
V.Local.sChgBy.Declare(String,"")
V.Local.bSpedJob.Declare(Boolean,False)

F.Intrinsic.Control.If(V.Global.bAdminMode)
	V.Local.sChgBy.Set(V.Global.sAdminUser)
F.Intrinsic.Control.Else	
	V.Local.sChgBy.Set(V.Global.sUser)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.IsInCallstack(gsgcTimesheet_CellValueChanged,V.Local.iRet)

F.Intrinsic.Control.If(V.Local.iRet,>,0)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
V.Local.sDate.Set(V.Ambient.Date.FORMATM/DD/YY)

F.Intrinsic.Control.If(V.Args.RowIndex,>,-1)
	V.Local.bSpedJob.Set(False)
	V.Local.sJob.Set(V.DataTable.dtTimesheet(V.Args.RowIndex).Job!FieldValTrim)
	V.Local.sJob.Set(V.Local.sJob.UCase)
'	V.Local.sJob.Set(V.Local.sJob.Left3)
	F.Intrinsic.Control.If(V.Local.sJob.Left3,=,"HOL","OR",V.Local.sJob.Left3,=,"VAC")
		V.Local.bSpedJob.Set(True)
	F.Intrinsic.Control.ElseIf(V.Local.sJob.Left2,=,"SL")
		V.Local.bSpedJob.Set(True)
	F.Intrinsic.Control.ElseIf(V.Local.sJob.Left5,=,"EMRGL")
		V.Local.bSpedJob.Set(True)
	F.Intrinsic.Control.ElseIf(V.Local.sJob.Left2,=,"HD")
			V.Local.bSpedJob.Set(True)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.SelectCase(V.Args.Column.UCase)
	F.Intrinsic.Control.Case("DELETE")
'		F.Intrinsic.String.Build("DELETE from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND JOB = '{1}' AND SUFFIX = '{2}' AND SEQ = '{3}' AND BEG_WEEK = '{4}'",V.Global.sUser,v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDate.PervasiveDate,V.Local.sSql)	
'		F.odbc.Connection!con.execute(v.Local.ssql)
'		F.data.DataTable.DeleteRow("dtTimesheet",v.Args.RowIndex)	
'		F.Intrinsic.Control.CallSub(ComputeTotals)
		F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Args.RowIndex).Updated!FieldVal,=,False,"AND",V.DataTable.dtTimesheet(V.Args.RowIndex).Flag_Ready!FieldVal,=,False)
			F.Intrinsic.UI.Msgbox("Are you sure you want to delete this record?","Delete Record",4,V.Local.iRet)
			F.Intrinsic.Control.If(V.Local.iRet,=,6)
				F.Intrinsic.String.Build("DELETE from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND JOB = '{1}' AND SUFFIX = '{2}' AND SEQ = '{3}' AND BEG_WEEK = '{4}'",V.Global.sUser,v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDate.PervasiveDate,V.Local.sSql)	
				F.odbc.Connection!con.execute(v.Local.ssql)
				F.data.DataTable.DeleteRow("dtTimesheet",v.Args.RowIndex)
				F.Data.DataTable.AcceptChanges("dtTimesheet")
				F.Intrinsic.Control.CallSub(ComputeTotals)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.ElseIf(V.DataTable.dtTimesheet(V.Args.RowIndex).Updated!FieldVal,=,False,"AND",V.DataTable.dtTimesheet(V.Args.RowIndex).Flag_Ready!FieldVal,=,True)
			F.Intrinsic.Control.If(V.Global.bAdminMode)
				F.Intrinsic.UI.Msgbox("Are you sure you want to delete this record?","Delete Record",4,V.Local.iRet)
				F.Intrinsic.Control.If(V.Local.iRet,=,6)
					F.Intrinsic.String.Build("DELETE from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND JOB = '{1}' AND SUFFIX = '{2}' AND SEQ = '{3}' AND BEG_WEEK = '{4}'",V.Global.sUser,v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDate.PervasiveDate,V.Local.sSql)	
					F.odbc.Connection!con.execute(v.Local.ssql)
					F.data.DataTable.DeleteRow("dtTimesheet",v.Args.RowIndex)
					F.Data.DataTable.AcceptChanges("dtTimesheet")
					F.Intrinsic.Control.CallSub(ComputeTotals)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Record has already been submitted for Approval. Contact Supervisor","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			F.Intrinsic.UI.Msgbox("Record has already been Posted To GSS. Record will need to be modified with Stand Global Shop.","Attention")
		F.Intrinsic.Control.EndIf
		
'	F.Intrinsic.Control.Case("JOB")
'		v.Local.sJob.Set(v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldVal)
'		v.Local.sSuffix.Set(v.DataTable.dtTimesheet(v.Args.RowIndex).SUFFIX!FieldVal)
'		GUI.FormTimesheet..Enabled(False)
'		F.Intrinsic.String.RPad(v.Local.sJob," ",6,v.Local.sJob)
'		F.Intrinsic.String.RPad(v.Local.sSuffix," ",3,v.Local.sSuffix)
'	
'		F.Intrinsic.String.Build("7!*!{0}!*!{1}!*!A",v.Local.sJob,v.Local.sSuffix,v.Local.sParam)
'	
'		F.Global.General.CallWrapperSync(450000,v.Local.sParam)
'		GUI.FormTimesheet..SetFocus
'		GUI.FormTimesheet..Enabled(True)
'		
'	F.Intrinsic.Control.Case("SUFFIX")
'		v.Local.sJob.Set(v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldVal)
'		v.Local.sSuffix.Set(v.DataTable.dtTimesheet(v.Args.RowIndex).SUFFIX!FieldVal)
'		GUI.FormTimesheet..Enabled(False)
'		F.Intrinsic.String.RPad(v.Local.sJob," ",6,v.Local.sJob)
'		F.Intrinsic.String.RPad(v.Local.sSuffix," ",3,v.Local.sSuffix)
'	
'		F.Intrinsic.String.Build("7!*!{0}!*!{1}!*!A",v.Local.sJob,v.Local.sSuffix,v.Local.sParam)
'	
'		F.Global.General.CallWrapperSync(450000,v.Local.sParam)
'		GUI.FormTimesheet..SetFocus
'		GUI.FormTimesheet..Enabled(True)
'		
'	F.Intrinsic.Control.Case("SEQ")
'		v.Local.sJob.Set(v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldVal)
'		v.Local.sSuffix.Set(v.DataTable.dtTimesheet(v.Args.RowIndex).SUFFIX!FieldVal)
'		GUI.FormTimesheet..Enabled(False)
'		F.Intrinsic.String.RPad(v.Local.sJob," ",6,v.Local.sJob)
'		F.Intrinsic.String.RPad(v.Local.sSuffix," ",3,v.Local.sSuffix)
'	
'		F.Intrinsic.String.Build("7!*!{0}!*!{1}!*!A",v.Local.sJob,v.Local.sSuffix,v.Local.sParam)
'	
'		F.Global.General.CallWrapperSync(450000,v.Local.sParam)
'		GUI.FormTimesheet..SetFocus
'		GUI.FormTimesheet..Enabled(True)
'		
'	F.Intrinsic.Control.Case("JSS")
'		v.Local.sJob.Set(v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldVal)
'		v.Local.sSuffix.Set(v.DataTable.dtTimesheet(v.Args.RowIndex).SUFFIX!FieldVal)
'		GUI.FormTimesheet..Enabled(False)
'		F.Intrinsic.String.RPad(v.Local.sJob," ",6,v.Local.sJob)
'		F.Intrinsic.String.RPad(v.Local.sSuffix," ",3,v.Local.sSuffix)
'	
'		F.Intrinsic.String.Build("7!*!{0}!*!{1}!*!A",v.Local.sJob,v.Local.sSuffix,v.Local.sParam)
'	
'		F.Global.General.CallWrapperSync(450000,v.Local.sParam)
'		GUI.FormTimesheet..SetFocus
'		GUI.FormTimesheet..Enabled(True)
		
	F.Intrinsic.Control.Case("JOB_NOTES")
		v.Global.iRowId.Set(v.Args.RowIndex)
		gui.FormTimesheet.gsgcTimesheet.GetCellValueByColumnName("gvTimesheet", "JOB_NOTES", v.Args.RowIndex, v.Local.sJob)
		gui.F_New_Line.txt1.Text(v.Local.sJob)
		gui.F_New_Line..Visible(True)
	
	F.Intrinsic.Control.Case("SUNDAY_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(0),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).SUNDAY_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(0),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(0),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).SUNDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(0),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SUNDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).SUNDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SUN_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).SUNDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SUNDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).SUNDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SUN_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	 
	F.Intrinsic.Control.Case("MONDAY_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(1),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).MONDAY_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(1),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(1),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).MONDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(1),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"MONDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).MONDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"MON_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).MONDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"MONDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).MONDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"MON_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("TUESDAY_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(2),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).TUESDAY_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(2),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(2),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).TUESDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(2),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"TUESDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).TUESDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"TUES_HRS",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).TUESDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"TUESDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).TUESDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"TUES_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("WEDNESDAY_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(3),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).WEDNESDAY_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(3),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(3),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).WEDNESDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(3),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"WEDNESDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).WEDNESDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"WED_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).WEDNESDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"WEDNESDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).WEDNESDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"WED_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("THURSDAY_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(4),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).THURSDAY_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(4),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(4),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).THURSDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(4),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"THURSDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).THURSDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"THUR_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).THURSDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"THURSDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).THURSDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"THUR_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("FRIDAY_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(5),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).FRIDAY_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(5),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(5),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).FRIDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(5),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"FRIDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).FRIDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"FRI_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).FRIDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"FRIDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).FRIDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"FRI_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("SATURDAY_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(6),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).SATURDAY_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(6),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(6),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).SATURDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(6),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SATURDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).SATURDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SAT_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).SATURDAY_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SATURDAY_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).SATURDAY_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SAT_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	''''addition
	F.Intrinsic.Control.Case("SUNDAY2_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(7),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).SUNDAY2_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(7),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(7),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).SUNDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(7),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SUNDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).SUNDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SUN2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).SUNDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SUNDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).SUNDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SUN2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	 
	F.Intrinsic.Control.Case("MONDAY2_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(8),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).MONDAY2_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(8),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(8),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).MONDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(8),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"MONDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).MONDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"MON2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).MONDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"MONDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).MONDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"MON2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("TUESDAY2_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(9),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).TUESDAY2_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(9),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(9),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).TUESDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(9),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"TUESDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).TUESDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"TUES2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
			
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).TUESDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"TUESDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).TUESDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"TUES2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("WEDNESDAY2_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(10),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).WEDNESDAY2_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(10),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(10),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).WEDNESDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(10),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"WEDNESDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).WEDNESDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"WED2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).WEDNESDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"WEDNESDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).WEDNESDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"WED2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("THURSDAY2_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(11),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).THURSDAY2_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(11),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(11),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).THURSDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(11),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"THURSDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).THURSDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"THUR2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).THURSDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"THURSDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).THURSDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"THUR2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("FRIDAY2_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(12),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).FRIDAY2_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(12),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(12),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).FRIDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(12),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"FRIDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).FRIDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"FRI2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).FRIDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"FRIDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).FRIDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"FRI2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("SATURDAY2_HOURS_EDIT")
		F.Intrinsic.Control.If(V.Args.Button.UCase,=,"LEFT")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Seq_Closed!FieldValTrim,=,"Y")
				F.Intrinsic.UI.Msgbox("Labor Seq is Closed. No additional Time can be applied.","Attention")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Updated!FieldVal,=,True)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,<=,v.DataTable.dtTimesheet(v.Args.RowIndex).Due_Date!FieldVal,"OR",V.Global.bAdminMode,=,True)
				F.Intrinsic.Control.If(V.Global.dDateRecord(13),>,V.Local.sDate,"AND",V.Local.bSpedJob,=,False)
					F.Intrinsic.UI.Msgbox("Time cannot be applied to future Dates.","Attention")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).Flag_Hold!FieldValTrim,=,"Y")
					F.Intrinsic.Control.If(v.DataTable.dtTimesheet(v.Args.RowIndex).SATURDAY2_HOURS_EDIT!FieldVal,=,"0:00")
						F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(13),V.Local.ssql)
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				
						F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
							F.Intrinsic.UI.Msgbox("Time cannot be applied to on Hold Jobs.","Attention")
							F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
								F.Data.DataView.Close("Reason","Temp")
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
							F.Data.DataView.Close("Reason","Temp")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and Date_Record = '{3}'",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,V.Global.dDateRecord(13),V.Local.ssql)
				F.Intrinsic.Control.If(v.DataView.Reason!Temp.Exists)
					F.Data.DataView.Close("Reason","Temp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("Reason","Temp",22,V.Local.ssql,"")
				F.Intrinsic.Control.If(V.DataView.Reason!Temp.RowCount--,=,-1)
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).SATURDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(" ")
					Gui.FormTimeAdjust.txtNote.Text(" ")
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.AddRow("Reason","Rec_No",0,"User_ID",v.DataTable.dtTimesheet(v.Args.RowIndex).User_ID!FieldValTrim,"Chg_By",V.Local.sChgBy,"Job",v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldValTrim,"Suffix",v.DataTable.dtTimesheet(v.Args.RowIndex).Suffix!FieldValTrim,"Seq",v.DataTable.dtTimesheet(v.Args.RowIndex).Seq!FieldValTrim,"Date_Change",V.Ambient.Now,"Date_Record",V.Global.dDateRecord(13),"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text,"Previous_Hrs",V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldVal)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SATURDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).SATURDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SAT2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataTable.Reason.RowCount--,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).SATURDAY2_HOURS_EDIT!FieldVal,":",V.Local.ssql)
					gui.FormTimeAdjust.txtHour.Text(V.Local.ssql)
					gui.FormTimeAdjust.txtMin.Text(V.Local.ssql(1))
					Gui.FormTimeAdjust.ddlReason.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Reason!FieldValTrim)
					Gui.FormTimeAdjust.txtNote.Text(V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).Note!FieldValTrim)
					Gui.FormTimesheet..Enabled(False)
					Gui.FormTimeAdjust..Show
					Gui.FormTimeAdjust..AlwaysOnTop(True)
					Gui.FormTimeAdjust..WaitForDismiss
					Gui.FormTimesheet..Enabled(True)
					Gui.FormTimesheet..AlwaysOnTop(True)
					Gui.FormTimesheet..AlwaysOnTop(False)
					F.Intrinsic.Control.If(V.Global.bUpdate)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"Date_Change",V.Ambient.Now,"Reason",V.Screen.FormTimeAdjust!ddlReason.Text,"Note",V.Screen.FormTimeAdjust!txtNote.Text)
						F.Intrinsic.String.Build("{0}:{1}",V.Screen.FormTimeAdjust!txtHour.Text,V.Screen.FormTimeAdjust!txtMin.Text,V.Local.ssql)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SATURDAY2_HOURS_EDIT",V.Local.ssql)
						F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).SATURDAY2_HOURS_EDIT!FieldValTrim)
						F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"SAT2_HRS",V.Args.Decimal)
						F.Data.DataTable.SetValue("Reason",V.DataView.Reason!Temp(V.DataView.Reason!Temp.RowCount--).DataTableIndex,"New_Hrs",V.Args.Decimal)
						F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
						F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'						F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
						
						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)
'						F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)

						v.Global.bSaveMsg.Set(true)
						F.Intrinsic.Control.CallSub(ComputeTotals)
					F.Intrinsic.Control.EndIf
					V.Global.bUpdate.Set(False)
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("Reason","Temp")
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Job is Overdue. No additional Time can be applied to the Job","Attention")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("FLAG_READY")
		F.Intrinsic.Control.If(V.Global.bAdminMode)
			F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Args.RowIndex).Updated!FieldVal,=,False)
				V.Global.bSaveMsg.Set(True)
				F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"Flag_Ready",V.DataTable.dtTimesheet(V.Args.RowIndex).Flag_Ready!FieldValNot)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf	
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.gsgcTimesheet_RowCellClick.End

Program.Sub.txtEmployee_Change.Start
F.Intrinsic.Control.Try

V.Local.sEmployee.Declare(string)
V.Local.iCheck.Declare(Long)
v.Local.sSql.Declare(String)
v.Local.sRet.Declare(String)
v.Local.sRet1.Declare(String)
V.Local.sEmployee.set(V.Screen.FormTimesheet!txtEmployee.Text)

F.Intrinsic.Control.If(v.Local.sEmployee.trim,=,"")
	F.Intrinsic.Control.BlockEvents
	Gui.FormTimesheet.txtUser.Text("")
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Employee,PR_USER_ID FROM V_EMPLOYEE_MSTR where employee = '{0}'",v.Local.sEmployee,v.Local.sSql)
F.odbc.Connection!con.ExecuteAndReturn(v.Local.sSql,v.Local.sRet)
F.Intrinsic.Control.BlockEvents
F.Intrinsic.Control.If(v.Local.sRet.Trim,=,"")
	F.Intrinsic.UI.Msgbox("The employee ID does not exist in the database.")
	GUI.FormTimesheet.txtUser.Text("")
	GUI.FormTimesheet.txtEmployee.Text("")
	F.Intrinsic.Control.UnBlockEvents
	GUI.FormTimesheet.txtEmployee.SetFocus
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Split(v.Local.sRet,"*!*",v.Local.sRet)

V.Global.sUser.Set(V.Local.sRet(1).Trim)
F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
GUI.FormTimesheet.txtUser.Text(V.Global.sUser.Trim)
F.Intrinsic.Control.If(V.Global.sUser.Trim,=,"")
'		Askthemfortheuser.
	F.Intrinsic.UI.Browser(10,"",V.Local.sRet1)
	F.Intrinsic.Control.If(V.Local.sRet1.Trim,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet1,"*!*",V.Local.sRet1)
		V.Global.sUser.Set(V.Local.sRet1(1).Trim)
		F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
		GUI.FormTimesheet.txtUser.Text(V.Global.sUser.Trim)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf
GUI.FormTimesheet.txtUser.SetFocus
F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.txtEmployee_Change.End

Program.Sub.gsgcTimesheet_CellValueChanged.Start
F.Intrinsic.Control.Try

V.Local.bInString.Declare(Boolean)
V.Local.fHours.Declare(Float)
V.Local.fMinutes.Declare(Float)
V.Local.sTime.Declare(String)
V.Local.sSplit.Declare(String)
V.Local.sWriteColumn.Declare(String)
V.Local.fFullDecimal.Declare(Float)
V.Local.sHours.Declare(String)
V.Local.sMinutes.Declare(String)
V.Local.iRet.Declare(Long)
V.Local.sMsg.Declare(String)
V.Local.sTemp.Declare(String)
V.Local.fIncDec.Declare(Float,0)

'get which column to modify
F.Data.Dictionary.Create("dictColumns")
F.Data.Dictionary.AddItem("dictColumns", "SUNDAY_HOURS_EDIT", "SUN_HRS")
F.Data.Dictionary.AddItem("dictColumns", "MONDAY_HOURS_EDIT", "MON_HRS")
F.Data.Dictionary.AddItem("dictColumns", "TUESDAY_HOURS_EDIT", "TUES_HRS")
F.Data.Dictionary.AddItem("dictColumns", "WEDNESDAY_HOURS_EDIT", "WED_HRS")
F.Data.Dictionary.AddItem("dictColumns", "THURSDAY_HOURS_EDIT", "THUR_HRS")
F.Data.Dictionary.AddItem("dictColumns", "FRIDAY_HOURS_EDIT", "FRI_HRS")
F.Data.Dictionary.AddItem("dictColumns", "SATURDAY_HOURS_EDIT", "SAT_HRS")
F.Data.Dictionary.AddItem("dictColumns", "SUN_HRS", "SUNDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "MON_HRS", "MONDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "TUES_HRS", "TUESDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "WED_HRS", "WEDNESDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "THUR_HRS", "THURSDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "FRI_HRS", "FRIDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "SAT_HRS", "SATURDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "SUNDAY2_HOURS_EDIT", "SUN2_HRS")
F.Data.Dictionary.AddItem("dictColumns", "MONDAY2_HOURS_EDIT", "MON2_HRS")
F.Data.Dictionary.AddItem("dictColumns", "TUESDAY2_HOURS_EDIT", "TUES2_HRS")
F.Data.Dictionary.AddItem("dictColumns", "WEDNESDAY2_HOURS_EDIT", "WED2_HRS")
F.Data.Dictionary.AddItem("dictColumns", "THURSDAY2_HOURS_EDIT", "THUR2_HRS")
F.Data.Dictionary.AddItem("dictColumns", "FRIDAY2_HOURS_EDIT", "FRI2_HRS")
F.Data.Dictionary.AddItem("dictColumns", "SATURDAY2_HOURS_EDIT", "SAT2_HRS")
F.Data.Dictionary.AddItem("dictColumns", "SUN2_HRS", "SUNDAY2_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "MON2_HRS", "MONDAY2_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "TUES2_HRS", "TUESDAY2_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "WED2_HRS", "WEDNESDAY2_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "THUR2_HRS", "THURSDAY2_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "FRI2_HRS", "FRIDAY2_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "SAT2_HRS", "SATURDAY2_HOURS_EDIT")
F.Data.Dictionary.SetDefaultReturn("dictColumns", "")

V.Local.sWriteColumn.Set(V.Dictionary.dictColumns![V.Args.Column.Trim])
F.Data.Dictionary.Close("dictColumns")

F.Intrinsic.Control.If(V.Global.iIncr,>,0)
'	F.Intrinsic.String.Split(V.Args.Value,":",V.Local.sHours)
'	F.Intrinsic.Math.Mod(V.Local.sHours(1).Long,V.Global.iIncr,V.Local.iRet)
'	F.Intrinsic.String.Split(V.Args.Value,".",V.Local.sHours)
	F.Intrinsic.String.Format(V.Args.Value,"#0.00",V.Local.sHours)
	F.Intrinsic.String.Split(V.Local.sHours,".",V.Local.sHours)
	F.Intrinsic.Math.Div(V.Global.iIncr,60,V.Local.fIncDec)
	F.Intrinsic.Math.Mult(V.Local.fIncDec,100,V.Local.fIncDec)
	F.Intrinsic.Math.Mod(V.Local.sHours(1).Long,V.Local.fIncDec.Long,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,<>,0)
		F.Intrinsic.String.Build("Time Data Must in increments of .{0}",V.Local.fIncDec,V.Local.sMsg)
		F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Attention")
		F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Args.RowIndex).[V.Local.sWriteColumn]!FieldValFloat,=,0)
			V.Local.sTemp.Set("0.00")
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Split(V.DataTable.dtTimesheet(V.Args.RowIndex).[V.Local.sWriteColumn]!FieldValFloat,".",V.Local.sTemp)
			F.Intrinsic.Control.If(V.Local.sTemp.UBound,=,0)
				F.Intrinsic.String.Build("{0}.00",V.Local.sTemp,V.Local.sTemp)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Mult(V.Local.sTemp(1),.6,V.Local.sTemp(1))
				F.Intrinsic.String.Format(V.Local.sTemp(1),"00",V.Local.sTemp(1))
				F.Intrinsic.String.Build("{0}.{1}",V.Local.sTemp,V.Local.sTemp(1),V.Local.sTemp)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.BlockEvents
		F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,V.Args.Column,V.Local.sTemp)
		F.Intrinsic.Control.UnBlockEvents
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

'check if decimal or time column
F.Intrinsic.String.IsInString(V.Args.Column, "HOURS_EDIT", True, V.Local.bInString)

F.Intrinsic.Control.BlockEvents
F.Intrinsic.Control.If(V.Local.bInString)
	'time column, update decimal column
	F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Args.RowIndex).[V.Args.Column]!FieldValTrim, =, "")
		F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, V.Args.Column, "0.00")
	F.Intrinsic.Control.EndIf
	
'	F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).[V.Args.Column]!FieldValTrim)

'	F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, V.Local.sWriteColumn, V.Args.Decimal)
	F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, V.Local.sWriteColumn, v.Args.Value)
F.Intrinsic.Control.Else
	'decimal column, update time column
'	F.Intrinsic.Control.CallSub(CalculateTimeColumn, "ROW", V.Args.RowIndex, "COLUMN", V.Args.Column, "TARGET_COLUMN", V.Local.sWriteColumn)
F.Intrinsic.Control.EndIf

'check job total column
F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).SUN2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI2_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT2_HRS!FieldValTrim, V.Local.fFullDecimal)
'F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)

'F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)
F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Local.fFullDecimal)

F.Intrinsic.Control.If(V.Local.fFullDecimal,<,V.DataTable.dtTimesheet(V.Args.RowIndex).OVT_HRS!FieldValFloat,"AND",V.DataTable.dtTimesheet(V.Args.RowIndex).OVT_HRS!FieldValFloat,>,0)
	F.Intrinsic.UI.Msgbox("Overtime Hours is Greater than Entered Time.","Attention")
F.Intrinsic.Control.EndIf

F.Intrinsic.Math.Add(V.Local.fFullDecimal,V.DataTable.dtTimesheet(V.Args.RowIndex).HOURS_ACTUAL!FieldVal,V.Local.fFullDecimal)
'F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)
'F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "P_Hours", V.Args.Time)

F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "P_Hours", V.Local.fFullDecimal)
F.Intrinsic.Control.UnBlockEvents

v.Global.bSaveMsg.Set(true)
F.Intrinsic.Control.CallSub(ComputeTotals)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.gsgcTimesheet_CellValueChanged.End

Program.Sub.ConvertTimeToDecimal.Start
F.Intrinsic.Control.Try

V.Local.fHours.Declare(Float)
V.Local.fMinutes.Declare(Float)
V.Local.sSplit.Declare(String)
V.Local.fFullDecimal.Declare(Float)
V.Local.sHours.Declare(String)
V.Local.sMinutes.Declare(String)
V.Local.sNegative.Declare(String, "")
V.Local.sTime.Declare(String)

V.Local.sTime.Set(V.Args.Time)
F.Intrinsic.Control.If(V.Local.sTime.Left1, =, "-")
	V.Local.sNegative.Set("-")
	F.Intrinsic.String.Replace(V.Local.sTime, "-", "", V.Local.sTime)
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Split(V.Local.sTime, ":", V.Local.sSplit)
V.Local.fHours.Set(V.Local.sSplit(0).Float)
V.Local.fMinutes.Set(V.Local.sSplit(1).Float)

F.Intrinsic.Math.Div(V.Local.fMinutes, 60, V.Local.fMinutes)
F.Intrinsic.String.Format(V.Local.fHours, "0", V.Local.sHours)
F.Intrinsic.Math.Add(V.Local.fHours, V.Local.fMinutes, V.Local.fFullDecimal)

F.Intrinsic.Math.Round(V.Local.fFullDecimal, 4, V.Local.fFullDecimal)
F.Intrinsic.Variable.AddRV("DECIMAL", V.Local.fFullDecimal)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.ConvertTimeToDecimal.End

Program.Sub.CalculateTimeColumn.Start
F.Intrinsic.Control.Try

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.DataTable.dtTimesheet(V.Args.ROW).[V.Args.COLUMN]!FieldValFloat)
F.Data.DataTable.SetValue("dtTimesheet", V.Args.ROW, V.Args.TARGET_COLUMN, V.Args.Time)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.CalculateTimeColumn.End

Program.Sub.ConvertDecimalToTime.Start
F.Intrinsic.Control.Try

V.Local.fHours.Declare(Float)
V.Local.fMinutes.Declare(Float)
V.Local.sMinutes.Declare(String)
V.Local.sHours.Declare(String)
V.Local.sTime.Declare(String)
V.Local.sNegative.Declare(String, "")

F.Intrinsic.Control.If(V.Args.Decimal, <, 0)
	V.Local.sNegative.Set("-")
F.Intrinsic.Control.EndIf

F.Intrinsic.Math.Mult(V.Args.Decimal, 60, V.Local.fMinutes)
F.Intrinsic.Math.IDiv(V.Local.fMinutes, 60, V.Local.fHours)
F.Intrinsic.Math.Mod(V.Local.fMinutes, 60, V.Local.fMinutes)
F.Intrinsic.Math.Abs(V.Local.fMinutes, V.Local.fMinutes)
F.Intrinsic.Math.Abs(V.Local.fHours, V.Local.fHours)
F.Intrinsic.String.Format(V.Local.fHours, "0", V.Local.sHours)
F.Intrinsic.Math.Round(V.Local.fMinutes, 0, V.Local.fMinutes)
F.Intrinsic.Control.If(V.Local.fMinutes, >, 59)
	F.Intrinsic.Math.Add(V.Local.fHours, 1, V.Local.fHours)
	V.Local.fMinutes.Set("0")
F.Intrinsic.Control.EndIf
F.Intrinsic.String.Format(V.Local.fMinutes, "00", V.Local.sMinutes)
F.Intrinsic.String.Build("{2}{0}:{1}", V.Local.sHours, V.Local.sMinutes, V.Local.sNegative, V.Local.sTime)

F.Intrinsic.Control.If(V.Local.sTime, =, "-0:00")
	F.Intrinsic.String.Replace(V.Local.sTime, "-", "", V.Local.sTime)
F.Intrinsic.Control.EndIf

F.Intrinsic.Variable.AddRV("TIME", V.Local.sTime)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.ConvertDecimalToTime.End

Program.Sub.CalculateAllTimeColumns.Start
F.Intrinsic.Control.Try

V.Local.iCounter.Declare(Long)
V.Local.iJ.Declare(Long)
V.Local.sColumns.Declare(String, "SUN_HRS@!@SUNDAY_HOURS_EDIT*!*MON_HRS@!@MONDAY_HOURS_EDIT*!*TUES_HRS@!@TUESDAY_HOURS_EDIT*!*WED_HRS@!@WEDNESDAY_HOURS_EDIT*!*THUR_HRS@!@THURSDAY_HOURS_EDIT*!*FRI_HRS@!@FRIDAY_HOURS_EDIT*!*SAT_HRS@!@SATURDAY_HOURS_EDIT*!*JOB_SUM@!@JOB_TOTAL_TIME*!*HOURS_ESTIMATED@!@EST_HOURS*!*HOURS_ACTUAL@!@ACT_HOURS*!*SUN2_HRS@!@SUNDAY2_HOURS_EDIT*!*MON2_HRS@!@MONDAY2_HOURS_EDIT*!*TUES2_HRS@!@TUESDAY2_HOURS_EDIT*!*WED2_HRS@!@WEDNESDAY2_HOURS_EDIT*!*THUR2_HRS@!@THURSDAY2_HOURS_EDIT*!*FRI2_HRS@!@FRIDAY2_HOURS_EDIT*!*SAT2_HRS@!@SATURDAY2_HOURS_EDIT*!*POTENTIAL_HOURS@!@P_HOURS")
V.Local.sSplit.Declare(String)

F.Intrinsic.String.Split(V.Local.sColumns, "*!*", V.Local.sColumns)
F.Intrinsic.Control.For(V.Local.iCounter, 0, V.Local.sColumns.UBound, 1)
	F.Intrinsic.String.Split(V.Local.sColumns(V.Local.iCounter), "@!@", V.Local.sSplit)
	F.Intrinsic.Control.For(V.Local.iJ, 0, V.DataTable.dtTimesheet.RowCount--, 1)
'		F.Intrinsic.Control.CallSub(CalculateTimeColumn, "ROW", V.Local.iJ, "COLUMN", V.Local.sSplit(0), "TARGET_COLUMN", V.Local.sSplit(1))
		F.Data.DataTable.SetValue("dtTimesheet",V.Local.iJ,V.Local.sSplit(1),V.DataTable.dtTimesheet(V.Local.iJ).[V.Local.sSplit]!FieldVal)
	F.Intrinsic.Control.Next(V.Local.iJ)
F.Intrinsic.Control.Next(V.Local.iCounter)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.CalculateAllTimeColumns.End

Program.Sub.cmdFrmTemp_Click.Start
F.Intrinsic.Control.Try

v.local.sSQL.Declare(string)
v.local.sMap.Declare(string)

F.Intrinsic.Control.If(v.Global.bAdminMode)
	V.Global.sUser.Set(v.Screen.FormTimesheet!txtUser.text)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.Global.sUser.Trim,=,"")
	F.Intrinsic.UI.Msgbox("No Employee Selected!","Select Employee")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select JOB, SUFFIX, SEQ,JOB + SUFFIX + SEQ AS JSS,JOB + SUFFIX AS JS,RTRIM(' ') as DESCRIPTION,RTRIM(WC) as WC,  CAST(0 AS DOUBLE) AS MON_HRS,CAST(' ' as LONGVARCHAR) as MON_NOTES, CAST(0 AS DOUBLE) AS TUES_HRS,CAST(' ' as LONGVARCHAR)  as TUES_NOTES, CAST(0 AS DOUBLE) AS WED_HRS,CAST(' ' as LONGVARCHAR)  as WED_NOTES, CAST(0 AS DOUBLE) AS THUR_HRS,CAST(' ' as LONGVARCHAR)  as THUR_NOTES, CAST(0 AS DOUBLE) AS FRI_HRS,CAST(' ' as LONGVARCHAR)  as FRI_NOTES, CAST(0 AS DOUBLE) AS SAT_HRS,CAST(' ' as LONGVARCHAR)  as SAT_NOTES,CAST(0 AS DOUBLE) AS SUN_HRS,CAST(' ' as LONGVARCHAR) as SUN_NOTES,CAST(0 AS DOUBLE) AS MON2_HRS,CAST(' ' as LONGVARCHAR) as MON2_NOTES, CAST(0 AS DOUBLE) AS TUES2_HRS,CAST(' ' as LONGVARCHAR)  as TUES2_NOTES, CAST(0 AS DOUBLE) AS WED2_HRS,CAST(' ' as LONGVARCHAR)  as WED2_NOTES, CAST(0 AS DOUBLE) AS THUR2_HRS,CAST(' ' as LONGVARCHAR)  as THUR2_NOTES, CAST(0 AS DOUBLE) AS FRI2_HRS,CAST(' ' as LONGVARCHAR)  as FRI2_NOTES, CAST(0 AS DOUBLE) AS SAT2_HRS,CAST(' ' as LONGVARCHAR)  as SAT2_NOTES,CAST(0 AS DOUBLE) AS SUN2_HRS,CAST(' ' as LONGVARCHAR) as SUN2_NOTES,CAST(0 AS BIT) AS UPDATED,CAST(0 AS BIT) AS FLAG_READY,CAST('      ' as VARCHAR) as SUN_NOTES,  CAST(0 AS DOUBLE) AS OVT_HRS from GCG_6873_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' and JSS not in (Select job + suffix + seq as JSS from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}') ORDER BY JOB,SUFFIX, SEQ",V.Global.sUser,v.Global.dDate.PervasiveDate,V.Local.sSql)

F.Data.DataTable.CreateFromSQL("TimeDT","con",V.Local.sSql,true)
F.Intrinsic.Control.If(v.DataTable.TimeDT.RowCount,=,0)
	F.Intrinsic.ui.Msgbox("There are no Jobs that can be added in from the template.")
	F.Data.DataTable.Close("TimeDT")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Data.DataTable.AddColumn("TimeDT","USER_ID","STRING")
F.Data.DataTable.SetValue("TimeDT",-1,"USER_ID",V.Global.sUser)

F.Data.DataTable.AddColumn("TimeDT","BEG_WEEK","STRING")
F.Data.DataTable.SetValue("TimeDT",-1,"BEG_WEEK",V.Global.dDate.PervasiveDate)
'v.Local.sMap.set("USER_ID@!@USER_ID*!*JOB@!@JOB*!*SUFFIX@!@SUFFIX*!*SEQ@!@SEQ*!*BEG_WEEK@!@BEG_WEEK*!*WC@!@WC*!*SUN_HRS@!@SUN_HRS*!*MON_HRS@!@MON_HRS*!*TUES_HRS@!@TUES_HRS*!*WED_HRS@!@WED_HRS*!*THUR_HRS@!@THUR_HRS*!*FRI_HRS@!@FRI_HRS*!*SAT_HRS@!@SAT_HRS*!*UPDATED@!@UPDATED*!*FLAG_READY@!@FLAG_READY")
v.Local.sMap.set("USER_ID@!@USER_ID*!*JOB@!@JOB*!*SUFFIX@!@SUFFIX*!*SEQ@!@SEQ*!*BEG_WEEK@!@BEG_WEEK*!*WC@!@WC*!*SUN_HRS@!@SUN_HRS*!*MON_HRS@!@MON_HRS*!*TUES_HRS@!@TUES_HRS*!*WED_HRS@!@WED_HRS*!*THUR_HRS@!@THUR_HRS*!*FRI_HRS@!@FRI_HRS*!*SAT_HRS@!@SAT_HRS*!*UPDATED@!@UPDATED*!*FLAG_READY@!@FLAG_READY*!*SUN_NOTES@!@SUN_NOTES*!*MON_NOTES@!@MON_NOTES*!*TUES_NOTES@!@TUES_NOTES*!*WED_NOTES@!@WED_NOTES*!*THUR_NOTES@!@THUR_NOTES*!*FRI_NOTES@!@FRI_NOTES*!*SAT_NOTES@!@SAT_NOTES*!*SUN2_HRS@!@SUN2_HRS*!*MON2_HRS@!@MON2_HRS*!*TUES2_HRS@!@TUES2_HRS*!*WED2_HRS@!@WED2_HRS*!*THUR2_HRS@!@THUR2_HRS*!*FRI2_HRS@!@FRI2_HRS*!*SAT2_HRS@!@SAT2_HRS*!*SUN2_NOTES@!@SUN2_NOTES*!*MON2_NOTES@!@MON2_NOTES*!*TUES2_NOTES@!@TUES2_NOTES*!*WED2_NOTES@!@WED2_NOTES*!*THUR2_NOTES@!@THUR2_NOTES*!*FRI2_NOTES@!@FRI2_NOTES*!*SAT2_NOTES@!@SAT2_NOTES*!*OVT_HRS@!@OVT_HRS")
Function.Data.DataTable.SaveToDB("TimeDT","con","GCG_6873_TIMSHT","USER_ID*!*JOB*!*SUFFIX*!*SEQ*!*BEG_WEEK",256,v.Local.sMap)

F.Data.DataTable.Close("TimeDT")

F.Intrinsic.Control.CallSub(GridLoad)
F.Intrinsic.Control.CallSub(GridTitle)
F.Intrinsic.Control.CallSub(ComputeTotals)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdFrmTemp_Click.End

Program.Sub.MessageBox.Start
'they wanted blue text on the message boxes
'so I had to make a seperate form for it

F.Intrinsic.Control.Try

V.Local.bYesAndNo.Declare(Boolean)
V.Local.sTitle.Declare(String)
V.Local.sMessage.Declare(String)

V.Local.bYesAndNo.Set(V.Args.YesAndNo)
V.Local.sTitle.Set(V.Args.Title)
V.Local.sMessage.Set(V.Args.Message)

F.Intrinsic.Control.If(V.Local.bYesAndNo)
	GUI.FormMessageBox.cmdMsgNo.Visible(True)
	GUI.FormMessageBox.cmdMsgNo.Position(4515, 1425)
	GUI.FormMessageBox.cmdMsgNo.Caption("No")
	GUI.FormMessageBox.cmdMsgYes.Visible(True)
	GUI.FormMessageBox.cmdMsgYes.Position(3390, 1425)
	GUI.FormMessageBox.cmdMsgYes.Caption("Yes")
F.Intrinsic.Control.Else
	GUI.FormMessageBox.cmdMsgNo.Visible(False)
	GUI.FormMessageBox.cmdMsgYes.Visible(True)
	GUI.FormMessageBox.cmdMsgYes.Position(4515, 1425)
	GUI.FormMessageBox.cmdMsgYes.Caption("OK")
F.Intrinsic.Control.EndIf

GUI.FormMessageBox..Caption(V.Local.sTitle)
GUI.FormMessageBox.lblMsgBox.Caption(V.Local.sMessage)

GUI.FormTimesheet..Enabled(False)
GUI.FormMessageBox..Show
GUI.FormMessageBox..WaitForDismiss
GUI.FormTimesheet..AlwaysOnTop(True)
GUI.FormTimesheet..AlwaysOnTop(False)
GUI.FormTimesheet..Enabled(True)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.MessageBox.End

Program.Sub.FormMessageBox_UnLoad.Start
F.Intrinsic.Control.Try

V.Global.sMessageBoxReturn.Set("NO")
GUI.FormMessageBox..Visible(False)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.FormMessageBox_UnLoad.End

Program.Sub.cmdMsgYes_Click.Start
F.Intrinsic.Control.Try

V.Global.sMessageBoxReturn.Set("YES")
GUI.FormMessageBox..Visible(False)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdMsgYes_Click.End

Program.Sub.cmdMsgNo_Click.Start
F.Intrinsic.Control.Try

V.Global.sMessageBoxReturn.Set("NO")
GUI.FormMessageBox..Visible(False)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdMsgNo_Click.End

Program.Sub.SetIcon.Start
F.Intrinsic.Control.Try

V.Local.sForm.Declare(String)
V.Local.bExists.Declare(Boolean)
V.Local.sIcon.Declare(String)
V.Local.iCounter.Declare(Long)

F.Intrinsic.String.Build("{0}\ART\gss2.ico",V.Caller.GlobalDir,v.Local.sIcon)
F.Intrinsic.File.Exists(V.Local.sIcon, V.Local.bExists)
F.Intrinsic.Control.If(V.Local.bExists.Not)
	F.Intrinsic.String.Build("{0}\GAB\GAS\gss2.ico",V.Caller.PluginsDir,v.Local.sIcon)
	F.Intrinsic.File.Exists(V.Local.sIcon, V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists.Not)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.UI.GetFormList(V.Local.sForm)
F.Intrinsic.String.Split(V.Local.sForm, "*!*", V.Local.sForm)

F.Intrinsic.Control.For(V.Local.iCounter, 0, V.Local.sForm.UBound, 1)
	GUI.[V.Local.sForm(V.Local.iCounter)]..Icon(V.Local.sIcon)
F.Intrinsic.Control.Next(V.Local.iCounter)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.SetIcon.End

Program.Sub.ErrorMessage.Start
'basic error message for replacing catch block
'this is really just for when printing the message and ending program
'pass error number, error description, current subroutine
'optional callback sub, this will be called before ending

F.Intrinsic.Control.Try

V.Local.iError.Declare(Long)
V.Local.sErrorDescription.Declare(String)
V.Local.sSubroutine.Declare(String)
V.Local.sError.Declare(String)
V.Local.bExists.Declare(Boolean)
V.Local.sCallback.Declare(String)
V.Static.bError.Declare(Boolean, False)

V.Local.iError.Set(V.Args.ErrorNumber)
V.Local.sErrorDescription.Set(V.Args.ErrorDescription)
V.Local.sSubroutine.Set(V.Args.Subroutine)

'make sure we aren't in an error loop
F.Intrinsic.Control.If(V.Static.bError)
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndIf
V.Static.bError.Set(True)

F.Intrinsic.String.Build("{6}{1}Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}", V.Caller.ScriptFile, V.Ambient.Newline, V.Local.sSubroutine, V.Local.iError, V.Local.sErrorDescription, V.Ambient.GABVersion, V.Ambient.Now, V.Local.sError)
F.Intrinsic.UI.Msgbox(V.Local.sError)

F.Intrinsic.Variable.ArgExists("Callback", V.Local.bExists)
F.Intrinsic.Control.If(V.Local.bExists)
	V.Local.sCallback.Set(V.Args.Callback.Trim)
	F.Intrinsic.Control.CallSub(V.Local.sCallback)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.End

F.Intrinsic.Control.Catch
	F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Caller.ScriptFile,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndTry
Program.Sub.ErrorMessage.End

Program.Sub.LoadJobTime.Start
F.Intrinsic.Control.Try

V.Local.sSQL.Declare(String)
V.Local.dStartDate.Declare(Date)
V.Local.dEndDate.Declare(Date)
V.Local.sEmployee.Declare(String)
V.Local.sRet.Declare(String)
V.Local.fHours.Declare(Float)
V.Local.sHours.Declare(String)

'get employee
F.Intrinsic.Control.If(v.Global.bAdminMode)
	V.Local.sEmployee.Set(V.Screen.FormTimesheet!txtEmployee.Text.Trim)
F.Intrinsic.Control.Else
	F.Global.Security.GetEmpNoFromUser(V.Global.sUser, V.Local.sEmployee)
	F.Intrinsic.Control.If(V.Local.sEmployee.IsNoReturn)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

'get date range
V.Local.dStartDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)
F.Intrinsic.Date.DateAdd("D", 6, V.Local.dStartDate, V.Local.dEndDate)

F.Intrinsic.String.Build("select SUM(HOURS_WORKED) TOTAL_HOURS from V_JOB_DETAIL where EMPL = '{0}' and CHARGE_DATE between '{1}' and '{2}' group by EMPL", V.Local.sEmployee, V.Local.dStartDate.PervasiveDate, V.Local.dEndDate.PervasiveDate, V.Local.sSQL)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSQL, V.Local.sRet)
F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
	V.Local.fHours.Set(0)
F.Intrinsic.Control.Else
	V.Local.fHours.Set(V.Local.sRet.Float)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fHours)
GUI.FormTimesheet.txtGUIHours.Text(V.Args.Time)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.LoadJobTime.End

Program.Sub.txtUser_LostFocus.Start
F.Intrinsic.Control.Try

V.Local.sUser.Declare(String)
V.Local.sEmployee.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.sRet.Declare(String)

F.Intrinsic.Control.If(V.Screen.FormTimesheet!txtUser.Text.Trim, !=, "")
	V.Local.sUser.Set(V.Screen.FormTimesheet!txtUser.Text.Trim)
	V.Local.sUser.Set(V.Local.sUser.UCase)

	F.Intrinsic.String.Build("select RTRIM(GS_USER) from USER_INFORMATION where GS_USER = '{0}'", V.Local.sUser, V.Local.sSQL)
	F.ODBC.Connection!Comm.OpenCommonConnection
	F.ODBC.Connection!Comm.ExecuteAndReturn(V.Local.sSQL, V.Local.sRet)
	F.ODBC.Connection!Comm.Close
	
	F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
		F.Intrinsic.UI.Msgbox("Invalid user entered.")
		GUI.FormTimesheet.txtUser.Text("")
		GUI.FormTimesheet.txtEmployee.Text("")
	F.Intrinsic.Control.Else
		F.Global.Security.GetEmpNoFromUser(V.Local.sUser, V.Local.sEmployee)
		F.Intrinsic.Control.If(V.Local.sEmployee.IsNotNoReturn)
			GUI.FormTimesheet.txtEmployee.Text(V.Local.sEmployee)
		F.Intrinsic.Control.Else
			GUI.FormTimesheet.txtEmployee.Text("")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.txtUser_LostFocus.End

Program.Sub.cmdAddNotes_Click.Start
F.Intrinsic.Control.Try
	gui.F_newNotes..Visible(True)
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdAddNotes_Click.End

Program.Sub.F_newNotes_UnLoad.Start
F.Intrinsic.Control.Try
	gui.F_newNotes..Visible(False)
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.F_newNotes_UnLoad.End

Program.Sub.cmdNotesOk_Click.Start
F.Intrinsic.Control.Try
	gui.F_newNotes..Visible(False)
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdNotesOk_Click.End

Program.Sub.cmd_newOKLine_Click.Start
v.Local.sNotes.Declare
f.Intrinsic.Control.Try
'Try something
	v.Local.sNotes.Set(v.Screen.F_New_Line!txt1.Text)
	gui.FormTimesheet.gsgcTimesheet.SetCellValueByColumnName("gvTimesheet", "JOB_NOTES", v.Global.iRowId, v.Local.sNotes)
	gui.F_New_Line.txt1.Text("")
	gui.F_New_Line..Visible(False)
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmd_newOKLine_Click.End

Program.Sub.F_New_Line_UnLoad.Start
F.Intrinsic.Control.Try
	gui.F_New_Line.txt1.Text("")
	gui.F_New_Line..Visible(False)
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.F_New_Line_UnLoad.End

Program.Sub.ddlDateSelect_SelectedIndexChanged.Start
F.Intrinsic.Control.Try
	Gui.FormTimesheet.dtpWeek.Value(V.Screen.FormTimesheet!ddlDateSelect.Text)
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.ddlDateSelect_SelectedIndexChanged.End

Program.Sub.Get_PayPeriod.Start
F.Intrinsic.Control.Try

V.Local.sRet.Declare(String)
V.Local.bRet.Declare(Boolean,False)
V.Local.dNewYear.Declare(Date)
V.Local.bUpdate.Declare(Boolean,True)
V.Local.sDate.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.iIndex.Declare(Long,0)
V.Local.iEnd.Declare(Long,0)

Gui.FormTimeAdjust.ddlReason.AddItem(" ",0)
Gui.FormTimeAdjust.ddlReason.AddItem("Extra Time Worked",1)
Gui.FormTimeAdjust.ddlReason.AddItem("New Workorder or Project Number",2)
Gui.FormTimeAdjust.ddlReason.AddItem("Hours in Wrong Day",3)
Gui.FormTimeAdjust.ddlReason.AddItem("Hours on wrong Job",4)
Gui.FormTimeAdjust.ddlReason.AddItem("Hours Reported Wrong",5)
Gui.FormTimeAdjust.ddlReason.AddItem("Other – Explain",6)

F.ODBC.Connection!con.OpenCompanyConnection
F.Data.DataTable.CreateFromSQL("Reason",con,"Select Rec_No, User_ID, Job, Suffix, Seq, Date_Change, Date_Record, Reason, Note, Previous_Hrs, New_Hrs, Chg_By From GCG_6873_Rec_Change Where Rec_No = -1",True)

F.Data.Dictionary.CreateFromSQL("PrevWeek",con,"Select Distinct Beg_Week, Beg_Week From GCG_6873_TIMSHT Where BEG_WEEK <> (Select Top 1 BEG_WEEK From GCG_6873_TIMSHT Order by BEG_WEEK DESC) Order By BEG_WEEK DESC")

F.ODBC.Connection!con.Close

F.Global.Registry.ReadValue("SUPERVSR",V.Caller.CompanyCode,"TimeSheet_Inc",6873,1000,6,"",V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	V.Global.iIncr.Set(V.Local.sRet.Long)
F.Intrinsic.Control.Else
	V.Global.iIncr.Set(0)
F.Intrinsic.Control.EndIf

F.Global.Registry.ReadValue("SUPERVSR",V.Caller.CompanyCode,"TimeSheet_Inc",6873,1000,3,"",V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.Control.If(V.DataTable.PayPeriods.Exists)
		F.Data.DataTable.Close("PayPeriods")
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.Create("PayPeriods",True)
	F.Data.DataTable.AddColumn("PayPeriods","Start",Date)
	F.Data.DataTable.AddColumn("PayPeriods","End",Date)
	F.Data.DataTable.AddColumn("PayPeriods","Current",Boolean)
	V.Global.dStart.Set(V.Local.sRet)
	F.Intrinsic.Date.DateAdd("YYYY",1,V.Global.dStart,V.Local.dNewYear)
	F.Intrinsic.Date.DateAdd("D",13,V.Global.dStart,V.Global.dEnd)
	F.Data.DataTable.AddRow("PayPeriods","Start",V.Global.dStart,"End",V.Global.dEnd,"Current",False)
	F.Intrinsic.Control.DoUntil(V.Local.bRet)
		F.Intrinsic.Control.If(V.Ambient.Date,>=,V.Global.dStart,"AND",V.Ambient.Date,<=,V.Global.dEnd)
			F.Data.DataTable.SetValue("PayPeriods",V.DataTable.PayPeriods.RowCount--,"Current",True)
			V.Local.bRet.Set(True)
		F.Intrinsic.Control.Else
			F.Intrinsic.Date.DateAdd("D",1,V.Global.dEnd,V.Global.dStart)
			F.Intrinsic.Date.DateAdd("D",13,V.Global.dStart,V.Global.dEnd)
			F.Data.DataTable.AddRow("PayPeriods","Start",V.Global.dStart,"End",V.Global.dEnd,"Current",False)
			F.Intrinsic.Control.If(V.Global.dStart,>=,V.Local.dNewYear)
				F.Intrinsic.Control.If(V.Local.bUpdate,=,True)
					V.Local.bUpdate.Set(False)
					F.Intrinsic.String.Format(V.Global.dStart,"MM/DD/YYYY",V.Local.sDate)
					F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"TimeSheet_Inc",6873,1000,False,"TimeSheet_Inc",False,0,-999.0,V.Local.sDate,12:00:00 AM,V.Global.iIncr)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Loop
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Payroll Start Date has not been setup.  Contact your Admin","Attention")
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndIf

Gui.FormTimesheet.ddlPrevWeek.ClearItems
Gui.FormTimesheet.ddlPrevWeek.AddItems(Dictionary,"PrevWeek")

F.Data.Dictionary.Close("PrevWeek")

F.Intrinsic.Control.If(V.DataTable.PayPeriods.RowCount,>,1)
	F.Intrinsic.Math.Sub(V.DataTable.PayPeriods.RowCount--,1,V.Local.iEnd)
	F.Intrinsic.Control.For(V.Local.i,V.DataTable.PayPeriods.RowCount--,V.Local.iEnd,-1)
		F.Intrinsic.String.Format(V.DataTable.PayPeriods(V.Local.i).Start!FieldVal,"MM/DD/YYYY",V.Local.sDate)
		Gui.FormTimesheet.ddlDateSelect.AddItem(V.Local.sDate,V.Local.iIndex)
		F.Intrinsic.Math.Add(V.Local.iIndex,1,V.Local.iIndex)
	F.Intrinsic.Control.Next(V.Local.i)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Format(V.DataTable.PayPeriods(V.DataTable.PayPeriods.RowCount--).Start!FieldVal,"MM/DD/YYYY",V.Local.sDate)
	Gui.FormTimesheet.ddlDateSelect.AddItem(V.Local.sDate,0)
F.Intrinsic.Control.EndIf
'F.Intrinsic.String.Format(V.Global.dStart,"MM/DD/YYYY",V.Local.sDate)
'Gui.FormTimesheet.ddlDateSelect.AddItem(V.Local.sDate,0)
'F.Intrinsic.Date.DateAdd("D",7,V.Global.dStart,V.Local.dNewYear)
'F.Intrinsic.String.Format(V.Local.dNewYear,"MM/DD/YYYY",V.Local.sDate)
'Gui.FormTimesheet.ddlDateSelect.AddItem(V.Local.sDate,1)

F.Intrinsic.Control.If(V.Ambient.Date,<,V.Local.dNewYear)
	F.Intrinsic.String.Format(V.Global.dStart,"MM/DD/YYYY",V.Local.sDate)
F.Intrinsic.Control.EndIf

Gui.FormTimesheet.ddlDateSelect.Text(V.Local.sDate)
V.Global.bCurrent.Set(True)

F.Global.Security.GetEmpNoFromUser(V.Caller.User, V.Global.sEmployee)
F.Intrinsic.Control.If(V.Global.sEmployee.IsNoReturn)
	F.Intrinsic.String.Build("Employee ID can't be found for User: {0}. Contact your Admin.",V.Caller.User,V.Local.sMsg)
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Attention")
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.Get_PayPeriod.End

Program.Sub.FormTimeAdjust_UnLoad.Start
F.Intrinsic.Control.Try

Gui.FormTimeAdjust..Visible(False)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.FormTimeAdjust_UnLoad.End

Program.Sub.cmdUpdate_Click1.Start
F.Intrinsic.Control.Try
V.Local.sRet.Declare(String)
V.Local.sNote.Declare(String)
V.Local.iRet.Declare(Long)
V.Local.sMsg.Declare(String)
V.Local.sMin.Declare(String)
V.Local.sHour.Declare(String)
V.Local.fIncDec.Declare(Float)

V.Local.sRet.Set(V.Screen.FormTimeAdjust!ddlReason.Text)
V.Local.sNote.Set(V.Screen.FormTimeAdjust!txtNote.Text)

F.Intrinsic.Control.If(V.Local.sRet.Trim,=,"")
	F.Intrinsic.UI.Msgbox("Reason must be Seleted...","Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Local.sRet.Trim,=,"Other - Explain","AND",V.Local.sNote.Trim,=,"")
		F.Intrinsic.UI.Msgbox("Note must be Entered...","Attention")
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

V.Local.sHour.Set(V.Screen.FormTimeAdjust!txtHour.Text)
F.Intrinsic.Control.If(V.Local.sHour.Trim,=,"")
	Gui.FormTimeAdjust.txtHour.Text("0")
F.Intrinsic.Control.EndIf
'V.Local.sMin.Set(V.Screen.FormTimeAdjust!txtMin.Text)
'F.Intrinsic.Control.If(V.Local.sMin.Trim,=,"")
'	Gui.FormTimeAdjust.txtMin.Text("00")
'F.Intrinsic.Control.EndIf
'F.Intrinsic.Math.Mod(V.Local.sMin.Long,V.Global.iIncr,V.Local.iRet)
F.Intrinsic.String.Format(V.Local.sHour,"#0.00",V.Local.sHour)
F.Intrinsic.String.Split(V.Local.sHour,".",V.Local.sHour)
F.Intrinsic.Math.Div(V.Global.iIncr,60,V.Local.fIncDec)
F.Intrinsic.Math.Mult(V.Local.fIncDec,100,V.Local.fIncDec)
F.Intrinsic.Math.Mod(V.Local.sHour(1).Long,V.Local.fIncDec.Long,V.Local.iRet)
	
F.Intrinsic.Control.If(V.Local.iRet,<>,0)
	F.Intrinsic.String.Build("Time Data Must in increments of .{0}",V.Local.fIncDec.Long,V.Local.sMsg)
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

V.Global.bUpdate.Set(True)

F.Intrinsic.Control.CallSub(FormTimeAdjust_UnLoad)
		
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdUpdate_Click1.End

Program.Sub.cmdView_Click.Start
F.Intrinsic.Control.Try

F.Intrinsic.Control.CallSub(Get_Prev_Data)

Gui.FormPrev..Show

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdView_Click.End

Program.Sub.cmdPrevPrint_Click.Start
F.Intrinsic.Control.Try
V.Local.sSQL.Declare(String)
V.Local.iRPTID.Declare(Long)
V.Local.sParam.Declare(String)
V.Local.sVals.Declare(String)
V.Local.sRet.Declare(String)
V.Local.dDate.Declare(Date)

Gui.FormPrev.cmdPrevPrint.Enabled(False)

V.Local.dDate.Set(V.Screen.FormTimesheet!ddlPrevWeek.Value)

V.Local.sParam.Set("START_DATE*!*BIRUNID*!*GUI_HOURS*!*BALANCE_HOURS*!*HOURS_TA")

F.Intrinsic.UI.InvokeWaitDialog("Printing Report...")

F.global.BI.GetIDFromName("GCG_6873_Timesheet.rpt",V.Local.iRPTID)

F.Intrinsic.Control.If(V.Local.iRPTID,=,-1)
	F.Intrinsic.UI.CloseWaitDialog
	F.Intrinsic.UI.Msgbox("GCG_6873_Timesheet.rpt not found as an active report. Please Activate within Report Maintenance")
	Gui.FormPrev.cmdPrevPrint.Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.BlockEvents

F.Global.BI.GetRunID(V.Global.iBIRUNID)
F.Global.BI.StartLogging(V.Global.iBIRUNID,V.Local.iRptID,-1,"",V.Global.iLogID)
F.Intrinsic.String.Build("{0}*!*{1}*!*{2}*!*{3}*!*{4}",V.Local.dDate.formatYYYYMMDD,V.Global.iBIRUNID, "0.00", "0.00", "0.00", V.Local.sVals)

'ask user in admin mode if they want to print all ready recrods for all employees or just employee selected.
F.Intrinsic.Control.If(V.Global.bAdminMode,=,True)
	'Print Records for all or just selected.")
	F.Intrinsic.UI.Msgbox("Print ready time for ALL employees?","All Employees?",4,V.Local.sRet)
F.Intrinsic.Control.EndIf

'so we have to figure out if it's for all users or employee selected.
'we can only print the users ready time

F.Intrinsic.Control.If(V.Local.sRet.Long,=,6)
	'tey want all users.
	F.Intrinsic.String.Build("select UPPER(USER_ID) AS USER_ID,E.Employee,E.Name,GCG.Job,GCG.Suffix,GCG.Seq as SEQUENCE,JO.Description,WC,Sun_HRS,Mon_HRS,Tues_HRS,WED_HRS,THUR_HRS, FRI_HRS,SAT_HRS, Sun2_HRS,Mon2_HRS,Tues2_HRS,WED2_HRS,THUR2_HRS, FRI2_HRS,SAT2_HRS, JOB_NOTES from GCG_6873_TIMSHT As GCG Left Join V_Employee_Mstr As E On GCG.USER_ID = E.PR_USER_ID Left Join V_Job_Operations AS JO On GCG.Job = JO.Job And GCG.Suffix = JO.Suffix and GCG.Seq = JO.SEQ Where Flag_Ready = '1' And BEG_WEEK = '{0}' ",V.Local.dDate.Pervasivedate,V.Local.sSQL)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("select UPPER(USER_ID) AS USER_ID,E.Employee,E.Name,GCG.Job,GCG.Suffix,GCG.Seq as SEQUENCE,JO.Description,WC,Sun_HRS,Mon_HRS,Tues_HRS,WED_HRS,THUR_HRS, FRI_HRS,SAT_HRS, Sun2_HRS,Mon2_HRS,Tues2_HRS,WED2_HRS,THUR2_HRS, FRI2_HRS,SAT2_HRS, JOB_NOTES from GCG_6873_TIMSHT As GCG Left Join V_Employee_Mstr As E On GCG.USER_ID = E.PR_USER_ID Left Join V_Job_Operations AS JO On GCG.Job = JO.Job And GCG.Suffix = JO.Suffix and GCG.Seq = JO.SEQ Where GCG.USER_ID ='{0}' And BEG_WEEK = '{1}' ",V.Global.sUser,V.Local.dDate.Pervasivedate,V.Local.sSQL)
F.Intrinsic.Control.EndIf

F.Data.DataTable.CreateFromSQL("DTGetData","con",v.Local.sSQL)
F.Intrinsic.Control.if(v.DataTable.DTGetData.RowCount,=,0)
	F.Intrinsic.UI.Msgbox("There are no records made ready for printing.")
	F.Data.DataTable.Close("DTGetData")
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.UI.CloseWaitDialog
	Gui.FormTimesheet.cmdPrint.Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("Select * from GCG_6873_TIMESHT_BI where BIRUNID = '{0}'",V.Global.iBIRUNID,v.Local.sSQL)
	F.data.DataTable.CreateFromSQL("DTBiUpload","con",v.Local.sSQL)
'	F.Data.DataTable.RemoveColumn("DTGetData","USER_ID")
	F.Data.DataTable.AddColumn("DTGetData","BIRUNID","Long")
	F.Data.DataTable.SetValue("DTGetData",-1,"BIRUNID",V.Global.iBIRUNID)
	F.Data.datatable.Merge("DTGetData","DTBiUpload",false,2)
	F.Data.DataTable.Close("DTGetData")

	F.Intrinsic.Control.If(V.DataTable.DTBiUpload.RowCount,>,0)
		F.ODBC.Connection!con.Execute("Delete From GCG_6873_TIMESHT_BI")
		F.Data.DataTable.SaveToDB("DTBiUpload","con","GCG_6873_TIMESHT_BI","BIRUNID",128)
		F.Data.DataTable.Close("DTBiUpload")
	
		F.Global.BI.RunReportPreProcessor(V.Global.iBIRUNID,V.Global.iLogID,V.Local.sParam,V.Local.sVals,"",-1,False,"",-1,"",-1,"","",V.Global.iBIRUNID)

	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.endif

F.Intrinsic.UI.CloseWaitDialog

Gui.FormPrev.cmdPrevPrint.Enabled(True)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdPrevPrint_Click.End

Program.Sub.FormPrev_UnLoad.Start
F.Intrinsic.Control.Try
V.Local.sSerialize.Declare(String,"")
V.Local.sSql.Declare(String,"")

F.Intrinsic.Control.If(V.DataTable.PrevSheet.Exists)
	F.ODBC.Connection!ConC.OpenCommonConnection
	F.Intrinsic.String.Build("Delete From GS_REGISTRY where program = 'TIMESHEETVIEW' and REG_ID = 6873 and Seq < 4000 and Company = '{0}'",V.Caller.CompanyCode,V.Local.sSql)
	F.ODBC.Connection!conC.Execute(V.Local.sSql)
	F.ODBC.Connection!ConC.Close

	GUI.FormPrev.GsGridPrev.Serialize("GPrev", V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User, V.Caller.CompanyCode, "TimeSheetView", 6873, 4000, False, "Serialize", False, 0, -999.0 , 1/1/1980, 12:00:00 AM, V.Local.sSerialize)

	F.Data.DataTable.Close("PrevSheet")
F.Intrinsic.Control.EndIf

Gui.FormPrev..Visible(False)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.FormPrev_UnLoad.End

Program.Sub.Get_Prev_Data.Start
F.Intrinsic.Control.Try
V.Local.dDate.Declare(Date)
V.Local.bRet.Declare(Boolean,False)
V.Local.sSql.Declare(String,"")

F.Intrinsic.Control.If(V.Screen.FormTimesheet!ddlPrevWeek.Value,<>,"")
	V.Local.dDate.Set(V.Screen.FormTimesheet!ddlPrevWeek.Value)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Select Prev Pay Period")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Data.Dictionary.Exists("DescDict",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("DescDict")
F.Intrinsic.Control.EndIf
F.data.dictionary.CreateFromSQL("DescDict","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,DESCRIPTION from V_JOB_HEADER ")
F.Data.Dictionary.SetDefaultReturn("DescDict","")

F.Data.Dictionary.Exists("FGDict",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("FGDict")
F.Intrinsic.Control.EndIf
F.data.dictionary.CreateFromSQL("FGDict","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,PART from V_JOB_HEADER ")
F.Data.Dictionary.SetDefaultReturn("FGDict","")

F.Data.Dictionary.Exists("dictSeqDesc",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("dictSeqDesc")
F.Intrinsic.Control.EndIf
F.Data.Dictionary.CreateFromSQL("dictSeqDesc", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(DESCRIPTION) as DESCRIPTION from V_JOB_OPERATIONS where LMO = 'L'")
F.Data.Dictionary.SetDefaultReturn("dictSeqDesc", "")

F.Data.Dictionary.Exists("FGDate",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("FGDate")
F.Intrinsic.Control.EndIf
F.data.dictionary.CreateFromSQL("FGDate","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,Date_Due from V_JOB_HEADER ")
F.Data.Dictionary.SetDefaultReturn("FGDate","01/01/1900")

F.Data.Dictionary.Exists("dictEstHours",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("dictEstHours")
F.Intrinsic.Control.EndIf
F.Data.Dictionary.CreateFromSQL("dictEstHours", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, Hours_Estimated from V_JOB_OPERATIONS where LMO = 'L'")
F.Data.Dictionary.SetDefaultReturn("dictEstHours", "0.00")
F.Data.Dictionary.Exists("dictActHours",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("dictActHours")
F.Intrinsic.Control.EndIf
F.Data.Dictionary.CreateFromSQL("dictActHours", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, Hours_Actual from V_JOB_OPERATIONS where LMO = 'L'")
F.Data.Dictionary.SetDefaultReturn("dictActHours", "0.00")
F.Data.Dictionary.Exists("LSEQ",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("LSEQ")
F.Intrinsic.Control.EndIf
F.Data.Dictionary.CreateFromSQL("LSEQ", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(FLAG_CLOSED) as FLAG_CLOSED from V_JOB_OPERATIONS where LMO = 'L' and FLAG_CLOSED = 'Y'")
F.Data.Dictionary.SetDefaultReturn("LSEQ", "N")
F.Data.Dictionary.Exists("JHOLD",V.Local.bRet)
F.Intrinsic.Control.If(V.Local.bRet)
	F.Data.Dictionary.Close("JHOLD")
F.Intrinsic.Control.EndIf
F.data.dictionary.CreateFromSQL("JHOLD","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,Flag_Hold from V_JOB_HEADER Where Flag_Hold = 'Y'")
F.Data.Dictionary.SetDefaultReturn("JHOLD","N")

F.Intrinsic.Control.If(V.DataTable.PrevSheet.Exists)
	F.Intrinsic.Control.If(V.Global.bAdminMode,=,False)
		F.Intrinsic.String.Build("Select USER_ID, RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,CAST(0 AS DOUBLE) AS HOURS_ESTIMATED, CAST(0 AS DOUBLE) AS HOURS_ACTUAL,SUN_HRS,SUN_NOTES, MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN2_HRS,SUN2_NOTES, MON2_HRS,MON2_NOTES, TUES2_HRS,TUES2_NOTES, WED2_HRS,WED2_NOTES, THUR2_HRS,THUR2_NOTES, FRI2_HRS,FRI2_NOTES, SAT2_HRS,SAT2_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper, JOB_NOTES, OVT_HRS from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}'",V.Global.sUser,V.Local.dDate.PervasiveDate,V.Local.sSql)
		F.DATA.DataTable.CreateFromSQL("TempPrevSheet","con",V.Local.sSql,true)
			
	F.Intrinsic.Control.Else
		V.Local.sSql.Set(V.Screen.FormTimesheet!txtUser.Text)
		
		F.Intrinsic.Control.If(V.Local.sSql.Trim,<>,"")
			F.Intrinsic.String.Build("Select USER_ID, RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,CAST(0 AS DOUBLE) AS HOURS_ESTIMATED, CAST(0 AS DOUBLE) AS HOURS_ACTUAL,SUN_HRS,SUN_NOTES, MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN2_HRS,SUN2_NOTES, MON2_HRS,MON2_NOTES, TUES2_HRS,TUES2_NOTES, WED2_HRS,WED2_NOTES, THUR2_HRS,THUR2_NOTES, FRI2_HRS,FRI2_NOTES, SAT2_HRS,SAT2_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper, JOB_NOTES, OVT_HRS from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}'",V.Local.sSql,V.Local.dDate.PervasiveDate,V.Local.sSql)
			F.DATA.DataTable.CreateFromSQL("TempPrevSheet","con",V.Local.sSql,true)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("Select USER_ID, RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,CAST(0 AS DOUBLE) AS HOURS_ESTIMATED, CAST(0 AS DOUBLE) AS HOURS_ACTUAL,SUN_HRS,SUN_NOTES, MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN2_HRS,SUN2_NOTES, MON2_HRS,MON2_NOTES, TUES2_HRS,TUES2_NOTES, WED2_HRS,WED2_NOTES, THUR2_HRS,THUR2_NOTES, FRI2_HRS,FRI2_NOTES, SAT2_HRS,SAT2_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper, JOB_NOTES, OVT_HRS from GCG_6873_TIMSHT where BEG_WEEK = '{0}'",V.Local.dDate.PervasiveDate,V.Local.sSql)
			F.DATA.DataTable.CreateFromSQL("TempPrevSheet","con",V.Local.sSql,true)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.DeleteRow("PrevSheet")
	F.Data.DataTable.AcceptChanges("PrevSheet")
	F.Data.DataTable.Merge("TempPrevSheet","PrevSheet",False,2)
	F.Data.DataTable.Close("TempPrevSheet")
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Global.bAdminMode,=,False)
		F.Intrinsic.String.Build("Select USER_ID, RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,CAST(0 AS DOUBLE) AS HOURS_ESTIMATED, CAST(0 AS DOUBLE) AS HOURS_ACTUAL,SUN_HRS,SUN_NOTES, MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN2_HRS,SUN2_NOTES, MON2_HRS,MON2_NOTES, TUES2_HRS,TUES2_NOTES, WED2_HRS,WED2_NOTES, THUR2_HRS,THUR2_NOTES, FRI2_HRS,FRI2_NOTES, SAT2_HRS,SAT2_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper, JOB_NOTES, OVT_HRS from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}'",V.Global.sUser,V.Local.dDate.PervasiveDate,V.Local.sSql)
		F.DATA.DataTable.CreateFromSQL("PrevSheet","con",V.Local.sSql,true)
			
	F.Intrinsic.Control.Else
		V.Local.sSql.Set(V.Screen.FormTimesheet!txtUser.Text)
		
		F.Intrinsic.Control.If(V.Local.sSql.Trim,<>,"")
			F.Intrinsic.String.Build("Select USER_ID, RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,CAST(0 AS DOUBLE) AS HOURS_ESTIMATED, CAST(0 AS DOUBLE) AS HOURS_ACTUAL,SUN_HRS,SUN_NOTES, MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN2_HRS,SUN2_NOTES, MON2_HRS,MON2_NOTES, TUES2_HRS,TUES2_NOTES, WED2_HRS,WED2_NOTES, THUR2_HRS,THUR2_NOTES, FRI2_HRS,FRI2_NOTES, SAT2_HRS,SAT2_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper, JOB_NOTES, OVT_HRS from GCG_6873_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}'",V.Local.sSql,V.Local.dDate.PervasiveDate,V.Local.sSql)
			F.DATA.DataTable.CreateFromSQL("PrevSheet","con",V.Local.sSql,true)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("Select USER_ID, RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,CAST(0 AS DOUBLE) AS HOURS_ESTIMATED, CAST(0 AS DOUBLE) AS HOURS_ACTUAL,SUN_HRS,SUN_NOTES, MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN2_HRS,SUN2_NOTES, MON2_HRS,MON2_NOTES, TUES2_HRS,TUES2_NOTES, WED2_HRS,WED2_NOTES, THUR2_HRS,THUR2_NOTES, FRI2_HRS,FRI2_NOTES, SAT2_HRS,SAT2_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper, JOB_NOTES, OVT_HRS from GCG_6873_TIMSHT where BEG_WEEK = '{0}'",V.Local.dDate.PervasiveDate,V.Local.sSql)
			F.DATA.DataTable.CreateFromSQL("PrevSheet","con",V.Local.sSql,true)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.AddColumn("PrevSheet", "ACT_HOURS", "String", "0.00")
	F.Data.DataTable.AddColumn("PrevSheet", "EST_HOURS", "String", "0.00")
	F.Data.DataTable.AddColumn("PrevSheet", "Due_Date", "Date")
	F.Data.DataTable.AddColumn("PrevSheet", "SEQ_CLOSED", "String")
	F.Data.DataTable.AddColumn("PrevSheet", "FLAG_Hold", "String")
	F.Data.DataTable.AddColumn("PrevSheet", "SEQ_DESCRIPTION", "String")
	
	F.Data.DataTable.AddExpressionColumn("PrevSheet", "JOB_SUM", "Float", "MON_HRS + TUES_HRS + WED_HRS + THUR_HRS + FRI_HRS + SAT_HRS + SUN_HRS + MON2_HRS + TUES2_HRS + WED2_HRS + THUR2_HRS + FRI2_HRS + SAT2_HRS + SUN2_HRS")
	F.Data.DataTable.AddExpressionColumn("PrevSheet", "POTENTIAL_HOURS", "Float", "IIF(UPDATED = 0,JOB_SUM+HOURS_ACTUAL,HOURS_ACTUAL)")

	F.Intrinsic.Control.CallSub(Set_Prev_Prop)
F.Intrinsic.Control.EndIf

F.Data.Datatable.FillFromDictionary("PrevSheet","DescDict","JS","Description")
F.Data.Datatable.FillFromDictionary("PrevSheet","FGDict","JS","Part")
F.Data.Datatable.FillFromDictionary("PrevSheet","dictSeqDesc", "JSS", "SEQ_DESCRIPTION")
F.Data.Datatable.FillFromDictionary("PrevSheet","dictActHours", "JSS", "Hours_Actual")
F.Data.Datatable.FillFromDictionary("PrevSheet","dictEstHours", "JSS", "Hours_Estimated")

F.Data.DataView.Create("PrevSheet","timeTemp",22,"OVT_HRS is Null","")
F.Data.DataView.SetValue("PrevSheet","timeTemp",-1,"OVT_HRS","0.00")
F.Data.DataView.Close("PrevSheet","timeTemp")

F.Data.DataTable.FillFromDictionary("PrevSheet","FGDate","JS","Due_Date")
F.Data.DataTable.FillFromDictionary("PrevSheet","LSEQ","JSS","SEQ_CLOSED")
F.Data.DataTable.FillFromDictionary("PrevSheet","JHOLD","JS","FLAG_Hold")

F.Intrinsic.Control.CallSub(Set_Prev_Cap)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.Get_Prev_Data.End

Program.Sub.Set_Prev_Prop.Start
F.Intrinsic.Control.Try
V.Local.sSerialize.Declare(String,"")

Gui.FormPrev.GsGridPrev.AddGridviewFromDatatable("GPrev","PrevSheet")
Gui.FormPrev.GsGridPrev.SetGridviewProperty("GPrev","Editable",False)
Gui.FormPrev.GsGridPrev.SetGridviewProperty("GPrev","ReadOnly",True)

GUI.FormPrev.GsGridPrev.SetGridviewProperty("GPrev","OptionsViewRowAutoHeight",False)
GUI.FormPrev.GsGridPrev.SetGridviewProperty("GPrev", "OptionsViewColumnAutoWidth", False)
GUI.FormPrev.GsGridPrev.SetGridviewProperty("GPrev","OptionsSelectionEnableAppearanceFocusedRow",False)
GUI.FormPrev.GsGridPrev.SetGridviewProperty("GPrev","OptionsViewShowAutoFilterRow",True)
GUI.FormPrev.GsGridPrev.SetGridviewProperty("GPrev","ColumnPanelRowHeight",40)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "Due_Date", "Visible", False)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "Due_Date", "AllowShowHide", False)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB_NOTES","caption","Job Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB_NOTES","MinWidth", 70)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB_NOTES", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JSS","visible","false")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JS","visible","false")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","User_ID","visible","false")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","User_ID","AllowShowHide","False")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Wrapper","visible","False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Wrapper","AllowShowHide","False")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FLAG_READY","Caption", "Ready")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FLAG_READY","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FLAG_READY","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FLAG_READY","visible",True)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FLAG_READY","Fixed","Right")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "FLAG_READY", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","UPDATED","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","UPDATED","Caption", "Updated")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","UPDATED","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","UPDATED","visible","True")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","UPDATED","MinWidth", 60)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","UPDATED","Fixed","Right")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "UPDATED", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB","caption","Job")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB","MinWidth", 50)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB","Fixed", "Left")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "JOB", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","EST_HOURS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","EST_HOURS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","EST_HOURS","caption","Est. Hours")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","EST_HOURS","MinWidth", 70)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "EST_HOURS", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","ACT_HOURS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","ACT_HOURS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","ACT_HOURS","caption","Applied Hours")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","ACT_HOURS","MinWidth", 70)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "ACT_HOURS", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","POTENTIAL_HOURS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","POTENTIAL_HOURS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","POTENTIAL_HOURS","caption","Potential Hours Decimal")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","POTENTIAL_HOURS","MinWidth", 70)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "POTENTIAL_HOURS", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","HOURS_ESTIMATED","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","HOURS_ESTIMATED","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","HOURS_ESTIMATED","caption","Est. Hours (Dec)")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","HOURS_ESTIMATED","MinWidth", 50)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","HOURS_ESTIMATED","Visible", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","HOURS_ESTIMATED","AllowShowHide", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "HOURS_ESTIMATED", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","HOURS_ACTUAL","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","HOURS_ACTUAL","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","HOURS_ACTUAL","caption","Applied Hours (Dec)")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","HOURS_ACTUAL","MinWidth", 50)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","HOURS_ACTUAL","Visible", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","HOURS_ACTUAL","AllowShowHide", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "HOURS_ACTUAL", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB_SUM","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB_SUM","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB_SUM","caption","Job Total")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB_SUM","MinWidth", 70)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "JOB_SUM", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JSS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JSS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JSS","caption","Job SS")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JSS","MinWidth", 80)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JSS","allowshowhide", false)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Suffix","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Suffix","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Suffix","caption","Suffix")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Suffix","MinWidth", 50)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Suffix","Fixed", "Left")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "Suffix", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Seq","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Seq","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Seq","caption","Seq")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Seq","MinWidth", 50)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Seq","Fixed", "Left")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "Seq", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","PART","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","PART","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","PART","caption","Part/Project")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","PART","MinWidth", 80)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "PART", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Description","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Description","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Description","caption","Description (Job)")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Description","HeaderWordWrap", "Wrap")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Description","MinWidth", 110)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "Description", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","seq_Description","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","seq_Description","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","seq_Description","caption","Description (Seq)")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","seq_Description","HeaderWordWrap", "Wrap")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","seq_Description","MinWidth", 110)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","seq_Description","Visible", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "seq_Description", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WC","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WC","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WC","caption","Work Center")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WC","HeaderWordWrap", "Wrap")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WC","MinWidth", 50)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WC","Fixed", "Left")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "WC", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_NOTES","caption","Sun Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_NOTES","caption","Mon Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_NOTES","caption","Tues Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_NOTES","caption","Wed Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_NOTES","caption","Th Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_NOTES","caption","Fri Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_NOTES","caption","Sat Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_NOTES","Visible", "False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_NOTES","Visible", "False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_NOTES","Visible", "False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_NOTES","Visible", "False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_NOTES","Visible", "False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_NOTES","Visible", "False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_NOTES","Visible", "False")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_NOTES","caption","Sun Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_NOTES","caption","Mon Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_NOTES","caption","Tues Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_NOTES","caption","Wed Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_NOTES","caption","Th Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_NOTES","caption","Fri Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_NOTES","readonly", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_NOTES","allowedit", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT2_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT2_HRS","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT2_HRS","HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT2_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT2_NOTES","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT2_NOTES","caption","Sat Notes")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT2_NOTES","MinWidth", 70)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT2_NOTES","Visible", "False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_NOTES","Visible", "False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_NOTES","Visible", "False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_NOTES","Visible", "False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_NOTES","Visible", "False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_NOTES","Visible", "False")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_NOTES","Visible", "False")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Seq_Closed","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Seq_Closed","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Seq_Closed","caption","Seq Closed")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Seq_Closed","Visible", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Seq_Closed","MinWidth", 50)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Flag_Hold","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Flag_Hold","headerfontbold", true)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Flag_Hold","caption","Flag Hold")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Flag_Hold","Visible", false)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Flag_Hold","MinWidth", 50)

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "OVT_HRS", "HeaderFontBold", True)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "OVT_HRS", "Caption", "OT Hours")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "OVT_HRS", "MinWidth", 60)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "OVT_HRS", "EditMaskType", "Numeric")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "OVT_HRS", "EditMask", "0.00")
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "OVT_HRS", "EditMaskAsDisplayFormat", True)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "OVT_HRS", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev", "OVT_HRS", "HeaderWordWrap", "Wrap")

GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB","VisibleIndex", 0)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUFFIX","VisibleIndex", 1)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Description","VisibleIndex", 5)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SEQ","VisibleIndex", 2)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB_NOTES","VisibleIndex", 9)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Part","VisibleIndex", 4)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WC","VisibleIndex", 3)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","EST_HOURS","VisibleIndex", 6)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","ACT_HOURS","VisibleIndex", 7)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_HRS","VisibleIndex", 8)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_HRS","VisibleIndex", 9)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_HRS","VisibleIndex", 10)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_HRS","VisibleIndex", 11)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_HRS","VisibleIndex", 12)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_HRS","VisibleIndex", 13)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_HRS","VisibleIndex", 14)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_HRS","VisibleIndex", 15)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_HRS","VisibleIndex", 16)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_HRS","VisibleIndex", 17)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_HRS","VisibleIndex", 18)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_HRS","VisibleIndex", 19)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_HRS","VisibleIndex", 20)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT2_HRS","VisibleIndex", 21)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","JOB_SUM","VisibleIndex", 22)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Seq_Closed","VisibleIndex", 23)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Flag_Ready","VisibleIndex", 24)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","Updated","VisibleIndex", 25)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","OVT_HRS","VisibleIndex", 26)

gui.FormPrev.GsGridPrev.AddSummaryItem("GPrev","SUN_HRS","SUN_HRS_Sum","Sum","","","n2")
GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "MON_HRS","MON_HRS_Sum","Sum","","","n2")
GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "TUES_HRS","TUES_HRS_Sum","Sum","","","n2")
GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "WED_HRS","WED_HRS_Sum","Sum","","","n2")
GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "THUR_HRS","THUR_HRS_Sum","Sum","","","n2")
GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "FRI_HRS","FRI_HRS_Sum","Sum","","","n2")
GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "SAT_HRS","SAT_HRS_Sum","Sum","","","n2")

gui.FormPrev.GsGridPrev.AddSummaryItem("GPrev","SUN2_HRS","SUN2_HRS_Sum","Sum","","","n2")
GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "MON2_HRS","MON2_HRS_Sum","Sum","","","n2")
GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "TUES2_HRS","TUES2_HRS_Sum","Sum","","","n2")
GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "WED2_HRS","WED2_HRS_Sum","Sum","","","n2")
GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "THUR2_HRS","THUR2_HRS_Sum","Sum","","","n2")
GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "FRI2_HRS","FRI2_HRS_Sum","Sum","","","n2")
GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "SAT2_HRS","SAT2_HRS_Sum","Sum","","","n2")

GUI.FormPrev.GsGridPrev.AddSummaryItem("GPrev", "JOB_SUM","JOB_SUM","Sum","","","n2")

Gui.FormPrev.GsGridPrev.MainView("GPrev")

F.Global.Registry.ReadValue(V.Caller.User, V.Caller.CompanyCode, "TIMESHEETVIEW", 6873, 4000, 6, "", V.Local.sSerialize)
F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
	Gui.FormPrev.GsGridPrev.Deserialize(V.Local.sSerialize)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.Set_Prev_Prop.End

Program.Sub.Set_Prev_Cap.Start
F.Intrinsic.Control.Try

V.Local.sDate.Declare(String)
V.Local.iCol.Declare(Long)
V.Local.dDate.Declare(Date)

V.Local.dDate.Set(V.Screen.FormTimesheet!ddlPrevWeek.Value)

F.Intrinsic.String.Build("Sun: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Sun Notes: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.local.dDate)
F.Intrinsic.String.Build("Mon: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Mon Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Tues: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Tues Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Wed: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Wed Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Thur: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Thur Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Fri: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Fri Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Sat: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Sat Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Sun: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Sun Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SUN2_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.local.dDate)
F.Intrinsic.String.Build("Mon: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Mon Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","MON2_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Tues: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Tues Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","TUES2_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Wed: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Wed Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","WED2_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Thur: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Thur Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","THUR2_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Fri: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Fri Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","FRI2_NOTES","caption",V.Local.sDate)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Sat: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT2_HRS","caption",v.Local.sDate)
F.Intrinsic.String.Build("Sat Notes: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormPrev.GsGridPrev.SetColumnProperty("GPrev","SAT2_NOTES","caption",V.Local.sDate)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.Set_Prev_Cap.End

Program.Sub.Comments.Start
${$5$}$2.0.0.0$}$2
${$6$}$rking$}$20230127064355595$}$QNdZLVy4bWuiWa9jh1ZTiKHvMPldSPXe6k8s2xkG1loUmxpljQUkkXmKh6bzgrQAijH7yX12FmM=
Program.Sub.Comments.End